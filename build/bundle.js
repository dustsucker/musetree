var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function o(){return Object.create(null)}function i(e){e.forEach(r)}function a(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function l(e){let t;return c(e,e=>t=e)(),t}function u(e,t,n){e.$$.on_destroy.push(c(t,n))}function d(e,t,n,r){if(e){const o=f(e,t,n,r);return e[0](o)}}function f(e,t,r,o){return e[1]&&o?n(r.ctx.slice(),e[1](o(t))):r.ctx}function h(e,t,n,r,o,i,a){const s=function(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}(t,r,o,i);if(s){const o=f(t,n,r,a);e.p(o,s)}}function p(e){return null==e?"":e}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),y=m?e=>requestAnimationFrame(e):e;const v=new Set;function $(e){v.forEach(t=>{t.c(e)||(v.delete(t),t.f())}),0!==v.size&&y($)}function b(e){let t;return 0===v.size&&y($),{promise:new Promise(n=>{v.add(t={c:e,f:n})}),abort(){v.delete(t)}}}function w(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function T(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function E(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function I(e){return document.createTextNode(e)}function S(){return I(" ")}function A(){return I("")}function M(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function N(e){return function(t){return t.preventDefault(),e.call(this,t)}}function O(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function q(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function U(e){return""===e?void 0:+e}function P(e,t){t=""+t,e.data!==t&&(e.data=t)}function D(e,t){e.value=null==t?"":t}function B(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function j(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function L(e,t,n){e.classList[n?"add":"remove"](t)}const F=new Set;let R,_=0;function H(e,t,n,r,o,i,a,s=0){const c=16.666/r;let l="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*i(e);l+=100*e+`%{${a(r,1-r)}}\n`}const u=l+`100% {${a(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${s}`,f=e.ownerDocument;F.add(f);const h=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(C("style")).sheet),p=f.__svelte_rules||(f.__svelte_rules={});p[d]||(p[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?m+", ":""}${d} ${r}ms linear ${o}ms 1 both`,_+=1,d}function z(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-r.length;o&&(e.style.animation=r.join(", "),_-=o,_||y(()=>{_||(F.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),F.clear())}))}function V(e){R=e}function W(){if(!R)throw new Error("Function called outside component initialization");return R}function G(e){W().$$.on_mount.push(e)}function Z(e){W().$$.after_update.push(e)}function X(e,t){W().$$.context.set(e,t)}function Y(e){return W().$$.context.get(e)}function J(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const Q=[],K=[],ee=[],te=[],ne=Promise.resolve();let re=!1;function oe(e){ee.push(e)}let ie=!1;const ae=new Set;function se(){if(!ie){ie=!0;do{for(let e=0;e<Q.length;e+=1){const t=Q[e];V(t),ce(t.$$)}for(Q.length=0;K.length;)K.pop()();for(let e=0;e<ee.length;e+=1){const t=ee[e];ae.has(t)||(ae.add(t),t())}ee.length=0}while(Q.length);for(;te.length;)te.pop()();re=!1,ie=!1,ae.clear()}}function ce(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(oe)}}let le;function ue(){return le||(le=Promise.resolve(),le.then(()=>{le=null})),le}function de(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const fe=new Set;let he;function pe(){he={r:0,c:[],p:he}}function me(){he.r||i(he.c),he=he.p}function ge(e,t){e&&e.i&&(fe.delete(e),e.i(t))}function ye(e,t,n,r){if(e&&e.o){if(fe.has(e))return;fe.add(e),he.c.push(()=>{fe.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const ve={duration:0};function $e(n,r,o){let i,s,c=r(n,o),l=!1,u=0;function d(){i&&z(n,i)}function f(){const{delay:r=0,duration:o=300,easing:a=t,tick:f=e,css:h}=c||ve;h&&(i=H(n,0,1,o,r,a,h,u++)),f(0,1);const p=g()+r,m=p+o;s&&s.abort(),l=!0,oe(()=>de(n,!0,"start")),s=b(e=>{if(l){if(e>=m)return f(1,0),de(n,!0,"end"),d(),l=!1;if(e>=p){const t=a((e-p)/o);f(t,1-t)}}return l})}let h=!1;return{start(){h||(z(n),a(c)?(c=c(),ue().then(f)):f())},invalidate(){h=!1},end(){l&&(d(),l=!1)}}}function be(n,r,o,s){let c=r(n,o),l=s?0:1,u=null,d=null,f=null;function h(){f&&z(n,f)}function p(e,t){const n=e.b-l;return t*=Math.abs(n),{a:l,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function m(r){const{delay:o=0,duration:a=300,easing:s=t,tick:m=e,css:y}=c||ve,v={start:g()+o,b:r};r||(v.group=he,he.r+=1),u?d=v:(y&&(h(),f=H(n,l,r,a,o,s,y)),r&&m(0,1),u=p(v,a),oe(()=>de(n,r,"start")),b(e=>{if(d&&e>d.start&&(u=p(d,a),d=null,de(n,u.b,"start"),y&&(h(),f=H(n,l,u.b,u.duration,0,s,c.css))),u)if(e>=u.end)m(l=u.b,1-l),de(n,u.b,"end"),d||(u.b?h():--u.group.r||i(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;l=u.a+u.d*s(t/u.duration),m(l,1-l)}return!(!u&&!d)}))}return{run(e){a(c)?ue().then(()=>{c=c(),m(e)}):m(e)},end(){h(),u=d=null}}}function we(e,t){ye(e,1,1,()=>{t.delete(e.key)})}function xe(e,t,n,r,o,i,a,s,c,l,u,d){let f=e.length,h=i.length,p=f;const m={};for(;p--;)m[e[p].key]=p;const g=[],y=new Map,v=new Map;for(p=h;p--;){const e=d(o,i,p),s=n(e);let c=a.get(s);c?r&&c.p(e,t):(c=l(s,e),c.c()),y.set(s,g[p]=c),s in m&&v.set(s,Math.abs(p-m[s]))}const $=new Set,b=new Set;function w(e){ge(e,1),e.m(s,u),a.set(e.key,e),u=e.first,h--}for(;f&&h;){const t=g[h-1],n=e[f-1],r=t.key,o=n.key;t===n?(u=t.first,f--,h--):y.has(o)?!a.has(r)||$.has(r)?w(t):b.has(o)?f--:v.get(r)>v.get(o)?(b.add(r),w(t)):($.add(o),f--):(c(n,a),f--)}for(;f--;){const t=e[f];y.has(t.key)||c(t,a)}for(;h;)w(g[h-1]);return g}function ke(e){e&&e.c()}function Te(e,t,n){const{fragment:o,on_mount:s,on_destroy:c,after_update:l}=e.$$;o&&o.m(t,n),oe(()=>{const t=s.map(r).filter(a);c?c.push(...t):i(t),e.$$.on_mount=[]}),l.forEach(oe)}function Ce(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ee(e,t){-1===e.$$.dirty[0]&&(Q.push(e),re||(re=!0,ne.then(se)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ie(t,n,r,a,s,c,l=[-1]){const u=R;V(t);const d=n.props||{},f=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:l};let h=!1;if(f.ctx=r?r(t,d,(e,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=o)&&(f.bound[e]&&f.bound[e](o),h&&Ee(t,e)),n}):[],f.update(),h=!0,i(f.before_update),f.fragment=!!a&&a(f.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);f.fragment&&f.fragment.l(e),e.forEach(k)}else f.fragment&&f.fragment.c();n.intro&&ge(t.$$.fragment),Te(t,n.target,n.anchor),se()}V(u)}class Se{$destroy(){Ce(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const Ae=[];function Me(t,n=e){let r;const o=[];function i(e){if(s(t,e)&&(t=e,r)){const e=!Ae.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),Ae.push(n,t)}if(e){for(let e=0;e<Ae.length;e+=2)Ae[e][0](Ae[e+1]);Ae.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(a,s=e){const c=[a,s];return o.push(c),1===o.length&&(r=n(i)||e),a(t),()=>{const e=o.indexOf(c);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}function Ne(t,n,r){const o=!Array.isArray(t),s=o?[t]:t,l=n.length<2;return{subscribe:Me(r,t=>{let r=!1;const u=[];let d=0,f=e;const h=()=>{if(d)return;f();const r=n(o?u[0]:u,t);l?t(r):f=a(r)?r:e},p=s.map((e,t)=>c(e,e=>{u[t]=e,d&=~(1<<t),r&&h()},()=>{d|=1<<t}));return r=!0,h(),function(){i(p),f()}}).subscribe}}const Oe=["bass","drums","guitar","harp","piano","violin","cello","flute","trumpet","clarinet"],qe=["bass","drums","guitar","harp","piano","strings","winds"],Ue=["2unlimited","883","aaaaaaaaaaa","abba","abdelmoinealfa","acdc","aceofbase","adele","aerosmith","african","africandrum","aguado","airsupply","alabama","alainsouchon","alanismorissette","alanismorrisette","alanjackson","alanparsons","albeniz","albrechtsberger","alicecooper","aliceinchains","alkan","allsaints","amedeominghi","america","amostori","amygrant","andersen","andreabocelli","andrehazes","anerio","animenz","annaoxa","annielennox","anonymous","antonellovenditti","aqua","arabic","arethafranklin","ascher","azzaiolo","bach","bachjohannsebastian","backstreetboys","badcompany","balakirev","banchieri","barbrastreisand","barrymanilow","basie","battiato","battisti","bbking","beachboys","beck","beegees","beethoven","benfoldsfive","benjyshelton","berckmansdeoliveira","berlioz","berte","best","bettemidler","beyonce","biagioantonacci","billyidol","billyjoel","billyocean","bizet","bjork","blacksabbath","blink-182","blink182","blondie","blow","bluegrass","blues","blur","bobdylan","bobmarley","bobseger","bonjovi","borodin","boston","bowiedavid","boyzone","brahms","brandy","brassensgeorges","bread","britneyspears","broadway","brooks & dunn","brooksgarth","brucehornsby","brucespringsteen","bruckner","bryanadams","buddyholly","burgmueller","bush","busoni","bwitched","byrd","cabanilles","cameronleesimpson","campion","carboni","carlysimon","caroleking","carpenters","carr","carulli","cashjohnny","cato","celentano","celinedion","chakakhan","cheaptrick","cher","cherubini","chicago","chickcorea","chinese","chopin","chopinfrederic","chrisrea","christmas","chuckberry","cimarosa","classical","claudebolling","claudedebussy","clementi","cocciante","collinsphil","coolio","corelli","country","couperin","cream","creed","creedenceclearwaterrevival","crosbystillsnashandyoung","crosbystillsnashyoung","cyndilauper","czerny","d'aragona","dalla","dance","daniele","daquin","davemathews","davematthewsband","davidbowie","debussy","deeppurple","defleppard","deleted","delibes","depechemode","devo","diabelli","dionnewarwick","direstraits","disney","disneythemes","dominofats","donhenley","donizetti","donnasummer","dowland","drdre","duranduran","dussek","duvernoy","dvorak","eagles","earthwindandfire","edvardgrieg","eiffel65","electriclightorchestra","elgar","ellington","elo","eltonjohn","elviscostello","elvispresley","emerson, lake & palmer","emersonlakeandpalmer","eminem","encina","encore","enya","erasure","ericclapton","estefangloria","eurythmics","everything","faure","field","fiorellamannoia","fiorello","fleetwoodmac","folk","foofighters","foreigner","franck","franksinatra","gabrieli","gade","galilei","garbage","gastoldi","genesis","georgebenson","georgeharrison","gershwin","gganderson","gibbons","gilbert & sullivan","giorgia","giuliani","glazunov","glencampbell","godowsky","gomolka","gordonlightfoot","gorzanis","gospel","gottschalk","goudimel","gounod","granados","grandfunkrailroad","grandi","greenday","grieg","guerrero","guesswho","guns n' roses","gunsnroses","gurlitt","gypsy","haberbier","hall & oates","handel","hanson","hasse","hassler","haydn","heart","heller","herman","herz","holborne","hole","hollybuddy","holst","howardcarpendale","huey lewis & the news","hueylewis","hummel","humperdinckengelbert","hymns","indian","inxs","irish","ironmaiden","jacksonbrowne","jacksonmichael","jamiroquai","janequin","janetjackson","jazz","jeanmicheljarre","jenniferlopez","jethrotull","jewel","jimcroce","jimihendrix","jimmybuffett","joecocker","joejackson","johannsebastianbach","johnelton","johnlennon","johnmellencamp","johnnyrivers","jonimitchell","joplin","journey","jovanotti","jstrauss2","juliancasablancas","kansas","katyperry","kellyclarkson","kennyloggins","ketterer","khachaturian","kids","kiss","kool & the gang","korn","kpop","krakowa","kreutzer","kuhlau","ladygaga","lassus","last","latin","laurapausini","leali","ledzeppelin","lemire","lennykravitz","leosayer","level42","ligabue","limpbizkit","lindaronstadt","lionelrichie","liszt","littleriverband","lobo","losy","ludwigvanbeethoven","lully","lynyrdskynyrd","machaut","madonna","mahler","maier","mango","marais","marcanthony","marcello","mariahcarey","marillion","marilynmanson","masini","matiabazar","mccartney","meatloaf","mendelssohn","metallica","michaelbolton","michaelbuble","michaelgeorge","michaeljackson","michelezarrillo","miller","mina","moabberckmansdeoliveira","moby","monteverdi","morandi","morley","mosch","moszkowski","movie","moviethemes","mozart","mussorgsky","natalieimbruglia","nationalanthems","natkingcole","natl_anthem","neildiamond","neilyoung","nek","nielsen","nightwish","nineinchnails","nintendo","nirvana","nodoubt","nofx","nomadi","oasis","offenbach","oldfieldmike","olivianewton-john","onedirection","ongcmu","oscarpeterson","other","ozzyosbourne","pachelbel","paganini","palestrina","pantera","paoli","patbenatar","patsycline","paulaabdul","paulmccartney","paulsimon","pearljam","pergolesi","perosi","petergabriel","petshopboys","philcollins","pinkfloyd","polak","pooh","poulenc","praetorius","prez","prince","puccini","punk","purcell","queen","rachmaninoff","rachmaninov","radiohead","raf","rageagainstthemachine","ragtime","ramazzotti","rameau","rap","ravel","raycharles","realmccoy","redhotchilipeppers","reelbigfish","reger","reicha","rem","renefroger","renzoarbore","reospeedwagon","richardcliff","richielionel","rickymartin","rihanna","rimini","rimsky-korsakov","ringostarr","rkelly","robbiewilliams","robertaflack","robertpalmer","roblaidlow","rodstewart","rogerskenny","rollingstones","roman","ron","rossini","rossivasco","roxette","royorbison","rubinstein","ruggeri","rush","sade","saint-saens","sammartini","santana","sanz","satie","scarlatti","schubert","schumann","scorpions","scottish","scottjames","scottjoplin","scriabin","shakira","shaniatwain","shearinggeorge","shostakovich","sibelius","silverchair","simonandgarfunkel","simplyred","sinatra","smashingpumpkins","smashmouth","smetana","smith","soler","songs","sor","soundgarden","soundtrack","sousa","spicegirls","spinners","spohr","stamitz","stansfieldlisa","steelydan","stevemillerband","stevienicks","steviewonder","sting","stonetemplepilots","strauss","stravinsky","styx","sublime","sugarray","sullivan","supertramp","susato","sweet","takethat","talkingheads","taylorjames","taylorswift","tchaikovsky","telemann","thalberg","thealanparsonsproject","theallmanbrothersband","theanimals","thebeachboys","thebeatles","thecarpenters","thecars","thecorrs","thecranberries","thecure","thedoobiebrothers","thedoors","thedrifters","theeagles","theeverlybrothers","thefourseasons","thegrassroots","thehollies","thekinks","themonkees","themoodyblues","theoffspring","thepointersisters","thepolice","thepretenders","therascals","therollingstones","theshadows","thesmashingpumpkins","thesupremes","thetemptations","thetragicallyhip","theventures","thewho","threedognight","tinaturner","tlc","tomjones","tompetty","tompettyandtheheartbreakers","tonyorlando","tool","toriamos","toto","tozzi","traditional","traffic","turnertina","tvthemes","u2","ub40","unknown","vangelis","vanhalen","vanmorrison","vengaboys","verdi","victoria","video","videogamethemes","villagepeople","vivaldi","wagner","walthew","warhorse","weber","weezer","weiss","whitezombie","whitneyhouston","widor","wieniawski","willsmith","wonderstevie","world","yes","zappa","zero","zipoli","zucchero","zztop"],Pe=qe.reduce((e,t)=>(e[t]=Me("piano"===t||"drums"===t),e),{}),De=Ne(Object.values(Pe),e=>e.reduce((e,t,n)=>(e[qe[n]]=t,e),{})),Be=Me(300),je=Me(1500),Le=Ne([Be,je],([e,t])=>t-e),Fe=Me(["Chopin","chopin"]),Re=Me(1),_e=Me(27),He=Me(!1),ze=Me(!0),Ve=Me(!1),We=Me(!0),Ge=Me(2.5),Ze=Me(100),Xe=Me(50),Ye=Me(!0),Je=Ne([Be,Le,Fe,De,Re,_e],([e,t,n,r,o,i])=>({audioFormat:"mp3",encoding:[],generationLength:e,requestLength:t,genre:n[1],instrument:r,temperature:o,truncation:i}));function Qe(e,t,n=((e,t)=>e===t)){let r=t;const o=Me(t);let i=()=>{};return e.subscribe(e=>{i(),i=e.subscribe(e=>{n(r,e)||(r=e,o.set(e))})}),o}function Ke(e,t,n,r=((e,t)=>e===t)){let o=n;return Ne(e,(e,n)=>{const i=t(e);r(o,i)||(o=i,n(i))},n)}function et(e,t,n=((e,t)=>e===t)){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function tt(){return Me({encoding:[]})}function nt(e,t){return Ke([e,t],([e,t])=>({encoding:[...e.encoding,...t.section.encoding]}),{encoding:[]},(e,t)=>et(e.encoding,t.encoding))}function rt(e){return e.map(e=>e.toString()).join(" ")}function ot(e){return e.split(" ").map(e=>parseInt(e))}function it(e){return Me({section:e})}function at(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){if(!st(e[n],t[n]))return!1}return!0}function st(e,t){if(e===t)return!0;if(e.startsAt!==t.startsAt)return!1;if(e.encoding.length!==t.encoding.length)return!1;if(e.encoding===t.encoding)return!0;for(let n=0;n<e.encoding.length;n++){if(e.encoding[n]!==t.encoding[n])return!1}return!0}async function ct(e,t,n,r,o){return await new Promise(i=>{e.update(e=>{const a=e.nextChildIndex,s=Ke(t,e=>({selectedByParent:e.selectedChild===a,wasLastSelectedByParent:e.lastSelected===a,onSelectedPath:e.onSelectedPath&&e.selectedChild===a}),{selectedByParent:!1,wasLastSelectedByParent:!1,onSelectedPath:!1},(e,t)=>e.selectedByParent===t.selectedByParent&&e.wasLastSelectedByParent===t.wasLastSelectedByParent&&e.onSelectedPath===t.onSelectedPath),c=function(e,t,n,r,o){const i=Me({type:"branch",nextChildIndex:1,children:{},hiddenChildren:{},selectedChild:null,lastSelected:null,path:e}),a=Ne([i,t,r],([e,t,n])=>({...e,...t,...n}));let s,c;const l=()=>{o.set(c)};return s={type:"branch",...a,selectedChildStore_2:ut(a),numberOfLeavesStore:dt(a),internalSelect:e=>function(e,t,n){0!==n.length?e.update(e=>{const r=e.children[n[0]];if(void 0===r)return t(),{...e,selectedChild:null,lastSelected:e.selectedChild};const o=[...n];return o.shift(),r.internalSelect(o),{...e,selectedChild:n[0],lastSelected:e.selectedChild}}):e.update(e=>(t(),{...e,selectedChild:null,lastSelected:e.selectedChild}))}(i,l,e),addChild:(e,t)=>ct(i,a,o,e,t),deleteChild:e=>async function(e,t,n){return await new Promise(r=>e.update(e=>{const o=e.children[n];if(void 0===o)return r(null),e;const i={...e.children};delete i[n];const a={...e,children:i};return e.selectedChild===n&&(a.selectedChild=null,t()),e.lastSelected===n&&(a.lastSelected=null),r(o),a}))}(i,l,e),showChild:e=>async function(e,t){return await new Promise(n=>e.update(e=>{const r=e.hiddenChildren[t];if(void 0===r)return n(null),e;const o={...e.children},i={...e.hiddenChildren};o[t]=r,delete i[t];const a={...e,children:o,hiddenChildren:i};return n(r),a}))}(i,e),hideChild:e=>async function(e,t,n){return await new Promise(r=>e.update(e=>{const o=e.children[n];if(void 0===o)return r(null),e;const i={...e.children},a={...e.hiddenChildren};a[n]=o,delete i[n];const s={...e,children:i,hiddenChildren:a};return e.selectedChild===n&&(s.selectedChild=null,t()),e.lastSelected===n&&(s.lastSelected=null),r(o),s}))}(i,l,e),resetNextChildIndex:()=>lt(i)},c={...s,...n(s)},c}([...e.path,a],r,o,s,n);i(c);const l={...e.children};return l[e.nextChildIndex]=c,{...e,children:l,nextChildIndex:a+1}})})}function lt(e){e.update(e=>({...e,nextChildIndex:Math.max(...Object.keys(e.children).map(e=>parseInt(e)),0)+1}))}function ut(e){return Ke(e,e=>{let t=e.selectedChild;if(null===t)return null;const n=e.children[t];return void 0===n?null:n},null)}function dt(e){return Qe(Ne(e,e=>{const t=Object.values(e.children).map(e=>e.numberOfLeavesStore);return 0===t.length?Me(1):Ne(t,e=>0===e.length?1:e.reduce((e,t)=>e+t,0))}),1)}const ft=function(e,t){const n=Me({type:"root",children:{},hiddenChildren:{},nextChildIndex:1,selectedChild:null,lastSelected:null,path:[]}),r=Me({selectedByParent:!0,wasLastSelectedByParent:!1,onSelectedPath:!0}),o=Ne([n,e,r],([e,t,n])=>({...e,...t,...n})),i=Me(null);let a;return a={type:"root",...o,selectedChildStore_2:ut(o),numberOfLeavesStore:dt(o),addChild:(e,t)=>ct(n,o,i,e,t),select:e=>function(e,t,n){0!==n.length?e.update(e=>{const r=e.children[n[0]];if(void 0===r)return t.set(null),{...e,selectedChild:null,lastSelected:e.selectedChild};const o=[...n];return o.shift(),r.internalSelect(o),{...e,selectedChild:n[0],lastSelected:e.selectedChild}}):e.update(e=>(t.set(null),{...e,selectedChild:null,lastSelected:e.selectedChild}))}(n,i,e),deleteChild:e=>async function(e,t,n){return await new Promise(r=>e.update(e=>{const o=e.children[n];if(void 0===o)return r(null),e;const i={...e.children};delete i[n];const a={...e,children:i};return e.selectedChild===n&&(a.selectedChild=null,t.set(null)),e.lastSelected===n&&(a.lastSelected=null),r(o),a}))}(n,i,e),showChild:e=>async function(e,t){return await new Promise(n=>e.update(e=>{const r=e.hiddenChildren[t];if(void 0===r)return n(null),e;const o={...e.children},i={...e.hiddenChildren};o[t]=r,delete i[t];const a={...e,children:o,hiddenChildren:i};return n(r),a}))}(n,e),hideChild:e=>async function(e,t,n){return await new Promise(r=>e.update(e=>{const o=e.children[n];if(void 0===o)return r(null),e;const i={...e.children},a={...e.hiddenChildren};a[n]=o,delete i[n];const s={...e,children:i,hiddenChildren:a};return e.selectedChild===n&&(s.selectedChild=null,t.set(null)),e.lastSelected===n&&(s.lastSelected=null),r(o),s}))}(n,i,e),resetNextChildIndex:()=>lt(n),selectedStore_2:i},{...a,...t(a)}};var ht=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},pt=Object.prototype.toString;function mt(e){return"[object Array]"===pt.call(e)}function gt(e){return void 0===e}function yt(e){return null!==e&&"object"==typeof e}function vt(e){return"[object Function]"===pt.call(e)}function $t(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),mt(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}var bt={isArray:mt,isArrayBuffer:function(e){return"[object ArrayBuffer]"===pt.call(e)},isBuffer:function(e){return null!==e&&!gt(e)&&null!==e.constructor&&!gt(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:yt,isUndefined:gt,isDate:function(e){return"[object Date]"===pt.call(e)},isFile:function(e){return"[object File]"===pt.call(e)},isBlob:function(e){return"[object Blob]"===pt.call(e)},isFunction:vt,isStream:function(e){return yt(e)&&vt(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:$t,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)$t(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,o=arguments.length;r<o;r++)$t(arguments[r],n);return t},extend:function(e,t,n){return $t(t,(function(t,r){e[r]=n&&"function"==typeof t?ht(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}};function wt(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var xt=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(bt.isURLSearchParams(t))r=t.toString();else{var o=[];bt.forEach(t,(function(e,t){null!=e&&(bt.isArray(e)?t+="[]":e=[e],bt.forEach(e,(function(e){bt.isDate(e)?e=e.toISOString():bt.isObject(e)&&(e=JSON.stringify(e)),o.push(wt(t)+"="+wt(e))})))})),r=o.join("&")}if(r){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e};function kt(){this.handlers=[]}kt.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},kt.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},kt.prototype.forEach=function(e){bt.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var Tt=kt,Ct=function(e,t,n){return bt.forEach(n,(function(n){e=n(e,t)})),e},Et=function(e){return!(!e||!e.__CANCEL__)},It=function(e,t){bt.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))},St=function(e,t,n,r,o){return function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,n,r,o)},At=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],Mt=bt.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=bt.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0},Nt=bt.isStandardBrowserEnv()?{write:function(e,t,n,r,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),bt.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),bt.isString(r)&&a.push("path="+r),bt.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},Ot=function(e){return new Promise((function(t,n){var r=e.data,o=e.headers;bt.isFormData(r)&&delete o["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var a=e.auth.username||"",s=e.auth.password||"";o.Authorization="Basic "+btoa(a+":"+s)}var c,l,u=(c=e.baseURL,l=e.url,c&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(l)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(c,l):l);if(i.open(e.method.toUpperCase(),xt(u,e.params,e.paramsSerializer),!0),i.timeout=e.timeout,i.onreadystatechange=function(){if(i&&4===i.readyState&&(0!==i.status||i.responseURL&&0===i.responseURL.indexOf("file:"))){var r,o,a,s,c,l="getAllResponseHeaders"in i?(r=i.getAllResponseHeaders(),c={},r?(bt.forEach(r.split("\n"),(function(e){if(s=e.indexOf(":"),o=bt.trim(e.substr(0,s)).toLowerCase(),a=bt.trim(e.substr(s+1)),o){if(c[o]&&At.indexOf(o)>=0)return;c[o]="set-cookie"===o?(c[o]?c[o]:[]).concat([a]):c[o]?c[o]+", "+a:a}})),c):c):null,u={data:e.responseType&&"text"!==e.responseType?i.response:i.responseText,status:i.status,statusText:i.statusText,headers:l,config:e,request:i};!function(e,t,n){var r=n.config.validateStatus;!r||r(n.status)?e(n):t(St("Request failed with status code "+n.status,n.config,null,n.request,n))}(t,n,u),i=null}},i.onabort=function(){i&&(n(St("Request aborted",e,"ECONNABORTED",i)),i=null)},i.onerror=function(){n(St("Network Error",e,null,i)),i=null},i.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(St(t,e,"ECONNABORTED",i)),i=null},bt.isStandardBrowserEnv()){var d=Nt,f=(e.withCredentials||Mt(u))&&e.xsrfCookieName?d.read(e.xsrfCookieName):void 0;f&&(o[e.xsrfHeaderName]=f)}if("setRequestHeader"in i&&bt.forEach(o,(function(e,t){void 0===r&&"content-type"===t.toLowerCase()?delete o[t]:i.setRequestHeader(t,e)})),bt.isUndefined(e.withCredentials)||(i.withCredentials=!!e.withCredentials),e.responseType)try{i.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&i.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){i&&(i.abort(),n(e),i=null)})),void 0===r&&(r=null),i.send(r)}))},qt={"Content-Type":"application/x-www-form-urlencoded"};function Ut(e,t){!bt.isUndefined(e)&&bt.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var Pt,Dt={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(Pt=Ot),Pt),transformRequest:[function(e,t){return It(t,"Accept"),It(t,"Content-Type"),bt.isFormData(e)||bt.isArrayBuffer(e)||bt.isBuffer(e)||bt.isStream(e)||bt.isFile(e)||bt.isBlob(e)?e:bt.isArrayBufferView(e)?e.buffer:bt.isURLSearchParams(e)?(Ut(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):bt.isObject(e)?(Ut(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};Dt.headers={common:{Accept:"application/json, text/plain, */*"}},bt.forEach(["delete","get","head"],(function(e){Dt.headers[e]={}})),bt.forEach(["post","put","patch"],(function(e){Dt.headers[e]=bt.merge(qt)}));var Bt=Dt;function jt(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var Lt=function(e){return jt(e),e.headers=e.headers||{},e.data=Ct(e.data,e.headers,e.transformRequest),e.headers=bt.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),bt.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||Bt.adapter)(e).then((function(t){return jt(e),t.data=Ct(t.data,t.headers,e.transformResponse),t}),(function(t){return Et(t)||(jt(e),t&&t.response&&(t.response.data=Ct(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},Ft=function(e,t){t=t||{};var n={},r=["url","method","params","data"],o=["headers","auth","proxy"],i=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];bt.forEach(r,(function(e){void 0!==t[e]&&(n[e]=t[e])})),bt.forEach(o,(function(r){bt.isObject(t[r])?n[r]=bt.deepMerge(e[r],t[r]):void 0!==t[r]?n[r]=t[r]:bt.isObject(e[r])?n[r]=bt.deepMerge(e[r]):void 0!==e[r]&&(n[r]=e[r])})),bt.forEach(i,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var a=r.concat(o).concat(i),s=Object.keys(t).filter((function(e){return-1===a.indexOf(e)}));return bt.forEach(s,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n};function Rt(e){this.defaults=e,this.interceptors={request:new Tt,response:new Tt}}Rt.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=Ft(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[Lt,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},Rt.prototype.getUri=function(e){return e=Ft(this.defaults,e),xt(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},bt.forEach(["delete","get","head","options"],(function(e){Rt.prototype[e]=function(t,n){return this.request(bt.merge(n||{},{method:e,url:t}))}})),bt.forEach(["post","put","patch"],(function(e){Rt.prototype[e]=function(t,n,r){return this.request(bt.merge(r||{},{method:e,url:t,data:n}))}}));var _t=Rt;function Ht(e){this.message=e}Ht.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Ht.prototype.__CANCEL__=!0;var zt=Ht;function Vt(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new zt(e),t(n.reason))}))}Vt.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Vt.source=function(){var e;return{token:new Vt((function(t){e=t})),cancel:e}};var Wt=Vt;function Gt(e){var t=new _t(e),n=ht(_t.prototype.request,t);return bt.extend(n,_t.prototype,t),bt.extend(n,t),n}var Zt=Gt(Bt);Zt.Axios=_t,Zt.create=function(e){return Gt(Ft(Zt.defaults,e))},Zt.Cancel=zt,Zt.CancelToken=Wt,Zt.isCancel=Et,Zt.all=function(e){return Promise.all(e)},Zt.spread=function(e){return function(t){return e.apply(null,t)}};var Xt=Zt,Yt=Zt;Xt.default=Yt;var Jt=Xt;class Qt{constructor(e,t,n){this.ctx=e,this.gain=t,this.envelope=n,this.attackNode=e.createGain(),this.decayNode=e.createGain(),this.releaseNode=e.createGain(),this.attackNode.gain.value=0,this.decayNode.gain.value=1,this.releaseNode.gain.value=1,this.attackNode.connect(this.decayNode),this.decayNode.connect(this.releaseNode),this.input=this.attackNode}connect(e,t,n){return e instanceof AudioParam?this.releaseNode.connect(e,t):this.releaseNode.connect(e,t,n),this}schedule(e,t,n){if(t>=0)this.attackNode.gain.setValueAtTime(0,t),this.attackNode.gain.linearRampToValueAtTime(this.gain*e,t+this.envelope.attack),this.decayNode.gain.setTargetAtTime(this.envelope.sustain,t+this.envelope.attack+this.envelope.hold,this.envelope.decay);else if(-t<this.envelope.attack){const n=-t/this.envelope.attack;this.attackNode.gain.setValueAtTime(this.gain*e*n,0),this.attackNode.gain.linearRampToValueAtTime(this.gain*e,t+this.envelope.attack),this.decayNode.gain.setTargetAtTime(this.envelope.sustain,t+this.envelope.attack+this.envelope.hold,this.envelope.decay)}else if(-t<this.envelope.attack+this.envelope.hold)this.attackNode.gain.setValueAtTime(this.gain*e,0),this.decayNode.gain.setTargetAtTime(this.envelope.sustain,t+this.envelope.attack+this.envelope.hold,this.envelope.decay);else{const n=(-t-this.envelope.attack-this.envelope.hold)/this.envelope.decay,r=Math.exp(-n)*(1-this.envelope.sustain)+this.envelope.sustain;this.attackNode.gain.setValueAtTime(this.gain*e,0),this.decayNode.gain.setValueAtTime(r,0),this.decayNode.gain.setTargetAtTime(this.envelope.sustain,0,this.envelope.decay)}return this.releaseNode.gain.setValueAtTime(1,0),this.releaseNode.gain.setTargetAtTime(0,n,this.envelope.release),this}}class Kt{constructor(e,t,n){this.ctx=e,this.gain=t,this.envelope=n,this.attackNode=e.createGain(),this.decayNode=e.createGain(),this.attackNode.gain.value=0,this.decayNode.gain.value=1,this.attackNode.connect(this.decayNode),this.input=this.attackNode}connect(e,t,n){return e instanceof AudioParam?this.decayNode.connect(e,t):this.decayNode.connect(e,t,n),this}schedule(e,t){if(t>=0)this.attackNode.gain.setValueAtTime(0,t),this.attackNode.gain.linearRampToValueAtTime(this.gain*e,t+this.envelope.attack),this.decayNode.gain.setTargetAtTime(0,t+this.envelope.attack+this.envelope.hold,this.envelope.decay);else if(-t<this.envelope.attack){const n=-t/this.envelope.attack;this.attackNode.gain.setValueAtTime(this.gain*e*n,0),this.attackNode.gain.linearRampToValueAtTime(this.gain*e,t+this.envelope.attack),this.decayNode.gain.setTargetAtTime(0,t+this.envelope.attack+this.envelope.hold,this.envelope.decay)}else if(-t<this.envelope.attack+this.envelope.hold)this.attackNode.gain.setValueAtTime(this.gain*e,0),this.decayNode.gain.setTargetAtTime(0,t+this.envelope.attack+this.envelope.hold,this.envelope.decay);else{const n=(-t-this.envelope.attack-this.envelope.hold)/this.envelope.decay,r=Math.exp(-n);this.attackNode.gain.setValueAtTime(this.gain*e,0),this.decayNode.gain.setValueAtTime(r,0),this.decayNode.gain.setTargetAtTime(0,0,this.envelope.decay)}return this}}class en{async schedule(e,t,n,r){await this.setup(e,t),n[this.instrument].forEach(n=>this.loadNote(n,e,t)),Object.values(r[this.instrument]).forEach(n=>this.loadIncompleteNote(n,e,t))}}function tn(e){return 440*Math.pow(2,(e-69)/12)}class nn{constructor(e,t){this.idealFrequency=e.createConstantSource(),this.frequencyParam=this.idealFrequency.offset,this.midFrequency=e.createGain(),this.midFrequency.gain.value=nn.DETUNE,this.idealFrequency.connect(this.midFrequency),this.lowFrequency=e.createGain(),this.lowFrequency.gain.value=nn.LOW_FREQ_MULT,this.midFrequency.connect(this.lowFrequency),this.highFrequency=e.createGain(),this.highFrequency.gain.value=nn.HIGH_FREQ_MULT,this.midFrequency.connect(this.highFrequency),this.lowTricord=new rn(e,t),this.midTricord=new rn(e,t),this.highTricord=new rn(e,t),this.lowFrequency.connect(this.lowTricord.frequencyParam),this.midFrequency.connect(this.midTricord.frequencyParam),this.highFrequency.connect(this.highTricord.frequencyParam),this.lowpass=e.createBiquadFilter(),this.lowpass.type="lowpass",this.lowpassEnvelope=new Kt(e,30,nn.LOW_PASS_ENVELOPE),this.midFrequency.connect(this.lowpassEnvelope.input),this.lowpassEnvelope.connect(this.lowpass.frequency),this.lowTricord.connect(this.lowpass),this.midTricord.connect(this.lowpass),this.highTricord.connect(this.lowpass),this.hammer=new on(e),this.midFrequency.connect(this.hammer.frequencyParam),this.output=e.createGain(),this.output.gain.value=nn.VOLUME,this.lowpass.connect(this.output),this.hammer.connect(this.output)}connect(e,t,n){return e instanceof AudioParam?this.output.connect(e,t):this.output.connect(e,t,n),this}schedule(e){this.idealFrequency.start(Math.max(0,e.startTime)),this.lowpassEnvelope.schedule(1,e.startTime);const t=this.lowTricord.schedule(e),n=this.midTricord.schedule(e),r=this.highTricord.schedule(e),o=this.hammer.schedule(e),i=Math.max(t,n,r,o);this.idealFrequency.stop(i)}scheduleIncomplete(e){this.idealFrequency.start(Math.max(0,e.startTime)),this.lowpassEnvelope.schedule(1,e.startTime),this.lowTricord.scheduleIncomplete(e),this.midTricord.scheduleIncomplete(e),this.highTricord.scheduleIncomplete(e),this.hammer.schedule(e)}}nn.VOLUME=.21,nn.DETUNE=1.003,nn.LOW_FREQ_MULT=.9997,nn.HIGH_FREQ_MULT=1.0008,nn.LOW_PASS_ENVELOPE={attack:0,hold:.01,decay:.5};class rn{constructor(e,t){this.fundamentalFrequency=e.createConstantSource(),this.frequencyParam=this.fundamentalFrequency.offset,this.fundamentalOscillator=e.createOscillator(),this.fundamentalOscillator.frequency.value=0,this.fundamentalFrequency.connect(this.fundamentalOscillator.frequency),this.fundamentalEnvelope=new Qt(e,rn.FUNDAMENTAL_VOLUME,rn.FUNDAMENTAL_ENVELOPE),this.fundamentalOscillator.connect(this.fundamentalEnvelope.input),this.harmonicOscillator=e.createOscillator(),this.harmonicOscillator.frequency.value=0,this.fundamentalFrequency.connect(this.harmonicOscillator.frequency),this.harmonicOscillator.setPeriodicWave(t),this.harmonicEnvelope=new Qt(e,rn.HARMONIC_VOLUME,rn.HARMONIC_ENVELOPE),this.harmonicOscillator.connect(this.harmonicEnvelope.input)}connect(e,t,n){return e instanceof AudioParam?(this.fundamentalEnvelope.connect(e,t),this.harmonicEnvelope.connect(e,t)):(this.fundamentalEnvelope.connect(e,t,n),this.harmonicEnvelope.connect(e,t,n)),this}schedule({startTime:e,endTime:t,volume:n}){const r=t+fn*rn.FUNDAMENTAL_ENVELOPE.release;this.fundamentalFrequency.start(Math.max(0,e)),this.fundamentalFrequency.stop(r),this.fundamentalOscillator.start(Math.max(0,e)),this.fundamentalOscillator.stop(r),this.fundamentalEnvelope.schedule(n,e,t);const o=t+fn*rn.HARMONIC_ENVELOPE.release;return this.harmonicOscillator.start(Math.max(0,e)),this.harmonicOscillator.stop(o),this.harmonicEnvelope.schedule(n,e,t),Math.max(r,o)}scheduleIncomplete({startTime:e,volume:t}){return this.fundamentalFrequency.start(Math.max(0,e)),this.fundamentalOscillator.start(Math.max(0,e)),this.fundamentalEnvelope.schedule(t,e,1e6),this.harmonicOscillator.start(Math.max(0,e)),this.harmonicEnvelope.schedule(t,e,1e6),0}}rn.FUNDAMENTAL_VOLUME=.2,rn.HARMONIC_VOLUME=.1,rn.FUNDAMENTAL_ENVELOPE={attack:.003,hold:.01,decay:2,sustain:0,release:.4},rn.HARMONIC_ENVELOPE={attack:.003,hold:0,decay:1.8,sustain:0,release:.2};class on{constructor(e){this.frequency=e.createConstantSource(),this.frequencyParam=this.frequency.offset,this.oscillator=e.createOscillator(),this.oscillator.type="sawtooth",this.oscillator.frequency.value=0,this.oscillatorFrequency=e.createGain(),this.oscillatorFrequency.gain.value=on.DETUNE,this.oscillatorFrequency.connect(this.oscillator.frequency),this.frequency.connect(this.oscillatorFrequency),this.envelope=new Kt(e,on.VOLUME,on.ENVELOPE),this.oscillator.connect(this.envelope.input)}connect(e,t,n){return e instanceof AudioParam?this.envelope.connect(e,t):this.envelope.connect(e,t,n),this}schedule({startTime:e,volume:t}){const n=e+on.ENVELOPE.hold+fn*on.ENVELOPE.decay;return n>0&&(this.frequency.start(Math.max(0,e)),this.frequency.stop(n),this.oscillator.start(Math.max(0,e)),this.oscillator.stop(n),this.envelope.schedule(t,e)),n}}on.VOLUME=.15,on.ENVELOPE={attack:0,hold:.002,decay:.1},on.DETUNE=1;class an extends en{constructor(){super(...arguments),this.frequencyFrequencyMultiplier=1}async setup(){}async loadNote(e,t,n){const r=tn(e.pitch),o=t.createOscillator();o.type=this.amplitudeWave,o.frequency.value=r,o.start(Math.max(0,e.startTime)),o.stop(e.endTime+fn*this.amplitudeEnvelope.release);const i=new Qt(t,this.amplitudeGain,this.amplitudeEnvelope);o.connect(i.input),i.connect(n),i.schedule(e.volume,e.startTime,e.endTime);const a=t.createOscillator();a.type=this.frequencyWave,a.frequency.value=r*this.frequencyFrequencyMultiplier,a.start(Math.max(0,e.startTime)),a.stop(e.endTime+fn*this.frequencyEnvelope.release);const s=new Qt(t,this.frequencyGain,this.frequencyEnvelope);a.connect(s.input),s.connect(o.frequency),s.schedule(1,e.startTime,e.endTime)}async loadIncompleteNote(e,t,n){const r=tn(e.pitch),o={attack:this.amplitudeEnvelope.attack,hold:this.amplitudeEnvelope.hold,decay:this.amplitudeEnvelope.decay,sustain:this.amplitudeEnvelope.sustain,release:this.amplitudeEnvelope.release},i=t.createOscillator();i.type=this.amplitudeWave,i.frequency.value=r,i.start(Math.max(0,e.startTime));const a=new Qt(t,this.amplitudeGain,o);i.connect(a.input),a.connect(n),a.schedule(e.volume,e.startTime,1e6);const s={attack:this.frequencyEnvelope.attack,hold:this.frequencyEnvelope.hold,decay:this.frequencyEnvelope.decay,sustain:this.frequencyEnvelope.sustain,release:this.frequencyEnvelope.release},c=t.createOscillator();c.type=this.frequencyWave,c.frequency.value=r*this.frequencyFrequencyMultiplier,c.start(Math.max(0,e.startTime));const l=new Qt(t,this.frequencyGain,s);c.connect(l.input),l.connect(i.frequency),l.schedule(1,e.startTime,1e6)}}class sn extends en{constructor(){super(),this.instrument="drums",this.samples={},sn.ENCODINGS.forEach(e=>{this.samples[e-sn.ENCODING_OFFSET]=new cn(e)})}async setup(e){const t=Object.values(this.samples).map(t=>t.setup(e));await Promise.all(t)}async loadNote(e,t,n){const r=e.pitch,o=this.samples[r];void 0!==o?await o.loadNote(e,t,n):console.error("Unknown drum sample "+r)}async loadIncompleteNote(e,t,n){await this.loadNote(e,t,n)}durationOf(e){const t=e+sn.ENCODING_OFFSET,n=sn.ENCODINGS.indexOf(t);return-1===n?null:sn.DURATIONS[n]}}sn.ENCODINGS=[3867,3868,3869,3870,3871,3872,3873,3874,3875,3876,3877,3878,3879,3880,3881,3882,3883,3884,3885,3886,3887,3888,3889,3890,3891,3892,3893,3894,3895,3896,3897,3898,3899,3900,3901,3902,3903,3904,3905,3906,3907,3908,3909,3910,3911,3912,3913,3914,3915,3916,3917,3918,3919,3920,3921,3922,3923,3924,3925,3926,3927],sn.DURATIONS=[.2612244897959184,.2873469387755102,.23510204081632652,.2612244897959184,.23510204081632652,.0783673469387755,.0783673469387755,1.253877551020408,.2873469387755102,.2612244897959184,.23510204081632652,.23510204081632652,.313469387755102,.313469387755102,.6791836734693878,.1306122448979592,.6008163265306122,.1306122448979592,.6008163265306122,.2612244897959184,.5485714285714286,.47020408163265304,2.246530612244898,.3657142857142857,1.2016326530612245,1.123265306122449,1.123265306122449,.4179591836734694,.7836734693877551,.23510204081632652,1.906938775510204,.6791836734693878,1.28,.156734693877551,.23510204081632652,.156734693877551,.2873469387755102,.3395918367346939,.313469387755102,.39183673469387753,.156734693877551,.18285714285714286,.1306122448979592,.156734693877551,.313469387755102,.6008163265306122,.1306122448979592,.3657142857142857,.1306122448979592,.2089795918367347,.2612244897959184,.3395918367346939,.3657142857142857,.18285714285714286,.2612244897959184,.1306122448979592,.4963265306122449,2.6383673469387756,.10448979591836735,.23510204081632652,.9404081632653061],sn.ENCODING_OFFSET=3840;class cn{constructor(e){this.audioBuffer=null,this.arrayBufferPromise=fetch(`drums/${e}.mp3`).then(e=>e.arrayBuffer())}async setup(e){const t=await this.arrayBufferPromise;this.audioBuffer=await e.decodeAudioData(t.slice(0))}async loadNote({startTime:e},t,n){const r=t.createGain();r.gain.value=20,r.connect(n);const o=e<0?-e:0,i=t.createBufferSource();i.buffer=this.audioBuffer,i.connect(r),i.start(Math.max(0,e),o+cn.OFFSET)}async loadIncompleteNote(e,t,n){await this.loadNote(e,t,n)}}function ln(e,t){const n={piano:[],violin:[],cello:[],bass:[],guitar:[],flute:[],clarinet:[],trumpet:[],harp:[],drums:[]},r={piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}};Object.entries(t).forEach(([e,t])=>Object.values(t).forEach(t=>{r[e][t.pitch]=[t]}));let o=0;const i=e.map(dn).filter(e=>null!==e);function a(e,t,n){const i={type:"INCOMPLETE",startTime:o,pitch:Math.round(t),volume:n},a=r[e][t];void 0===a?r[e][t]=[i]:a.push(i)}function s(e,t){const i=r[e][t];if(void 0===i||0===i.length)return void n[e].push({type:"UNSTARTED",endTime:o,pitch:Math.round(t)});const{startTime:a,volume:s}=i.shift();n[e].push({type:"COMPLETE",startTime:a,endTime:o,pitch:t,volume:s}),0===i.length&&delete r[e][t]}function c(e){const t=mn(e);null!==t&&n.drums.push({type:"COMPLETE",startTime:o,endTime:o+t,pitch:e,volume:80})}for(const e of i)if("note"===e.type){const{instrument:t,pitch:n}=e;"drums"===t?c(n):0===e.volume?s(t,n):a(t,n,e.volume)}else l=e.delay,o+=.00923081517*l;var l;const u=[];return n.drums.forEach(e=>{const t=e;if(t.endTime>o){const e={type:"INCOMPLETE",startTime:t.startTime,pitch:t.pitch,volume:80},n=r.drums[t.pitch];void 0===n?r.drums[t.pitch]=[e]:n.push(e)}else u.push(t)}),n.drums=u,{notes:n,activeAtEnd:r,duration:o}}cn.OFFSET=.051;const un=[["piano",0],["piano",24],["piano",32],["piano",40],["piano",48],["piano",56],["piano",64],["piano",72],["piano",80],["piano",88],["piano",96],["piano",104],["piano",112],["piano",120],["violin",80],["violin",0],["cello",80],["cello",0],["bass",80],["bass",0],["guitar",80],["guitar",0],["flute",80],["flute",0],["clarinet",80],["clarinet",0],["trumpet",80],["trumpet",0],["harp",80],["harp",0],["drums",80]];function dn(e){if(e>=0&&e<3968){const[t,n]=un[e>>7];return{type:"note",pitch:e%128,instrument:t,volume:n}}return e<4096?{type:"wait",delay:e%128+1}:4097===e?{type:"wait",delay:100}:null}const fn=5,hn={bass:new class extends an{constructor(){super(...arguments),this.instrument="bass",this.amplitudeEnvelope={attack:.001,hold:.01,decay:.5,sustain:0,release:.05},this.amplitudeGain=.1,this.amplitudeWave="sine",this.frequencyEnvelope={attack:.001,hold:.01,decay:1,sustain:1,release:.05},this.frequencyGain=3,this.frequencyWave="sine",this.frequencyFrequencyMultiplier=3}},cello:new class extends en{constructor(){super(...arguments),this.instrument="cello"}async setup(e,t){}async loadNote(e,t,n){const r=tn(e.pitch),o=t.createOscillator();o.frequency.value=r,o.type="sawtooth";const i=t.createOscillator();i.frequency.value=6.43,i.type="sine";const a=new Qt(t,25,{attack:.3,hold:.1,decay:1,sustain:.9,release:.01});i.connect(a.input),a.connect(o.detune);const s=new Qt(t,1,{attack:.1,hold:0,decay:.3,sustain:.7,release:.1});o.connect(s.input);const c=t.createBiquadFilter();s.connect(c),c.type="lowpass",c.gain.value=12,c.frequency.value=4e3;const l=[{sigIn:.5,gain:24,freq:150,resonance:3.5},{sigIn:.8,gain:24,freq:350,resonance:3.5},{sigIn:1,gain:12,freq:r,resonance:2}],u=t.createBiquadFilter();u.type="highpass",u.gain.value=12,u.frequency.value=100;l.map(e=>{const n=t.createGain();n.gain.value=e.sigIn;const r=t.createBiquadFilter();r.frequency.value=e.freq,r.gain.value=e.gain,r.Q.value=e.resonance,r.type="bandpass",c.connect(n),n.connect(r),r.connect(u)});const d=t.createGain();d.gain.value=.21,u.connect(d),d.connect(n),o.start(Math.max(0,e.startTime)),i.start(Math.max(0,e.startTime)),o.stop(e.endTime+1),i.stop(e.endTime+1);"COMPLETE"===e.type&&e.endTime;a.schedule(1,e.startTime,e.endTime),s.schedule(e.volume,e.startTime,e.endTime)}async loadIncompleteNote(e,t,n){const r=tn(e.pitch),o=t.createOscillator();o.frequency.value=r,o.type="sawtooth";const i=t.createOscillator();i.frequency.value=6.43,i.type="sine";const a=new Qt(t,25,{attack:.3,hold:.1,decay:1,sustain:.9,release:.01});i.connect(a.input),a.connect(o.detune);const s=new Qt(t,1,{attack:.1,hold:0,decay:.3,sustain:.7,release:.1});o.connect(s.input);const c=t.createBiquadFilter();s.connect(c),c.type="lowpass",c.gain.value=12,c.frequency.value=4e3;const l=[{sigIn:.5,gain:24,freq:150,resonance:3.5},{sigIn:.8,gain:24,freq:350,resonance:3.5},{sigIn:1,gain:12,freq:r,resonance:2}],u=t.createBiquadFilter();u.type="highpass",u.gain.value=12,u.frequency.value=100;l.map(e=>{const n=t.createGain();n.gain.value=e.sigIn;const r=t.createBiquadFilter();r.frequency.value=e.freq,r.gain.value=e.gain,r.Q.value=e.resonance,r.type="bandpass",c.connect(n),n.connect(r),r.connect(u)});const d=t.createGain();d.gain.value=.21,u.connect(d),d.connect(n),o.start(Math.max(0,e.startTime)),i.start(Math.max(0,e.startTime));a.schedule(1,e.startTime,1e6),s.schedule(e.volume,e.startTime,1e6)}},clarinet:new class extends an{constructor(){super(...arguments),this.instrument="clarinet",this.amplitudeEnvelope={attack:.05,hold:.01,decay:.1,sustain:.8,release:.05},this.amplitudeGain=.135,this.amplitudeWave="square",this.amplitudePitchAdjustment=null,this.amplitudeFrequencyMultiplier=1,this.frequencyEnvelope={attack:.001,hold:.01,decay:.1,sustain:1.1,release:.05},this.frequencyGain=4,this.frequencyWave="square",this.frequencyPitchAdjustment=null,this.frequencyFrequencyMultiplier=1,this.offDelay=.25}},drums:new sn,flute:new class extends an{constructor(){super(...arguments),this.instrument="flute",this.amplitudeEnvelope={attack:.03,hold:.01,decay:.4,sustain:.4,release:.05},this.amplitudeGain=.9,this.amplitudeWave="sine",this.amplitudePitchAdjustment=null,this.amplitudeFrequencyMultiplier=1,this.frequencyEnvelope={attack:.001,hold:.01,decay:.4,sustain:0,release:.05},this.frequencyGain=4,this.frequencyWave="sine",this.frequencyPitchAdjustment=null,this.frequencyFrequencyMultiplier=2,this.offDelay=.25}},guitar:new class extends an{constructor(){super(...arguments),this.instrument="guitar",this.amplitudeEnvelope={attack:.001,hold:.01,decay:.5,sustain:0,release:.05},this.amplitudeGain=.12,this.amplitudeWave="sine",this.amplitudePitchAdjustment=null,this.amplitudeFrequencyMultiplier=1,this.frequencyEnvelope={attack:.001,hold:.01,decay:1,sustain:.1,release:.05},this.frequencyGain=5,this.frequencyWave="triangle",this.frequencyPitchAdjustment=null,this.frequencyFrequencyMultiplier=3,this.offDelay=.25}},harp:new class extends an{constructor(){super(...arguments),this.instrument="harp",this.amplitudeEnvelope={attack:.001,hold:.01,decay:.5,sustain:0,release:.5},this.amplitudeGain=.07,this.amplitudeWave="sine",this.amplitudePitchAdjustment=null,this.amplitudeFrequencyMultiplier=1,this.frequencyEnvelope={attack:.001,hold:.01,decay:1,sustain:0,release:1},this.frequencyGain=7,this.frequencyWave="sine",this.frequencyPitchAdjustment=null,this.frequencyFrequencyMultiplier=2,this.offDelay=.25}},piano:new class extends en{constructor(){super(...arguments),this.instrument="piano",this.harmonicWave=null}async setup(e,t){const n=new Float32Array(15),r=new Float32Array(15);n.fill(1),r.fill(0),n[0]=0,this.harmonicWave=e.createPeriodicWave(n,r)}async loadNote(e,t,n){const r=new nn(t,this.harmonicWave);r.frequencyParam.value=tn(e.pitch),r.connect(n),r.schedule(e)}async loadIncompleteNote(e,t,n){const r=new nn(t,this.harmonicWave);r.frequencyParam.value=tn(e.pitch),r.connect(n),r.scheduleIncomplete(e)}},trumpet:new class extends an{constructor(){super(...arguments),this.instrument="trumpet",this.amplitudeEnvelope={attack:.01,hold:.01,decay:1,sustain:.6,release:.04},this.amplitudeGain=.12,this.amplitudeWave="square",this.amplitudePitchAdjustment=null,this.amplitudeFrequencyMultiplier=1,this.frequencyEnvelope={attack:.001,hold:.01,decay:.1,sustain:4,release:.05},this.frequencyGain=1,this.frequencyWave="sine",this.frequencyPitchAdjustment=null,this.frequencyFrequencyMultiplier=1,this.offDelay=.25}},violin:new class extends en{constructor(){super(...arguments),this.instrument="violin"}async setup(e,t){}async loadNote(e,t,n){const r=tn(e.pitch),o=t.createOscillator();o.frequency.value=r,o.type="sawtooth";const i=t.createOscillator();i.frequency.value=6.43,i.type="sine";const a=new Qt(t,25,{attack:.3,hold:.1,decay:1,sustain:.9,release:.01});i.connect(a.input),a.connect(o.detune);const s=new Qt(t,1,{attack:.1,hold:0,decay:.3,sustain:.6,release:.05});o.connect(s.input);const c=t.createBiquadFilter();s.connect(c),c.type="lowpass",c.gain.value=12,c.frequency.value=6e3;const l=[{sigIn:.5,gain:24,freq:300,resonance:3.5},{sigIn:.8,gain:24,freq:700,resonance:3.5},{sigIn:1,gain:12,freq:r,resonance:2}],u=t.createBiquadFilter();u.type="highpass",u.gain.value=12,u.frequency.value=200;l.map(e=>{const n=t.createGain();n.gain.value=e.sigIn;const r=t.createBiquadFilter();r.frequency.value=e.freq,r.gain.value=e.gain,r.Q.value=e.resonance,r.type="bandpass",c.connect(n),n.connect(r),r.connect(u)});const d=t.createGain();d.gain.value=.2,u.connect(d),d.connect(n),o.start(Math.max(0,e.startTime)),i.start(Math.max(0,e.startTime)),o.stop(e.endTime+1),i.stop(e.endTime+1),a.schedule(1,e.startTime,e.endTime),s.schedule(e.volume,e.startTime,e.endTime)}async loadIncompleteNote(e,t,n){const r=tn(e.pitch),o=t.createOscillator();o.frequency.value=r,o.type="sawtooth";const i=t.createOscillator();i.frequency.value=6.43,i.type="sine";const a=new Qt(t,25,{attack:.3,hold:.1,decay:1,sustain:.9,release:.01});i.connect(a.input),a.connect(o.detune);const s=new Qt(t,1,{attack:.1,hold:0,decay:.3,sustain:.6,release:.05});o.connect(s.input);const c=t.createBiquadFilter();s.connect(c),c.type="lowpass",c.gain.value=12,c.frequency.value=6e3;const l=[{sigIn:.5,gain:24,freq:300,resonance:3.5},{sigIn:.8,gain:24,freq:700,resonance:3.5},{sigIn:1,gain:12,freq:r,resonance:2}],u=t.createBiquadFilter();u.type="highpass",u.gain.value=12,u.frequency.value=200;l.map(e=>{const n=t.createGain();n.gain.value=e.sigIn;const r=t.createBiquadFilter();r.frequency.value=e.freq,r.gain.value=e.gain,r.Q.value=e.resonance,r.type="bandpass",c.connect(n),n.connect(r),r.connect(u)});const d=t.createGain();d.gain.value=.2,u.connect(d),d.connect(n),o.start(Math.max(0,e.startTime)),i.start(Math.max(0,e.startTime));a.schedule(1,e.startTime,1e6),s.schedule(e.volume,e.startTime,1e6)}}};async function pn(e,t,n){const r=new OfflineAudioContext(1,44100*n,44100),o=r.createGain();o.gain.value=.0025,o.connect(r.destination);const i=Object.values(hn).map(n=>n.schedule(r,o,e,t));return await Promise.all(i),await r.startRendering()}function mn(e){return hn.drums.durationOf(e)}const gn={bass:5,guitar:5,harp:5,piano:10,violin:10,cello:10,flute:10,trumpet:10,clarinet:10},yn={bass:.02,guitar:.02,harp:.02,piano:.02,violin:.02,cello:.02,flute:.02,trumpet:.02,clarinet:.02},vn={bass:.01,guitar:.01,harp:.01,piano:.01,violin:.01,cello:.01,flute:.01,trumpet:.01,clarinet:.01};function $n(e){const t=[];Oe.forEach(n=>{const r=e.notes[n],o=Object.values(e.activeAtEnd[n]).flat();r.forEach(e=>{t.push({instrument:n,pitch:e.pitch,volume:e.volume,time:e.startTime}),"drums"!==n&&t.push({instrument:n,pitch:e.pitch,volume:0,time:e.endTime})}),o.forEach(e=>{t.push({instrument:n,pitch:e.pitch,volume:e.volume,time:e.startTime})})}),t.sort((e,t)=>e.time-t.time);let n=0;const r=[];function o(e){const t=e-n,o=Math.round(t/.00923081517);if(0!==o){const e=Math.floor(o/128);for(let t=0;t<e;t++)r.push(4095);const t=o%128;0!==t&&r.push(3967+t),n+=.00923081517*o}}return t.filter(e=>e.time>=0).filter(t=>t.time<=e.duration).forEach(e=>{o(e.time),function(e){const t=128*bn.findIndex(t=>t[0]===e.instrument&&t[1]===e.volume)+e.pitch;r.push(t)}(e)}),o(e.duration),e.encoding=r,e}const bn=[["piano",0],["piano",24],["piano",32],["piano",40],["piano",48],["piano",56],["piano",64],["piano",72],["piano",80],["piano",88],["piano",96],["piano",104],["piano",112],["piano",120],["violin",80],["violin",0],["cello",80],["cello",0],["bass",80],["bass",0],["guitar",80],["guitar",0],["flute",80],["flute",0],["clarinet",80],["clarinet",0],["trumpet",80],["trumpet",0],["harp",80],["harp",0],["drums",80]];function wn(e){return e.sort((e,t)=>e.startTime-t.startTime)}function xn(e){const t={notes:{piano:[],violin:[],cello:[],bass:[],guitar:[],flute:[],clarinet:[],trumpet:[],harp:[],drums:[]},activeAtEnd:{piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}},duration:e.duration,encoding:[]};return Oe.forEach(n=>{const r=e.notes[n];let o=r.filter(e=>"UNSTARTED"!==e.type);o=wn(o);let i=e.activeAtEnd[n];if("drums"!==n){const[t,r]=function(e,t,n,r){const o=yn[e];if(null===o)return[n,r];const i=[],a=[];return n.forEach(e=>{if(e.endTime-e.startTime<o){e.startTime+o>t?a.push({...e,type:"INCOMPLETE"}):i.push({...e,endTime:e.startTime+o})}else i.push(e)}),a.forEach(e=>{const t=r[e.pitch];void 0===t?r[e.pitch]=[e]:t.push(e)}),[i,r]}(n,e.duration,o,i);o=t,i=r}const[a,s]=function(e,t,n){const r="drums"===e?0:vn[e],o=wn([...t,...Object.values(n).flat()]),i={};o.forEach(e=>{void 0===i[e.pitch]&&(i[e.pitch]=[]),i[e.pitch].push(e)});const a=[],s={};return Object.values(i).forEach(e=>{let t=null;for(let n of e)null!==t&&(("INCOMPLETE"===t.type||t.endTime>n.startTime-r)&&(t={...t,type:"COMPLETE",endTime:Math.max(0,n.startTime-r)}),a.push(t)),t=n;null!==t&&("COMPLETE"===t.type?a.push(t):s[t.pitch]=t)}),[a,s]}(n,o,i);o=a;let c=s;const[l,u]=function(e,t,n,r){const o="drums"===e?mn:()=>gn[e];n.forEach(e=>{const t=o(e.pitch);null!==t&&(e.endTime=Math.min(e.endTime,e.startTime+t))});const i={};return Object.values(r).forEach(e=>{const r=e.pitch,a=t-e.startTime,s=o(r);null!==s&&a>s?n.push({...e,type:"COMPLETE",endTime:e.startTime+s}):i[r]=e}),[wn(n),i]}(n,e.duration,o,c);o=l,c=u,o=function(e){return e.filter(e=>e.startTime<e.endTime)}(o),t.notes[n]=o,t.activeAtEnd[n]=c}),$n(t)}async function kn(e,t,n){if("root"===t.type)return await Tn(e,t,[],{piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}},0,0);if("branch"===t.type&&"branch"===n.type)return await Tn(e,t,n.encoding,n.section.activeNotesAtEnd,n.section.startsAt,n.section.endsAt);throw new Error("Unrecognised combination of store and state types "+t.type+"/"+n.type)}async function Tn(e,t,n,r,o,i){const a=n.slice(-e.requestLength),s={...e,encoding:rt(a),audioFormat:"mp3"};t.updatePendingLoad(e=>e+4);let c=null;for(;null===c;)c=await Jt({method:"POST",url:"https://musenet.openai.com/sample",data:s}).then(e=>e.data.completions).catch(()=>[]);const l=c.map(e=>async function(e,t,n,r,o){const i={piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}},a=o-r;Oe.forEach(e=>Object.values(n[e]).forEach(t=>{i[e][t.pitch]={...t,startTime:t.startTime-a}}));const s=xn(ln(ot(e.encoding).slice(t.length),i)),c=o,l=c+s.duration,u=await pn(s.notes,s.activeAtEnd,l-c);return{encoding:s.encoding,startsAt:c,endsAt:l,notes:s.notes,activeNotesAtEnd:s.activeAtEnd,audio:u}}(e,a,r,o,i));return Promise.all(l).then(e=>e.map(e=>it(e))).then(e=>e.map(e=>t.addChild(e))).finally(()=>t.updatePendingLoad(e=>e-4))}const{subscribe:Cn,set:En,update:In}=Me([]),Sn={subscribe:Cn,onDelete:(e,t)=>{In(n=>[...n,{parentStore:e,childIdx:t}])},undo:()=>In(e=>{if(0===e.length)return e;const{parentStore:t,childIdx:n}=e[e.length-1];return t.showChild(n),e.slice(0,-1)}),clear:()=>En([])};function An(e){const t=JSON.stringify({encoding:"",children:[]});return Qe(Ne(e,e=>{const n=e.children,r=Object.values(n).map(e=>e.serialisedStore),o=0===r.length?Me([]):Ne(r,e=>e),i=rt(e.section.encoding);return Ke(o,e=>`{"encoding":"${i}","children":[${e.join(",")}]}`,t)}),t)}function Mn(e){const t=JSON.stringify({children:[]});return Qe(Ne(e,e=>{const n=e.children,r=Object.values(n).map(e=>e.serialisedStore);return Ke(0===r.length?Me([]):Ne(r,e=>e),e=>`{"children":[${e.join(",")}]}`,t)}),t)}function Nn(e){return Qe(Ne(e,({children:e})=>{const t=Object.values(e);if(0===t.length)return Me([]);const n=t.map(e=>Ne([e,e.numberOfLeavesStore],([e,t])=>[e.path[e.path.length-1],t]));return Ne(n,e=>{let t=0;const n=[];return e.forEach(([e,r])=>{n.push([e,t+r/2]),t+=r}),n})}),[],On)}function On(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){if(e[n][0]!==t[n][0])return!1;if(e[n][1]!==t[n][1])return!1}return!0}const qn=Me({pendingLoad:0});const Un=ft(qn,(Pn=qn,e=>{return{addChild:async t=>{const n=Me({pendingLoad:0});return await e.addChild(Dn(e,t,n),function e(t){return n=>{return{addChild:async t=>{const r=Me({pendingLoad:0});return await n.addChild(Dn(n,t,r),e(r))},deleteChildWithUndo:async e=>{const t=await n.hideChild(e);return null===t?null:(Sn.onDelete(n,e),t)},updatePendingLoad:e=>{t.update(t=>({...t,pendingLoad:e(t.pendingLoad)}))},serialisedStore:An(n),selectedSectionsStore:(r=n,Qe(Ne(r,e=>{const t=e.selectedChild;if(null===t)return Me([e.section]);const n=e.children[t];return void 0===n?Me([e.section]):Ne(n.selectedSectionsStore,t=>[e.section,...t])}),[],at)),placementStore:Nn(n)};var r}}(n))},deleteChildWithUndo:async t=>{const n=await e.hideChild(t);return null===n?null:(Sn.onDelete(e,t),n)},updatePendingLoad:e=>{Pn.update(t=>({...t,pendingLoad:e(t.pendingLoad)}))},serialisedStore:Mn(e),selectedSectionsStore:(t=e,Qe(Ne(t,e=>{const t=e.selectedChild;if(null===t)return Me([]);const n=e.children[t];return void 0===n?Me([]):n.selectedSectionsStore}),[],at)),placementStore:Nn(e)};var t}));var Pn;function Dn(e,t,n){return Ne([t,function(e,t){return null===e?tt():"root"===e.type?nt(tt(),t):nt(e,t)}(e,t),n],([e,t,n])=>({...e,...t,...n}))}const Bn=function(e,t=((e,t)=>e===t)){let n=null;const r=Me(null);let o=()=>{};return e.subscribe(e=>{o(),null!==e?o=e.subscribe(e=>{(null===n&&null!==e||null!==n&&null===e||null!==n&&null!==e&&!t(n,e))&&(n=e,r.set(e))}):(o=()=>{},n=null,r.set(null))}),r}(Un.selectedStore_2,(e,t)=>et(e.path,t.path)),jn=Ke(Bn,e=>null===e?null:e.encoding,null,(e,t)=>function(e,t,n=((e,t)=>e===t)){return null===e&&null===t||null!==e&&null!==t&&et(e,t,n)}(e,t));let Ln=null;He.subscribe(e=>{Ln=e});let Fn=null;function Rn(e){return Ne(e,e=>e)}Je.subscribe(e=>{Fn=e}),Ne([Un.selectedStore_2,Bn],([e,t])=>null===e||null===t?null:[e,t]).subscribe(async e=>{if(null===e||!Ln)return;const[t,n]=e;Object.keys(n.children).length||n.pendingLoad||await kn(Fn,t,n)}),Un.serialisedStore.subscribe(e=>{'{"children":[]}'!==e&&localStorage.setItem("autosave",e)});async function _n(e){const t=e.map(e=>({start:e.startsAt,end:e.endsAt,buffer:e.audio}));return await async function(e){const t=Math.max(...e.map(e=>e.end))+2,n=new OfflineAudioContext(1,44100*t,44100);return e.forEach(({buffer:e,start:t})=>{const r=n.createBufferSource();r.buffer=e,r.connect(n.destination),r.start(t)}),await n.startRendering()}(t)}const Hn=Me({type:"off"}),zn=Hn;let Vn={type:"off"};zn.subscribe(e=>{Vn=e});let Wn=null;const Gn=new AudioContext({sampleRate:44100});let Zn=!1,Xn=0;We.subscribe(e=>Zn=e),Ge.subscribe(e=>Xn=e);let Yn=null;async function Jn(e){null!==Yn&&("on"===Vn.type&&Qn(),Hn.set({type:"starting"}),Wn=Gn.createBufferSource(),Wn.buffer=Yn.buffer,Wn.connect(Gn.destination),Wn.onended=Qn,Wn.start(void 0,e),Hn.set({type:"on",started:Gn.currentTime,offset:e,duration:Yn.duration}))}function Qn(){Wn&&(Wn.onended=()=>{},Wn.stop(),Wn=null,Hn.set({type:"off"}))}Un.selectedSectionsStore.subscribe((async function(e){if(Qn(),null===e||0===e.length)return;zn.set({type:"loading"});const t=await _n(e),n=e[e.length-1].endsAt;if(Yn={buffer:t,duration:n},Zn){const t=e[e.length-1].startsAt-Xn,n=Math.max(t,0);await Jn(n)}}));const Kn={bass:"#f07178",drums:"#c3e88d",guitar:"#89ddff",harp:"#f78c6c",piano:"#ffcb6b",strings:"#c792ea",violin:"#c792ea",cello:"#c792ea",flute:"#c3cee3",trumpet:"#c3cee3",clarinet:"#c3cee3",winds:"#c3cee3",bgLight:"#263238",bgDark:"#1f292e",text:"#c3cee3",textDark:"#82b6cc",textEmphasis:"#314549",border:"#37474f",buttonBg:"#314147",buttonBgDisabled:"#273339",nodePlaying:"#c3e88d",nodeActive:"#f07178",nodeWarm:"#f78c6c",nodeInactive:"#c3cee3",edgePlaying:"#c3e88d",edgeActive:"#f07178",edgeWarm:"#f78c6c",edgeInactive:"#c3cee3",pendingLoadText:"#c3e88d",loadingBarBG:"#c3cee3",loadingBarFG:"#c3e88d",loadingBarText:"#1f292e"},er={styleWindow:{background:Kn.bgDark,border:"1px solid "+Kn.border,color:Kn.textDark}},tr=Me(!0),nr=Me(!0),rr=Me(!0),or=Me(!0),ir=Me(!0),ar=Me(!0),sr=Me(!0),cr=Me(!0),lr=Me(!0),ur=Me(!0),dr={bass:tr,drums:nr,guitar:rr,harp:or,piano:ir,violin:ar,cello:sr,flute:cr,trumpet:lr,clarinet:ur},fr=Ne([tr,nr,rr,or,ir,ar,sr,cr,lr,ur],([e,t,n,r,o,i,a,s,c,l])=>({bass:e,drums:t,guitar:n,harp:r,piano:o,violin:i,cello:a,flute:s,trumpet:c,clarinet:l})),hr=e=>({loaded:2&e}),pr=e=>({loaded:e[1]});function mr(e){let t,n;const r=e[4].default,o=d(r,e,e[3],pr);return{c(){t=C("div"),o&&o.c(),q(t,"class","guard svelte-87nbkm")},m(r,i){x(r,t,i),o&&o.m(t,null),e[5](t),n=!0},p(e,[t]){o&&o.p&&10&t&&h(o,r,e,e[3],t,hr,pr)},i(e){n||(ge(o,e),n=!0)},o(e){ye(o,e),n=!1},d(n){n&&k(t),o&&o.d(n),e[5](null)}}}function gr(e,t,n){let r,o,{root:i}=t,a=!1,s=!1;var c;function l(){o&&r&&(o.unobserve(r),s=!1)}G(()=>{r&&(o=new IntersectionObserver(e=>{n(1,a=a||e.some(e=>e.isIntersecting)),a&&l()},{rootMargin:"100px",root:i,threshold:0}),o.observe(r),s=!0)}),c=()=>{s&&l()},W().$$.on_destroy.push(c);let{$$slots:u={},$$scope:d}=t;return e.$set=e=>{"root"in e&&n(2,i=e.root),"$$scope"in e&&n(3,d=e.$$scope)},[r,a,i,d,u,function(e){K[e?"unshift":"push"](()=>{r=e,n(0,r)})}]}class yr extends Se{constructor(e){super(),Ie(this,e,gr,mr,s,{root:2})}}var vr={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};var $r=["Webkit","ms","Moz","O"];Object.keys(vr).forEach((function(e){$r.forEach((function(t){vr[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=vr[e]}))}));var br=/^ms-/,wr=/([A-Z])/g;var xr=function(e){return function(e){return e.replace(wr,"-$1").toLowerCase()}(e).replace(br,"-ms-")},kr={isUnitlessNumber:vr,shorthandPropertyExpansions:{background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}}}.isUnitlessNumber,Tr=Array.isArray,Cr=Object.keys,Er=/^(normal|none|(\b(url\([^)]*\)|chapter_counter|attr\([^)]*\)|(no-)?(open|close)-quote|inherit)((\b\s*)|$|\s+))+)$/;function Ir(e,t){return kr[e]||"number"!=typeof t?"content"!==e||Er.test(t)||(t="'"+t.replace(/'/g,"\\'")+"'"):t+="px",xr(e)+": "+t+";  "}var Sr=function(e){var t="";if(!e||0===Cr(e).length)return t;for(var n=Cr(e),r=0,o=n.length;r<o;r++){var i=n[r],a=e[i];if(Tr(a))for(var s=0,c=a.length;s<c;s++)t+=Ir(i,a[s]);else t+=Ir(i,a)}return t};function Ar(e,t,n){const r=e.slice();return r[22]=t[n],r}function Mr(e,t,n){const r=e.slice();return r[18]=t[n][0],r[19]=t[n][1],r[21]=n,r}function Nr(e,t,n){const r=e.slice();return r[22]=t[n],r}function Or(e,t,n){const r=e.slice();return r[18]=t[n][0],r[19]=t[n][1],r[21]=n,r}function qr(e){let t,n,r,o,i;return n=new yr({props:{root:e[0],$$slots:{default:[Hr,({loaded:e})=>({17:e}),({loaded:e})=>e?131072:0]},$$scope:{ctx:e}}}),{c(){t=C("div"),ke(n.$$.fragment),q(t,"class",r=p(["sectionContainer","borders"].join(" "))+" svelte-8vsne3"),q(t,"style",o=Sr({borderColor:Kn.border,height:e[4],top:e[5]}))},m(e,r){x(e,t,r),Te(n,t,null),i=!0},p(e,r){const a={};1&r&&(a.root=e[0]),268568478&r&&(a.$$scope={dirty:r,ctx:e}),n.$set(a),(!i||48&r&&o!==(o=Sr({borderColor:Kn.border,height:e[4],top:e[5]})))&&q(t,"style",o)},i(e){i||(ge(n.$$.fragment,e),i=!0)},o(e){ye(n.$$.fragment,e),i=!1},d(e){e&&k(t),Ce(n)}}}function Ur(e){let t,n,r,o,i,a,s=null!==e[8]&&Pr(e),c=null!==e[7]&&Lr(e);return{c(){t=E("svg"),s&&s.c(),n=A(),c&&c.c(),q(t,"viewBox",r=`${e[1]} 0 ${e[2]+2} ${e[3]}`),q(t,"width","100%"),q(t,"height",o=Math.floor(e[4]-1)),q(t,"style",e[9]),q(t,"class","sectionCanvas svelte-8vsne3"),q(t,"preserveAspectRatio","none")},m(r,o){x(r,t,o),s&&s.m(t,null),w(t,n),c&&c.m(t,null),i||(a=M(t,"click",e[11]),i=!0)},p(e,i){null!==e[8]?s?s.p(e,i):(s=Pr(e),s.c(),s.m(t,n)):s&&(s.d(1),s=null),null!==e[7]?c?c.p(e,i):(c=Lr(e),c.c(),c.m(t,null)):c&&(c.d(1),c=null),14&i&&r!==(r=`${e[1]} 0 ${e[2]+2} ${e[3]}`)&&q(t,"viewBox",r),16&i&&o!==(o=Math.floor(e[4]-1))&&q(t,"height",o),512&i&&q(t,"style",e[9])},d(e){e&&k(t),s&&s.d(),c&&c.d(),i=!1,a()}}}function Pr(e){let t,n=e[8],r=[];for(let t=0;t<n.length;t+=1)r[t]=jr(Or(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(1280&o){let i;for(n=e[8],i=0;i<n.length;i+=1){const a=Or(e,n,i);r[i]?r[i].p(a,o):(r[i]=jr(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function Dr(e){let t,n=e[19],r=[];for(let t=0;t<n.length;t+=1)r[t]=Br(Nr(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(256&o){let i;for(n=e[19],i=0;i<n.length;i+=1){const a=Nr(e,n,i);r[i]?r[i].p(a,o):(r[i]=Br(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function Br(e){let t,n,r,o,i,a;return{c(){t=E("rect"),q(t,"x",n=e[22].pitch+e[21]/Oe.length),q(t,"width","1"),q(t,"y",r=e[22].startTime),q(t,"height",o=e[22].endTime-e[22].startTime),q(t,"fill",i=Kn[e[18]]),q(t,"stroke",a=Kn.border),q(t,"stroke-width","1px"),q(t,"vector-effect","non-scaling-stroke")},m(e,n){x(e,t,n)},p(e,a){256&a&&n!==(n=e[22].pitch+e[21]/Oe.length)&&q(t,"x",n),256&a&&r!==(r=e[22].startTime)&&q(t,"y",r),256&a&&o!==(o=e[22].endTime-e[22].startTime)&&q(t,"height",o),256&a&&i!==(i=Kn[e[18]])&&q(t,"fill",i)},d(e){e&&k(t)}}}function jr(e){let t,n=e[10][e[18]]&&Dr(e);return{c(){n&&n.c(),t=A()},m(e,r){n&&n.m(e,r),x(e,t,r)},p(e,r){e[10][e[18]]?n?n.p(e,r):(n=Dr(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Lr(e){let t,n=e[7],r=[];for(let t=0;t<n.length;t+=1)r[t]=_r(Mr(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(1152&o){let i;for(n=e[7],i=0;i<n.length;i+=1){const a=Mr(e,n,i);r[i]?r[i].p(a,o):(r[i]=_r(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function Fr(e){let t,n=e[19],r=[];for(let t=0;t<n.length;t+=1)r[t]=Rr(Ar(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(128&o){let i;for(n=e[19],i=0;i<n.length;i+=1){const a=Ar(e,n,i);r[i]?r[i].p(a,o):(r[i]=Rr(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function Rr(e){let t,n,r,o,i,a;return{c(){t=E("rect"),q(t,"x",n=e[22].pitch+e[21]/Oe.length),q(t,"width","1"),q(t,"y",r=e[22].startTime),q(t,"height",o=1e6),q(t,"fill",i=Kn[e[18]]),q(t,"stroke",a=Kn.border),q(t,"stroke-width","1px"),q(t,"vector-effect","non-scaling-stroke")},m(e,n){x(e,t,n)},p(e,o){128&o&&n!==(n=e[22].pitch+e[21]/Oe.length)&&q(t,"x",n),128&o&&r!==(r=e[22].startTime)&&q(t,"y",r),128&o&&i!==(i=Kn[e[18]])&&q(t,"fill",i)},d(e){e&&k(t)}}}function _r(e){let t,n=e[10][e[18]]&&Fr(e);return{c(){n&&n.c(),t=A()},m(e,r){n&&n.m(e,r),x(e,t,r)},p(e,r){e[10][e[18]]?n?n.p(e,r):(n=Fr(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Hr(e){let t,n=e[17]&&Ur(e);return{c(){n&&n.c(),t=A()},m(e,r){n&&n.m(e,r),x(e,t,r)},p(e,r){e[17]?n?n.p(e,r):(n=Ur(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function zr(e){let t,n,r=null!==e[6]&&qr(e);return{c(){r&&r.c(),t=A()},m(e,o){r&&r.m(e,o),x(e,t,o),n=!0},p(e,[n]){null!==e[6]?r?(r.p(e,n),64&n&&ge(r,1)):(r=qr(e),r.c(),ge(r,1),r.m(t.parentNode,t)):r&&(pe(),ye(r,1,1,()=>{r=null}),me())},i(e){n||(ge(r),n=!0)},o(e){ye(r),n=!1},d(e){r&&r.d(e),e&&k(t)}}}function Vr(e,t,n){let r,o;u(e,Ze,e=>n(16,r=e)),u(e,fr,e=>n(10,o=e));let i,a,s,c,l,d,f,h,p,m,{viewport:g}=t,{section:y}=t,{pitchMin:v}=t,{pitchMax:$}=t;return e.$set=e=>{"viewport"in e&&n(0,g=e.viewport),"section"in e&&n(12,y=e.section),"pitchMin"in e&&n(1,v=e.pitchMin),"pitchMax"in e&&n(13,$=e.pitchMax)},e.$$.update=()=>{8194&e.$$.dirty&&n(2,i=$-v),4096&e.$$.dirty&&n(14,a=y?y.startsAt:null),20480&e.$$.dirty&&n(3,s=null!==y&&null!==a?y.endsAt-a:0),65544&e.$$.dirty&&n(4,c=s*r),81920&e.$$.dirty&&n(5,l=(a||0)*r),4096&e.$$.dirty&&n(6,d=y?y.notes:null),4096&e.$$.dirty&&n(15,f=y?y.activeNotesAtEnd:null),32768&e.$$.dirty&&n(7,h=f?Object.entries(f).map(([e,t])=>[e,Object.values(t)]):null),64&e.$$.dirty&&n(8,p=d?Object.entries(d):null)},n(9,m=Sr({backgroundColor:Kn.bgLight})),[g,v,i,s,c,l,d,h,p,m,o,function(e){const t=e.target.getBoundingClientRect(),n=e.clientY-t.top,r=s*(n/c);Jn(y.startsAt+r)},y,$]}class Wr extends Se{constructor(e){super(),Ie(this,e,Vr,zr,s,{viewport:0,section:12,pitchMin:1,pitchMax:13})}}function Gr(t){let n,r,o,i;return{c(){n=C("div"),r=C("div"),q(r,"class","line svelte-1tc0wps"),r.hidden=t[1],q(n,"class","anchor svelte-1tc0wps")},m(e,a){x(e,n,a),w(n,r),t[2](n),o||(i=M(n,"introend",t[3]),o=!0)},p(e,[t]){2&t&&(r.hidden=e[1])},i:e,o:e,d(e){e&&k(n),t[2](null),o=!1,i()}}}function Zr(e,t,n){let r,o,i,a,s;function c(e,{offset:t,duration:n}){const i=n-t,a=e.style;return{duration:1e3*i,tick:i=>{const s=t*r,c=s+i*(n*r-s);a.top=c+"px",o&&e.scrollIntoView({block:"center"})}}}u(e,Ze,e=>n(5,r=e)),u(e,Ve,e=>n(6,o=e)),u(e,ze,e=>n(7,i=e));let l=!0;zn.subscribe(e=>{s&&s.end(),n(1,l="on"!==e.type),!l&&a&&(Ve.set(i),s=$e(a,c,e),s.start())});return[a,l,function(e){K[e?"unshift":"push"](()=>{a=e,n(0,a)})},()=>{n(1,l=!0)}]}class Xr extends Se{constructor(e){super(),Ie(this,e,Zr,Gr,s,{})}}function Yr(e){const t=[...e.flatMap(e=>Object.values(e.notes).flat()).map(e=>e.pitch),...e.flatMap(e=>Object.values(e.activeNotesAtEnd).flatMap(e=>Object.values(e)).map(e=>e.pitch))];if(t.length){const e=Math.min(...t),n=Math.max(...t),r=n-e,o=20,i=(Math.max(r,o)-r)/2;return{minPitch:e-i,maxPitch:n+i}}return{minPitch:-1,maxPitch:-1}}function Jr(e,t,n){const r=e.slice();return r[9]=t[n],r}function Qr(e){let t;return{c(){t=C("p"),t.textContent="Right click the root to begin",q(t,"class","placeholder svelte-j0oe5d")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Kr(e){let t,n;return t=new Wr({props:{viewport:e[3],section:e[9],pitchMin:e[2].minPitch,pitchMax:e[2].maxPitch}}),{c(){ke(t.$$.fragment)},m(e,r){Te(t,e,r),n=!0},p(e,n){const r={};8&n&&(r.viewport=e[3]),2&n&&(r.section=e[9]),4&n&&(r.pitchMin=e[2].minPitch),4&n&&(r.pitchMax=e[2].maxPitch),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ye(t.$$.fragment,e),n=!1},d(e){Ce(t,e)}}}function eo(e){let t,n,r=void 0!==e[3]&&Kr(e);return{c(){r&&r.c(),t=A()},m(e,o){r&&r.m(e,o),x(e,t,o),n=!0},p(e,n){void 0!==e[3]?r?(r.p(e,n),8&n&&ge(r,1)):(r=Kr(e),r.c(),ge(r,1),r.m(t.parentNode,t)):r&&(pe(),ye(r,1,1,()=>{r=null}),me())},i(e){n||(ge(r),n=!0)},o(e){ye(r),n=!1},d(e){r&&r.d(e),e&&k(t)}}}function to(e){let t,n,r,o,i,a,s;n=new Xr({});let c=e[1],l=[];for(let t=0;t<c.length;t+=1)l[t]=eo(Jr(e,c,t));const u=e=>ye(l[e],1,1,()=>{l[e]=null});let d=null;return c.length||(d=Qr()),{c(){t=C("div"),ke(n.$$.fragment),r=S();for(let e=0;e<l.length;e+=1)l[e].c();d&&d.c(),q(t,"class","container svelte-j0oe5d"),q(t,"style",o=Sr({backgroundColor:Kn.bgDark}))},m(o,c){x(o,t,c),Te(n,t,null),w(t,r);for(let e=0;e<l.length;e+=1)l[e].m(t,null);d&&d.m(t,null),e[4](t),i=!0,a||(s=M(t,"wheel",e[5],{passive:!0}),a=!0)},p(e,[n]){if(14&n){let r;for(c=e[1],r=0;r<c.length;r+=1){const o=Jr(e,c,r);l[r]?(l[r].p(o,n),ge(l[r],1)):(l[r]=eo(o),l[r].c(),ge(l[r],1),l[r].m(t,null))}for(pe(),r=c.length;r<l.length;r+=1)u(r);me(),c.length?d&&(d.d(1),d=null):d||(d=Qr(),d.c(),d.m(t,null))}},i(e){if(!i){ge(n.$$.fragment,e);for(let e=0;e<c.length;e+=1)ge(l[e]);i=!0}},o(e){ye(n.$$.fragment,e),l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)ye(l[e]);i=!1},d(r){r&&k(t),Ce(n),T(l,r),d&&d.d(),e[4](null),a=!1,s()}}}function no(t,n,r){let o,i,a,s,l,d,f=e,h=()=>(f(),f=c(a,e=>r(6,o=e)),a);u(t,Ze,e=>r(7,i=e)),t.$$.on_destroy.push(()=>f()),h();return t.$$.update=()=>{64&t.$$.dirty&&r(1,s=o),2&t.$$.dirty&&r(2,l=Yr(s)),2&t.$$.dirty&&function(e){if(e&&e.length){const t=e[e.length-1].startsAt;setTimeout(()=>{d&&r(3,d.scrollTop=t*i,d)},0)}}(s)},h(r(0,a=Un.selectedSectionsStore)),[a,s,l,d,function(e){K[e?"unshift":"push"](()=>{d=e,r(3,d)})},()=>Ve.set(!1)]}class ro extends Se{constructor(e){super(),Ie(this,e,no,to,s,{})}}function oo(e){let t,n,r,o,a,s,c,l,u;return{c(){t=C("div"),n=C("input"),r=S(),o=C("label"),a=I(e[0]),q(n,"id",e[2]),q(n,"type","checkbox"),q(n,"class","svelte-lsths8"),q(o,"for",e[2]),q(o,"style",s=Sr({color:Kn[e[0]]})),q(o,"class","svelte-lsths8"),q(t,"class","row svelte-lsths8"),q(t,"style",c=Sr({border:"1px solid",borderColor:Kn.border}))},m(i,s){x(i,t,s),w(t,n),n.checked=e[3],w(t,r),w(t,o),w(o,a),l||(u=[M(n,"change",e[6]),M(t,"click",e[4])],l=!0)},p(e,t){4&t&&q(n,"id",e[2]),8&t&&(n.checked=e[3]),1&t&&P(a,e[0]),4&t&&q(o,"for",e[2]),1&t&&s!==(s=Sr({color:Kn[e[0]]}))&&q(o,"style",s)},d(e){e&&k(t),l=!1,i(u)}}}function io(t){let n,r=t[1]&&oo(t);return{c(){r&&r.c(),n=A()},m(e,t){r&&r.m(e,t),x(e,n,t)},p(e,[t]){e[1]?r?r.p(e,t):(r=oo(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:e,o:e,d(e){r&&r.d(e),e&&k(n)}}}function ao(t,n,r){let o,i=e,a=()=>(i(),i=c(s,e=>r(3,o=e)),s);t.$$.on_destroy.push(()=>i());let s,l,{instrument:u}=n,{storeMap:d}=n;return a(),t.$set=e=>{"instrument"in e&&r(0,u=e.instrument),"storeMap"in e&&r(5,d=e.storeMap)},t.$$.update=()=>{33&t.$$.dirty&&a(r(1,s=d[u])),1&t.$$.dirty&&r(2,l="instrument-"+u)},[u,s,l,o,function(){s&&s.update(e=>!e)},d,function(){o=this.checked,s.set(o)}]}class so extends Se{constructor(e){super(),Ie(this,e,ao,io,s,{instrument:0,storeMap:5})}}function co(e){let t,n,r,o,i;const a=e[5].default,s=d(a,e,e[4],null);return{c(){t=C("div"),s&&s.c(),q(t,"class","button enabled svelte-namasn"),q(t,"style",n=Sr(e[1]))},m(n,a){x(n,t,a),s&&s.m(t,null),r=!0,o||(i=M(t,"click",e[6]),o=!0)},p(e,o){s&&s.p&&16&o&&h(s,a,e,e[4],o,null,null),(!r||2&o&&n!==(n=Sr(e[1])))&&q(t,"style",n)},i(e){r||(ge(s,e),r=!0)},o(e){ye(s,e),r=!1},d(e){e&&k(t),s&&s.d(e),o=!1,i()}}}function lo(e){let t,n,r;const o=e[5].default,i=d(o,e,e[4],null);return{c(){t=C("div"),i&&i.c(),q(t,"class","button disabled svelte-namasn"),q(t,"style",n=Sr(e[1]))},m(e,n){x(e,t,n),i&&i.m(t,null),r=!0},p(e,a){i&&i.p&&16&a&&h(i,o,e,e[4],a,null,null),(!r||2&a&&n!==(n=Sr(e[1])))&&q(t,"style",n)},i(e){r||(ge(i,e),r=!0)},o(e){ye(i,e),r=!1},d(e){e&&k(t),i&&i.d(e)}}}function uo(e){let t,n,r,o;const i=[lo,co],a=[];function s(e,t){return e[0]?0:1}return t=s(e),n=a[t]=i[t](e),{c(){n.c(),r=A()},m(e,n){a[t].m(e,n),x(e,r,n),o=!0},p(e,[o]){let c=t;t=s(e),t===c?a[t].p(e,o):(pe(),ye(a[c],1,1,()=>{a[c]=null}),me(),n=a[t],n||(n=a[t]=i[t](e),n.c()),ge(n,1),n.m(r.parentNode,r))},i(e){o||(ge(n),o=!0)},o(e){ye(n),o=!1},d(e){a[t].d(e),e&&k(r)}}}function fo(e,t,n){let r,o,i,{disabled:a}=t,{emphasise:s}=t,{style:c}=t,{$$slots:l={},$$scope:u}=t;return e.$set=e=>{"disabled"in e&&n(0,a=e.disabled),"emphasise"in e&&n(2,s=e.emphasise),"style"in e&&n(3,c=e.style),"$$scope"in e&&n(4,u=e.$$scope)},e.$$.update=()=>{5&e.$$.dirty&&n(7,r=a?Kn.buttonBg:s?Kn.textEmphasis:Kn.textDark),5&e.$$.dirty&&n(8,o=a?Kn.buttonBgDisabled:s?Kn.text:Kn.buttonBg),392&e.$$.dirty&&n(1,i={color:r,backgroundColor:o,...c||{}})},[a,i,s,c,u,l,function(t){J(e,t)}]}class ho extends Se{constructor(e){super(),Ie(this,e,fo,uo,s,{disabled:0,emphasise:2,style:3})}}function po(e){let t;return{c(){t=I(e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&P(t,e[0])},d(e){e&&k(t)}}}function mo(e){let t,n;return t=new ho({props:{emphasise:e[1],$$slots:{default:[po]},$$scope:{ctx:e}}}),t.$on("click",e[2]),{c(){ke(t.$$.fragment)},m(e,r){Te(t,e,r),n=!0},p(e,[n]){const r={};65&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ye(t.$$.fragment,e),n=!1},d(e){Ce(t,e)}}}function go(e,t,n){let r;u(e,Fe,e=>n(4,r=e));let{text:o}=t,{genre:i}=t;const a=r[1]===i,{close:s}=Y("simple-modal");return e.$set=e=>{"text"in e&&n(0,o=e.text),"genre"in e&&n(3,i=e.genre)},[o,a,function(){Fe.set([o,i]),s()},i]}class yo extends Se{constructor(e){super(),Ie(this,e,go,mo,s,{text:0,genre:3})}}const vo=e=>({}),$o=e=>({});function bo(e){let t,n,r,o,i,a;const s=e[2].trigger,c=d(s,e,e[1],$o),l=e[2].default,u=d(l,e,e[1],null);return{c(){t=C("div"),n=C("div"),c&&c.c(),r=S(),o=C("div"),u&&u.c(),q(o,"class","TT_text svelte-i92pm9"),q(o,"style",i=Sr(e[0])),q(n,"class","TT_trigger svelte-i92pm9")},m(e,i){x(e,t,i),w(t,n),c&&c.m(n,null),w(n,r),w(n,o),u&&u.m(o,null),a=!0},p(e,[t]){c&&c.p&&2&t&&h(c,s,e,e[1],t,vo,$o),u&&u.p&&2&t&&h(u,l,e,e[1],t,null,null)},i(e){a||(ge(c,e),ge(u,e),a=!0)},o(e){ye(c,e),ye(u,e),a=!1},d(e){e&&k(t),c&&c.d(e),u&&u.d(e)}}}function wo(e,t,n){const r={border:"1px solid",borderColor:Kn.border,backgroundColor:Kn.bgLight,color:Kn.textDark};let{$$slots:o={},$$scope:i}=t;return e.$set=e=>{"$$scope"in e&&n(1,i=e.$$scope)},[r,i,o]}class xo extends Se{constructor(e){super(),Ie(this,e,wo,bo,s,{})}}function ko(e,t,n){const r=e.slice();return r[4]=t[n],r}function To(e,t,n){const r=e.slice();return r[7]=t[n][0],r[4]=t[n][1],r}function Co(e,t,n){const r=e.slice();return r[7]=t[n][0],r[4]=t[n][1],r}function Eo(t){let n,r,o;return{c(){n=C("h2"),r=I("Simple"),q(n,"slot","trigger"),q(n,"style",o=Sr({color:Kn.text})),q(n,"class","svelte-67pkxg")},m(e,t){x(e,n,t),w(n,r)},p:e,d(e){e&&k(n)}}}function Io(t){let n,r;return{c(){n=S(),r=C("span"),r.innerHTML="\n      These genres are the most reliable\n      <br>\n      They are available in the official MuseNet tool\n    "},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function So(t){let n,r;return n=new yo({props:{text:t[7],genre:t[4]}}),{c(){ke(n.$$.fragment)},m(e,t){Te(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ye(n.$$.fragment,e),r=!1},d(e){Ce(n,e)}}}function Ao(t){let n,r,o;return{c(){n=C("h2"),r=I("Advanced"),q(n,"slot","trigger"),q(n,"style",o=Sr({color:Kn.text})),q(n,"class","svelte-67pkxg")},m(e,t){x(e,n,t),w(n,r)},p:e,d(e){e&&k(n)}}}function Mo(t){let n,r;return{c(){n=S(),r=C("span"),r.innerHTML="\n      These genres are reliable\n      <br>\n      They are available in the official MuseNet tool\n      <br>\n      after clicking &#39;show advanced settings&#39;\n    "},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function No(t){let n,r;return n=new yo({props:{text:t[7],genre:t[4]}}),{c(){ke(n.$$.fragment)},m(e,t){Te(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ye(n.$$.fragment,e),r=!1},d(e){Ce(n,e)}}}function Oo(t){let n,r,o;return{c(){n=C("h2"),r=I("Experimental"),q(n,"slot","trigger"),q(n,"style",o=Sr({color:Kn.text})),q(n,"class","svelte-67pkxg")},m(e,t){x(e,n,t),w(n,r)},p:e,d(e){e&&k(n)}}}function qo(t){let n,r;return{c(){n=S(),r=C("span"),r.innerHTML="\n      These genres are not reliable\n      <br>\n      They are not supported by MuseNet, but usually work\n      <br>\n      Don&#39;t be surprised if they sound very strange!\n    "},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Uo(t){let n,r;return n=new yo({props:{text:t[4],genre:t[4]}}),{c(){ke(n.$$.fragment)},m(e,t){Te(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ye(n.$$.fragment,e),r=!1},d(e){Ce(n,e)}}}function Po(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p,m,g,y;a=new xo({props:{$$slots:{default:[Io],trigger:[Eo]},$$scope:{ctx:e}}});let v=e[0],$=[];for(let t=0;t<v.length;t+=1)$[t]=So(Co(e,v,t));const b=e=>ye($[e],1,1,()=>{$[e]=null});u=new xo({props:{$$slots:{default:[Mo],trigger:[Ao]},$$scope:{ctx:e}}});let E=e[1],A=[];for(let t=0;t<E.length;t+=1)A[t]=No(To(e,E,t));const M=e=>ye(A[e],1,1,()=>{A[e]=null});p=new xo({props:{$$slots:{default:[qo],trigger:[Oo]},$$scope:{ctx:e}}});let N=e[2],O=[];for(let t=0;t<N.length;t+=1)O[t]=Uo(ko(e,N,t));const U=e=>ye(O[e],1,1,()=>{O[e]=null});return{c(){t=C("div"),n=C("h1"),r=I("Genres"),i=S(),ke(a.$$.fragment),s=S(),c=C("div");for(let e=0;e<$.length;e+=1)$[e].c();l=S(),ke(u.$$.fragment),d=S(),f=C("div");for(let e=0;e<A.length;e+=1)A[e].c();h=S(),ke(p.$$.fragment),m=S(),g=C("div");for(let e=0;e<O.length;e+=1)O[e].c();q(n,"style",o=Sr({color:Kn.text})),q(n,"class","svelte-67pkxg"),q(c,"class","genreContainer svelte-67pkxg"),q(f,"class","genreContainer svelte-67pkxg"),q(g,"class","genreContainer svelte-67pkxg")},m(e,o){x(e,t,o),w(t,n),w(n,r),w(t,i),Te(a,t,null),w(t,s),w(t,c);for(let e=0;e<$.length;e+=1)$[e].m(c,null);w(t,l),Te(u,t,null),w(t,d),w(t,f);for(let e=0;e<A.length;e+=1)A[e].m(f,null);w(t,h),Te(p,t,null),w(t,m),w(t,g);for(let e=0;e<O.length;e+=1)O[e].m(g,null);y=!0},p(e,[t]){const n={};if(4096&t&&(n.$$scope={dirty:t,ctx:e}),a.$set(n),1&t){let n;for(v=e[0],n=0;n<v.length;n+=1){const r=Co(e,v,n);$[n]?($[n].p(r,t),ge($[n],1)):($[n]=So(r),$[n].c(),ge($[n],1),$[n].m(c,null))}for(pe(),n=v.length;n<$.length;n+=1)b(n);me()}const r={};if(4096&t&&(r.$$scope={dirty:t,ctx:e}),u.$set(r),2&t){let n;for(E=e[1],n=0;n<E.length;n+=1){const r=To(e,E,n);A[n]?(A[n].p(r,t),ge(A[n],1)):(A[n]=No(r),A[n].c(),ge(A[n],1),A[n].m(f,null))}for(pe(),n=E.length;n<A.length;n+=1)M(n);me()}const o={};if(4096&t&&(o.$$scope={dirty:t,ctx:e}),p.$set(o),4&t){let n;for(N=e[2],n=0;n<N.length;n+=1){const r=ko(e,N,n);O[n]?(O[n].p(r,t),ge(O[n],1)):(O[n]=Uo(r),O[n].c(),ge(O[n],1),O[n].m(g,null))}for(pe(),n=N.length;n<O.length;n+=1)U(n);me()}},i(e){if(!y){ge(a.$$.fragment,e);for(let e=0;e<v.length;e+=1)ge($[e]);ge(u.$$.fragment,e);for(let e=0;e<E.length;e+=1)ge(A[e]);ge(p.$$.fragment,e);for(let e=0;e<N.length;e+=1)ge(O[e]);y=!0}},o(e){ye(a.$$.fragment,e),$=$.filter(Boolean);for(let e=0;e<$.length;e+=1)ye($[e]);ye(u.$$.fragment,e),A=A.filter(Boolean);for(let e=0;e<A.length;e+=1)ye(A[e]);ye(p.$$.fragment,e),O=O.filter(Boolean);for(let e=0;e<O.length;e+=1)ye(O[e]);y=!1},d(e){e&&k(t),Ce(a),T($,e),Ce(u),T(A,e),Ce(p),T(O,e)}}}function Do(e){const t=[["Chopin","chopin"],["Mozart","mozart"],["Rachmaninoff","rachmaninoff"],["Lady Gaga","ladygaga"],["Country","country"],["Disney","disney"]],n=[["Jazz","jazz"],["Bach","bach"],["Beethoven","beethoven"],["Journey","journey"],["The Beatles","thebeatles"],["Video Games","video"],["Broadway","broadway"],["Frank Sinatra","franksinatra"],["Bluegrass","bluegrass"],["Tchaikovsky","tchaikovsky"]],r=[...t.map(e=>e[1]),...n.map(e=>e[1])];return[t,n,Ue.filter(e=>!r.includes(e))]}class Bo extends Se{constructor(e){super(),Ie(this,e,Do,Po,s,{})}}function jo(e){let t;return{c(){t=C("label"),t.textContent="Max Length",q(t,"for","responselength"),q(t,"slot","trigger"),q(t,"class","svelte-voibqb")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Lo(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="If the response would have more tokens than this, we reduce the number\n        of tokens that we send to MuseNet. Higher values produce songs with more\n        long-term structure but increase the failure rates of MuseNet. Values\n        below 3000 are known to work."},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Fo(e){let t;return{c(){t=C("label"),t.textContent="Temperature:",q(t,"for","temperature"),q(t,"slot","trigger"),q(t,"class","svelte-voibqb")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ro(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="How adventurous the AI is allowed to be. Try increasing temperature if\n        you are stuck in a repeating pattern or if MuseNet starts generating a\n        real song."},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function _o(e){let t;return{c(){t=C("label"),t.textContent="Auto Request",q(t,"for","autoRequest"),q(t,"slot","trigger"),q(t,"class","svelte-voibqb")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ho(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Immediately request more as soon as you select a node for the first time"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function zo(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,T,E,A,N,O,U,j,L,F;return c=new xo({props:{$$slots:{default:[Lo],trigger:[jo]},$$scope:{ctx:e}}}),g=new xo({props:{$$slots:{default:[Ro],trigger:[Fo]},$$scope:{ctx:e}}}),N=new xo({props:{$$slots:{default:[Ho],trigger:[_o]},$$scope:{ctx:e}}}),{c(){t=C("div"),n=C("h1"),r=I("Advanced Generation Options"),a=S(),s=C("div"),ke(c.$$.fragment),l=S(),u=C("input"),d=S(),f=C("span"),h=I(e[0]),p=S(),m=C("div"),ke(g.$$.fragment),y=S(),v=C("input"),$=S(),b=C("span"),T=I(e[1]),E=S(),A=C("div"),ke(N.$$.fragment),O=S(),U=C("input"),q(n,"style",o=Sr({color:Kn.text})),q(n,"class","svelte-voibqb"),q(u,"class","slider svelte-voibqb"),q(u,"id","responselength"),q(u,"type","range"),q(u,"min","500"),q(u,"max","5000"),q(u,"step","100"),q(s,"class","optionElement svelte-voibqb"),q(v,"class","slider svelte-voibqb"),q(v,"id","temperature"),q(v,"type","range"),q(v,"min","0.8"),q(v,"max","1.2"),q(v,"step","0.01"),q(m,"class","optionElement svelte-voibqb"),q(U,"id","autoRequest"),q(U,"type","checkbox"),q(U,"class","svelte-voibqb"),q(A,"class","optionElement svelte-voibqb"),B(t,"height","200px")},m(o,i){x(o,t,i),w(t,n),w(n,r),w(t,a),w(t,s),Te(c,s,null),w(s,l),w(s,u),D(u,e[0]),w(s,d),w(s,f),w(f,h),w(t,p),w(t,m),Te(g,m,null),w(m,y),w(m,v),D(v,e[1]),w(m,$),w(m,b),w(b,T),w(t,E),w(t,A),Te(N,A,null),w(A,O),w(A,U),U.checked=e[2],j=!0,L||(F=[M(u,"change",e[3]),M(u,"input",e[3]),M(v,"change",e[4]),M(v,"input",e[4]),M(U,"change",e[5])],L=!0)},p(e,[t]){const n={};64&t&&(n.$$scope={dirty:t,ctx:e}),c.$set(n),1&t&&D(u,e[0]),(!j||1&t)&&P(h,e[0]);const r={};64&t&&(r.$$scope={dirty:t,ctx:e}),g.$set(r),2&t&&D(v,e[1]),(!j||2&t)&&P(T,e[1]);const o={};64&t&&(o.$$scope={dirty:t,ctx:e}),N.$set(o),4&t&&(U.checked=e[2])},i(e){j||(ge(c.$$.fragment,e),ge(g.$$.fragment,e),ge(N.$$.fragment,e),j=!0)},o(e){ye(c.$$.fragment,e),ye(g.$$.fragment,e),ye(N.$$.fragment,e),j=!1},d(e){e&&k(t),Ce(c),Ce(g),Ce(N),L=!1,i(F)}}}function Vo(e,t,n){let r,o,i;return u(e,je,e=>n(0,r=e)),u(e,Re,e=>n(1,o=e)),u(e,He,e=>n(2,i=e)),[r,o,i,function(){r=U(this.value),je.set(r)},function(){o=U(this.value),Re.set(o)},function(){i=this.checked,He.set(i)}]}class Wo extends Se{constructor(e){super(),Ie(this,e,Vo,zo,s,{})}}function Go(e,t,n){const r=e.slice();return r[6]=t[n],r}function Zo(e){let t;return{c(){t=I("Advanced")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Xo(e){let t;return{c(){t=C("label"),t.textContent="Genre:",q(t,"for","genre"),q(t,"slot","trigger"),q(t,"class","svelte-1mva90g")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Yo(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="The style of music to generate",q(r,"class","svelte-1mva90g")},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Jo(e){let t;return{c(){t=I("⚙")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Qo(e){let t;return{c(){t=C("label"),t.textContent="Length:",q(t,"for","generationlength"),q(t,"slot","trigger"),q(t,"class","svelte-1mva90g")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ko(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="How many tokens to generate. One note is usually two tokens",q(r,"class","svelte-1mva90g")},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function ei(e){let t;return{c(){t=C("label"),t.textContent="Instruments:",q(t,"slot","trigger"),q(t,"class","svelte-1mva90g")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ti(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Selecting an instrument gives a strong suggestion to the AI. It might\n        just ignore you, but will try and respect the settings where possible.\n        Results are better if you select instruments that make sense for the\n        selected genre.",q(r,"class","svelte-1mva90g")},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function ni(t){let n,r;return n=new so({props:{storeMap:Pe,instrument:t[6]}}),{c(){ke(n.$$.fragment)},m(e,t){Te(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ye(n.$$.fragment,e),r=!1},d(e){Ce(n,e)}}}function ri(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,E,A,N,O,U,j,L,F,R,_,H,z,V,W,G=e[0][0]+"";c=new ho({props:{style:"font-size: 10pt",$$slots:{default:[Zo]},$$scope:{ctx:e}}}),c.$on("click",e[3]),d=new xo({props:{$$slots:{default:[Yo],trigger:[Xo]},$$scope:{ctx:e}}}),y=new ho({props:{style:{fontSize:24,padding:0,paddingRight:4,paddingLeft:4,margin:0,marginLeft:8},$$slots:{default:[Jo]},$$scope:{ctx:e}}}),y.$on("click",e[2]),b=new xo({props:{$$slots:{default:[Ko],trigger:[Qo]},$$scope:{ctx:e}}}),F=new xo({props:{$$slots:{default:[ti],trigger:[ei]},$$scope:{ctx:e}}});let Z=qe,X=[];for(let t=0;t<Z.length;t+=1)X[t]=ni(Go(e,Z,t));const Y=e=>ye(X[e],1,1,()=>{X[e]=null});return{c(){t=C("div"),n=C("div"),r=C("h1"),o=I("Generator"),s=S(),ke(c.$$.fragment),l=S(),u=C("div"),ke(d.$$.fragment),f=S(),h=C("span"),p=I(G),g=S(),ke(y.$$.fragment),v=S(),$=C("div"),ke(b.$$.fragment),E=S(),A=C("input"),N=S(),O=C("span"),U=I(e[1]),j=S(),L=C("div"),ke(F.$$.fragment),R=S(),_=C("div");for(let e=0;e<X.length;e+=1)X[e].c();q(r,"style",a=Sr({color:Kn.text})),q(r,"class","svelte-1mva90g"),q(n,"class","row svelte-1mva90g"),q(h,"id","genre"),q(h,"style",m=Sr({color:Kn.text})),q(h,"class","svelte-1mva90g"),q(u,"class","optionElement svelte-1mva90g"),q(A,"class","slider svelte-1mva90g"),q(A,"id","generationLength"),q(A,"type","range"),q(A,"min","20"),q(A,"max","1000"),q(A,"step","10"),q(O,"class","svelte-1mva90g"),q($,"class","optionElement svelte-1mva90g"),B(L,"align-self","flex-start"),B(_,"display","flex"),B(_,"flex-direction","row"),B(_,"flex-wrap","wrap"),q(t,"class","options svelte-1mva90g"),q(t,"style",H=Sr({color:Kn.textDark}))},m(i,a){x(i,t,a),w(t,n),w(n,r),w(r,o),w(n,s),Te(c,n,null),w(t,l),w(t,u),Te(d,u,null),w(u,f),w(u,h),w(h,p),w(u,g),Te(y,u,null),w(t,v),w(t,$),Te(b,$,null),w($,E),w($,A),D(A,e[1]),w($,N),w($,O),w(O,U),w(t,j),w(t,L),Te(F,L,null),w(t,R),w(t,_);for(let e=0;e<X.length;e+=1)X[e].m(_,null);z=!0,V||(W=[M(A,"change",e[4]),M(A,"input",e[4])],V=!0)},p(e,[t]){const n={};512&t&&(n.$$scope={dirty:t,ctx:e}),c.$set(n);const r={};512&t&&(r.$$scope={dirty:t,ctx:e}),d.$set(r),(!z||1&t)&&G!==(G=e[0][0]+"")&&P(p,G);const o={};512&t&&(o.$$scope={dirty:t,ctx:e}),y.$set(o);const i={};512&t&&(i.$$scope={dirty:t,ctx:e}),b.$set(i),2&t&&D(A,e[1]),(!z||2&t)&&P(U,e[1]);const a={};if(512&t&&(a.$$scope={dirty:t,ctx:e}),F.$set(a),0&t){let n;for(Z=qe,n=0;n<Z.length;n+=1){const r=Go(e,Z,n);X[n]?(X[n].p(r,t),ge(X[n],1)):(X[n]=ni(r),X[n].c(),ge(X[n],1),X[n].m(_,null))}for(pe(),n=Z.length;n<X.length;n+=1)Y(n);me()}},i(e){if(!z){ge(c.$$.fragment,e),ge(d.$$.fragment,e),ge(y.$$.fragment,e),ge(b.$$.fragment,e),ge(F.$$.fragment,e);for(let e=0;e<Z.length;e+=1)ge(X[e]);z=!0}},o(e){ye(c.$$.fragment,e),ye(d.$$.fragment,e),ye(y.$$.fragment,e),ye(b.$$.fragment,e),ye(F.$$.fragment,e),X=X.filter(Boolean);for(let e=0;e<X.length;e+=1)ye(X[e]);z=!1},d(e){e&&k(t),Ce(c),Ce(d),Ce(y),Ce(b),Ce(F),T(X,e),V=!1,i(W)}}}function oi(e,t,n){let r,o;u(e,Fe,e=>n(0,r=e)),u(e,Be,e=>n(1,o=e));const{open:i}=Y("simple-modal");return[r,o,function(){i(Bo,{},er)},function(){i(Wo,{},er)},function(){o=U(this.value),Be.set(o)}]}class ii extends Se{constructor(e){super(),Ie(this,e,oi,ri,s,{})}}const ai=[{version:[2,21,2],date:new Date(2020,11,21),commitHash:"54f2941133b73cfe971f0fea0281be9fa2fa96e2",changes:["Stop retrying failed requests to prevent infinite loop that DOS attacks MuseNet"]},{version:[2,21,1],date:new Date(2020,5,30),commitHash:"b41f977d5f81bc9ed8f2e5106a9575a1530b9d3c",changes:["Fixed postprocessing bugs","Add midi import setTempo support"]},{version:[2,21,0],date:new Date(2020,5,30),commitHash:"428bfe02120286f505472c2ef0e5b9b63ffb3281",changes:["Add export high-quality MuseTree wav"]},{version:[2,20,1],date:new Date(2020,5,30),commitHash:"23f2870c102322266555b9412176c0a867be4478",changes:["Fixed behaviour when clicking on tree view edge","Fixed space bar to play/pause"]},{version:[2,20,0],date:new Date(2020,5,30),commitHash:"c92c8e9ac167f5588ea61e0fbf87ee2a77b95d54",changes:["Rework postprocessing of encodings to add min length, max length, and min note separation"]},{version:[2,19,5],date:new Date(2020,5,28),commitHash:"2886957a38886ca02ef242d53898072400f53f59",changes:["Fix context menu placement in chrome","Fix track length in track info when 1 section long"]},{version:[2,19,4],date:new Date(2020,5,27),commitHash:"c7a5d61693847b3002e349649f2b5cb0a6aff26e",changes:["Big conversion of all svelte components to typescript, fixing small issues that were revealed in the"]},{version:[2,19,3],date:new Date(2020,5,25),commitHash:"9c9d56baa297867b056e16e6d9abde8a94895f1d",changes:["Replace tooltip code duplication with a styled component"]},{version:[2,19,2],date:new Date(2020,5,4),commitHash:"ef29e9ecce10577e8c9e0ac6651a0da15850dc41",changes:["Fix placeholder text in top left"]},{version:[2,19,1],date:new Date(2020,5,4),commitHash:"a8887f3972e8691aef9c30a6e8770cd8ae125751",changes:["Can click on red/green edges to start playing","Prevent clicking translucent nodes"]},{version:[2,19,0],date:new Date(2020,5,4),commitHash:"ca2a3a61a32e7e5d3ad6ad4857c2ede347058507",changes:["Allowed hiding the sidebar"]},{version:[2,18,3],date:new Date(2020,5,4),commitHash:"31889933cce14e6dba309077aab327c1cf1f5261",changes:["Show all 3 measures of instrument use","Remove 'section x' text from section canvas","Renamed track info to stats","Improved stats reliability","Allowed choosing stats for track or section"]},{version:[2,18,2],date:new Date(2020,5,4),commitHash:"b0ecb45f1557d4a81a2219112b0713d2db051a08",changes:["Changed instrument prevalence bars to stacked bar chart","Removed prevalence bars labels"]},{version:[2,18,1],date:new Date(2020,5,4),commitHash:"a65a699beac80b1f936e202d0f220e37c3d156b7",changes:["Fixed silence info when longest silence is at the end of the track","Fixed crash when deleting selected node","Added bars showing the prevalence of each instrument to track info"]},{version:[2,18,0],date:new Date(2020,5,3),commitHash:"5cd30b2551e2e0ae96a1655606351915825605ec",changes:["Added track info section"]},{version:[2,17,2],date:new Date(2020,5,3),commitHash:"664ff5e23ff91edfe02372211a8ac80b07df3867",changes:["Fixed critical bug with transitions"]},{version:[2,17,1],date:new Date(2020,5,3),commitHash:"497bc1efd60271453a2c883594a8fe514b56c185",changes:["Changed 'Generation Length' to just 'length'","Made tree vis edge's green progress indicator straight when no x-offset between parent and child","Made green progress smoother on transition between sections"]},{version:[2,17,0],date:new Date(2020,5,3),commitHash:"9e790f098e2c4a66b9f17af9cd15766fad61da9d",changes:["Made instrument selection easier to use and more compact","Made edges between nodes much thicker","Showed play progress on edge above node rather than below","Nodes on selected path become translucent when track is playing","Edges on selected path show on top of non-selected edges","Moved display options into the sidebar","Added advanced options modal for generation and display options","Added ability to hide instruments in track view"]},{version:[2,16,6],date:new Date(2020,5,3),commitHash:"0cd5de7587e08f3e2a5f1ebf4e3b8573c82d61ee",changes:["Fix loading bar errors after cancelling load","Scroll to selected section in track view","Improve lazy loading reliability"]},{version:[2,16,5],date:new Date(2020,5,3),commitHash:"55d44f1e18ff281fe7d6a2a14133951022f80c7d",changes:["Fix midi import"]},{version:[2,16,4],date:new Date(2020,5,3),commitHash:"67df9b020be286bcd184fb7535acb7de1aab81a3",changes:["Added validation to import modal"]},{version:[2,16,3],date:new Date(2020,5,3),commitHash:"6f23613e8f9764cebf678b112c053dcf07f71f4e",changes:["Cancelling load actually cancels it instead of just hiding it"]},{version:[2,16,2],date:new Date(2020,5,2),commitHash:"5bf2fa2e513d46d450f22f508335ae709c42a69e",changes:["Animate edge colour change with color wipe to show progress"]},{version:[2,16,1],date:new Date(2020,5,2),commitHash:"bec44310d5198ebbc8453dd16119f12285bc8273",changes:["Improve green node logic","Edges also highlight green when playign"]},{version:[2,16,0],date:new Date(2020,5,2),commitHash:"e6834a41cd6ce8c64fbc9f716a43a400bbec1937",changes:["Nodes in tree vis highlight green when playing"]},{version:[2,15,4],date:new Date(2020,5,2),commitHash:"b58309bfff89b980a0e4a2f0dbfa12342dd4c014",changes:["Changed from ending all notes at end of section to truncating notes after a specified max length"]},{version:[2,15,3],date:new Date(2020,5,2),commitHash:"3b6c833e785f4ade85a0f5b4927c449b16cc1a6c",changes:["Increase max length to 5000"]},{version:[2,15,2],date:new Date(2020,5,1),commitHash:"82af479c07f0ea431f72b9c391c2654a50ca6117",changes:["Lazy-load the section SVGs","Improve async loading performance of tall narrow trees","Improve SVG render performance"]},{version:[2,15,1],date:new Date(2020,5,1),commitHash:"1759ff6afaab49577f2f626361888f8b09f20b0a",changes:["Dynamic X-Range on Track View"]},{version:[2,15,0],date:new Date(2020,5,1),commitHash:"d10f2c0c84273c4f941598ea4a3db8267be9a376",changes:["Swap to using SVG for track view"]},{version:[2,14,2],date:new Date(2020,4,29),commitHash:"d8d46682664a1fe5f6285b2a20944f9a00aaccc1",changes:["Improve tree performance","Drastically improved node selection performance","Fixed type issues","Made loading bar start centered and grow outwards"]},{version:[2,14,1],date:new Date(2020,4,29),commitHash:"38a9dfda2416a400a974cd4735b4b64e25ce701b",changes:["Removed logging that was accidentally left in","Improved autorequest performance slightly","Removed all bad uses of get_store_value because it's slow"]},{version:[2,14,0],date:new Date(2020,4,28),commitHash:"5f43060b6743f2c3cec0bab172b869f028e6c76c",changes:["Added first-time help"]},{version:[2,13,2],date:new Date(2020,4,28),commitHash:"db889e7098ea0ee298a65d23960b83ed7936df4c",changes:["Removed accidental logging of undo buffer","Fixed bug where you could not load the same file twice in a row"]},{version:[2,13,1],date:new Date(2020,4,28),commitHash:"ac7857241e1dd7eb11fffbd261cbcf1f46dea9cd",changes:["Clear the undo buffer when deleting from root","Add confirmation modal to deleting from root"]},{version:[2,13,0],date:new Date(2020,4,28),commitHash:"02b45deda57ae4868728615e6f99b6bf36cffffe",changes:["Add autosave functionality"]},{version:[2,12,1],date:new Date(2020,4,28),commitHash:"497968dabbf38d183c53a86c5f37cde70b41c919",changes:["Improved piano loading speed"]},{version:[2,12,0],date:new Date(2020,4,28),commitHash:"8e07d30c40e0f580d1529e704559e4e7e6f7d0d7",changes:["Added undo button","Added undo keyboard shortcut"]},{version:[2,11,2],date:new Date(2020,4,27),commitHash:"8c0291d2b7a92bd4e5c70e22543a29e5502cab4c",changes:["Fix error when loading but closing modal"]},{version:[2,11,1],date:new Date(2020,4,27),commitHash:"9fb73015044a2348a86e96a350390865eb06b998",changes:["Cancelling load is now *much* faster","Can now cancel Midi loading","Fixed orange colour sometimes appearing twice","Fixed node colours note updating after loading mst file"]},{version:[2,11,0],date:new Date(2020,4,27),commitHash:"6f5bb9bfa717b48961f718117d973d354b4f14bb",changes:["Loading spinner shows approx progress","Loading can be cancelled"]},{version:[2,10,2],date:new Date(2020,4,27),commitHash:"4b707931d33bd19ce0b75b4426ee2ed754b6e60d",changes:["Made space bar start/stop audio playback, the same as clicking the play button at the bottom"]},{version:[2,10,1],date:new Date(2020,4,27),commitHash:"7817d4281d38502482e3a83f8d6ce416c0c3e318",changes:["Added keyboard shortcuts to context menu","Added keyboard shortcuts when hovering a node","Remove fade from pending load in tree view","Remove right-click to deselect from section canvas","Buttons in about modal are spread rather than left-aligned","Made nodes in tree vis grow when hovered","Transitioned stroke colour in lines between nodes","Fixed orange node colour so it works in all cases"]},{version:[2,10,0],date:new Date(2020,4,26),commitHash:"fa911066380c45032e45e9d59fc41d528cab79de",changes:["Added right-click menu to the tree visualisation","Removed controls in track view","Updated import & export modals to work based on which node you right-clicked","Removed ctrl+left click shortcut to load more in tree view"]},{version:[2,9,0],date:new Date(2020,4,25),commitHash:"9efd1d6b3491b965df075ea71bf8c53a9ea806fe",changes:["Added labels to the import modal","Coloured text inputs to be light background colour instead of dark","Add export modal","Prevent error if you don't select anything in file input","Added encoding export option"]},{version:[2,8,0],date:new Date(2020,4,25),commitHash:"46ab3ceb9464a42efdc5ae108c5a612ffed92e0a",changes:["Made track controls full-width","Moved load + save buttons to track controls","Moved import + export buttons to section controls"]},{version:[2,7,1],date:new Date(2020,4,25),commitHash:"0dcb5d7dc4dffd57a973155acd78bd8e2e2c2890",changes:["Fix favicon on live site using relative path"]},{version:[2,7,0],date:new Date(2020,4,25),commitHash:"8f2e17a397d20a444b698746a2c6daf26227d146",changes:["Added 'About' modal to replace links.svelte","Fixed height of buttons in track controls"]},{version:[2,6,4],date:new Date(2020,4,25),commitHash:"18be619c88ad49064b7b196409a447a8a321ccfe",changes:["Allow dragging the midi into the encoding box in import modal","Improve scroll bar in import modal textarea","Prevent import modal textarea resizing","Prevent loading spinner having a scroll bar"]},{version:[2,6,3],date:new Date(2020,4,25),commitHash:"e1721671c2aa4ef072af60c99d1c1f99d21ad805",changes:["Fix the track controls having white bar at bottom in chrome","Changelog links now open in a new tab"]},{version:[2,6,2],date:new Date(2020,4,25),commitHash:"28c79f3bb3c8f0124c0cd5128fdfcdd59b9e9cba",changes:["Hide scrollbar in options when possible"]},{version:[2,6,1],date:new Date(2020,4,24),commitHash:"5118bda71d2830d9970eec205671605747b2cd78",changes:["Improve play/stop button","Change favicon","Improve import modal examples selection"]},{version:[2,6,0],date:new Date(2020,4,24),commitHash:"54437db7ef38530c0d842760259d5c13c653c164",changes:["Added examples to the import modal","Changed header colour in modals","Allow the options column to scroll on low-res screens"]},{version:[2,5,1],date:new Date(2020,4,24),commitHash:"ecf0e5aea21dd04af80e84690d4c17c189a10203",changes:["Adjusted column widths in save options","The button that opens this modal now displays the current version","Improve tree vis line shape"]},{version:[2,5,0],date:new Date(2020,4,24),commitHash:"ee86226aa80db94681b4fd4bb0c0a5111aea0cb1",changes:["Github issue #6, allow changing size of each view"]},{version:[2,4,1],date:new Date(2020,4,24),commitHash:"33835b36cc2c7ba94dd49242ebfcb60f13dd784b",changes:["Updated readme for real this time","Coloured the instruments in the options panel","Added tooltips to the options panel","Converted all links to buttons in 'About'","Changed colour & center aligned headers in options panel","Fixed pending load display on branch nodes"]},{version:[2,4,0],date:new Date(2020,4,24),commitHash:"321ecf89124925cc7beefb542925ea37bc155f58",changes:["Add temperature to generation options","Prevented the 'Load more' and 'Log' buttons going on separate lines","Fixed the gaps between sections in the track view","Added border between sections and scroll bar in track view","Prevented timeline from scrolling you off the page on low-resolution screens","Improve alignment of persistence options buttons","Remove margin around headers in options","Update readme"]},{version:[2,3,0],date:new Date(2020,4,23),commitHash:"4c299141bda04c07760cdfcb96eda27e9d9ab66c",changes:["Add support for custom MIDI tempos"]},{version:[2,2,1],date:new Date(2020,4,23),commitHash:"6370688f82de45d5de4b5238a36e617acfa09fc0",changes:["Improved visual look of lines connecting nodes in tree view"]},{version:[2,2,0],date:new Date(2020,4,23),commitHash:"13628ec1f3d72b6cc51012b6c284ca3e4057673e",changes:["Fixed 'pending load' text colour in tree visualisation","Fixed issue #39, Added lines between nodes in tree visualisation"]},{version:[2,1,7],date:new Date(2020,4,21),commitHash:"fb1bd9b720f31b3bdcded4faf25e8797c3e9f630",changes:["Fixed issue #2, improved colour scheme","Fixed import modal buttons, disabling them when encoding box is empty"]},{version:[2,1,6],date:new Date(2020,4,21),commitHash:"eaad8693e3c4f18cff8e11bbbfe21d459954ffc3",changes:["Added this changelog modal"]},{version:[2,1,5],date:new Date(2020,4,21),commitHash:"630c8c2a119353abb893e6efcaf489a9957a18f3",changes:["Fixed issue #40, rightmost column should be dark theme","All modals made dark theme"]},{version:[2,1,4],date:new Date(2020,4,21),commitHash:"bc5e79d479d4ae8e6fd723f3bab911277b0902a9",changes:["Fixed issue #41, drums missing/incorrect in MIDI export"]},{version:[2,1,3],date:new Date(2020,4,20),commitHash:"411924dde1796c0ab6975121cac10517990c5c60",changes:["Fixed issue #44, notes lasting forever"]},{version:[2,1,2],date:new Date(2020,4,20),commitHash:"de8f1cec607da56cb2c81c28eebf7aaa9af453c7",changes:["Fixed issue #42, tempo incorrect on imported midi"]},{version:[2,1,1],date:new Date(2020,4,18),commitHash:"312560c1f72448cda816d2cadaa132b2a0884bc5",changes:["Disabled 'under selected' option in import modal if nothing is selected"]},{version:[2,1,0],date:new Date(2020,4,18),commitHash:"93ef56a3c56924f674a8fbdde6dcac2ff17db9c9",changes:["Added midi import functionality"]},{version:[2,0,0],date:new Date(2020,4,17),commitHash:"739d69b3a54a05e1f5e5bd46c84f3e3dc062eef3",changes:["Version 2 released"]}];function si(e,t,n){const r=e.slice();return r[3]=t[n],r}function ci(e,t,n){const r=e.slice();return r[0]=t[n],r}function li(t){let n,r,o=t[3]+"";return{c(){n=C("li"),r=I(o)},m(e,t){x(e,n,t),w(n,r)},p:e,d(e){e&&k(n)}}}function ui(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p,m=e[0].version[0]+"",g=e[0].version[1]+"",y=e[0].version[2]+"",v=e[0].date.toLocaleDateString()+"",$=e[0].changes,b=[];for(let t=0;t<$.length;t+=1)b[t]=li(si(e,$,t));return{c(){t=C("a"),n=C("h2"),r=I("v"),o=I(m),i=I("."),a=I(g),s=I("."),c=I(y),l=I(" - "),u=I(v),f=S(),h=C("ul");for(let e=0;e<b.length;e+=1)b[e].c();p=S(),q(t,"href",d="https://github.com/stevenwaterman/musetree/tree/"+e[0].commitHash),q(t,"target","_blank")},m(e,d){x(e,t,d),w(t,n),w(n,r),w(n,o),w(n,i),w(n,a),w(n,s),w(n,c),w(n,l),w(n,u),x(e,f,d),x(e,h,d);for(let e=0;e<b.length;e+=1)b[e].m(h,null);w(h,p)},p(e,t){if(0&t){let n;for($=e[0].changes,n=0;n<$.length;n+=1){const r=si(e,$,n);b[n]?b[n].p(r,t):(b[n]=li(r),b[n].c(),b[n].m(h,p))}for(;n<b.length;n+=1)b[n].d(1);b.length=$.length}},d(e){e&&k(t),e&&k(f),e&&k(h),T(b,e)}}}function di(t){let n,r,o,i=ai,a=[];for(let e=0;e<i.length;e+=1)a[e]=ui(ci(t,i,e));return{c(){n=C("div"),r=C("h1"),r.textContent="ChangeLog",o=S();for(let e=0;e<a.length;e+=1)a[e].c();q(r,"class","svelte-w6f3pt")},m(e,t){x(e,n,t),w(n,r),w(n,o);for(let e=0;e<a.length;e+=1)a[e].m(n,null)},p(e,[t]){if(0&t){let r;for(i=ai,r=0;r<i.length;r+=1){const o=ci(e,i,r);a[r]?a[r].p(o,t):(a[r]=ui(o),a[r].c(),a[r].m(n,null))}for(;r<a.length;r+=1)a[r].d(1);a.length=i.length}},i:e,o:e,d(e){e&&k(n),T(a,e)}}}ai[0].date.toLocaleDateString();class fi extends Se{constructor(e){super(),Ie(this,e,null,di,s,{})}}function hi(t){let n,r,o,i,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,T,E,A,M,N,O,U,P,D,B,j,L,F,R,_,H;return{c(){n=C("h1"),r=I("MuseTree Help"),i=S(),a=C("p"),a.innerHTML="<i>\n    You can open this window at any time by clicking\n    <b>About</b>\n    , then clicking\n    <b>Help</b></i>",s=S(),c=C("h2"),l=I("What is MuseTree?"),d=S(),f=C("p"),f.textContent="MuseTree lets you work with an AI to generate music in range of styles. It is\n  designed for non-musicians interested in creating music, and small content\n  creators e.g. YouTubers.",h=S(),p=C("h2"),m=I("Getting Started"),y=S(),v=C("p"),v.innerHTML="\n  In the\n  <b>Tree View</b>\n  , right-click the red\n  <b>Root</b>\n  node and select\n  <b>Request More</b>\n  . This asks the AI to generate some music. It can take up to a minute, so be\n  patient.\n",$=S(),b=C("p"),b.innerHTML="\n  When you see the four children under the root node, try clicking one to select\n  it. The\n  <b>Track View</b>\n  will display the notes and you will the audio begin to play. Pick your\n  favourite child, and ask the AI to generate a follow-up section, then delete\n  the others.\n",T=S(),E=C("p"),E.innerHTML="\n  You can control the AI using the\n  <b>Generation Options</b>\n  on the right-hand side of the screen. Each option has a tooltip explaining\n  what that setting does.\n",A=S(),M=C("p"),M.innerHTML="\n  When you are happy with your track, right-click the bottom node and choose\n  <b>Save Audio</b>\n  .\n",N=S(),O=C("h2"),U=I("Advanced Tips"),D=S(),B=C("p"),B.innerHTML="\n  After right-clicking a node, each option in the context menu has one letter\n  underlined. Rather than clicking the button, you can just press the underline\n  key on your keyboard. This works even if the menu is not open, as long as you\n  are hovering over that node. Other hotkeys are\n  <b>space</b>\n  for play/pause and\n  <b>z</b>\n  for undo.\n",j=S(),L=C("p"),L.innerHTML="\n  If all four children of a node are identical, be careful. MuseNet may have\n  started overfitting, and could be generating a real song. Try increasing the\n  <b>Temperature</b>\n  before asking the AI to try again.\n",F=S(),R=C("p"),R.innerHTML="\n  There is a\n  <b>Delete All</b>\n  option if you right-click the root node.\n",_=S(),H=C("p"),H.textContent="You can change the instruments or other settings mid-way through a track and\n  MuseNet will try to seamlessly transition to the new settings.",q(n,"style",o=Sr(t[0])),q(n,"class","svelte-zfoua3"),q(a,"class","subheading svelte-zfoua3"),q(c,"style",u=Sr(t[0])),q(p,"style",g=Sr(t[0])),q(O,"style",P=Sr(t[0]))},m(e,t){x(e,n,t),w(n,r),x(e,i,t),x(e,a,t),x(e,s,t),x(e,c,t),w(c,l),x(e,d,t),x(e,f,t),x(e,h,t),x(e,p,t),w(p,m),x(e,y,t),x(e,v,t),x(e,$,t),x(e,b,t),x(e,T,t),x(e,E,t),x(e,A,t),x(e,M,t),x(e,N,t),x(e,O,t),w(O,U),x(e,D,t),x(e,B,t),x(e,j,t),x(e,L,t),x(e,F,t),x(e,R,t),x(e,_,t),x(e,H,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(i),e&&k(a),e&&k(s),e&&k(c),e&&k(d),e&&k(f),e&&k(h),e&&k(p),e&&k(y),e&&k(v),e&&k($),e&&k(b),e&&k(T),e&&k(E),e&&k(A),e&&k(M),e&&k(N),e&&k(O),e&&k(D),e&&k(B),e&&k(j),e&&k(L),e&&k(F),e&&k(R),e&&k(_),e&&k(H)}}}function pi(e){return[{color:Kn.text}]}class mi extends Se{constructor(e){super(),Ie(this,e,pi,hi,s,{})}}function gi(e){let t;return{c(){t=I("Source Code")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function yi(e){let t;return{c(){t=I("Steven Waterman")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function vi(t){let n,r,o=ai[0].version.join(".")+"";return{c(){n=I("Changelog - v"),r=I(o)},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function $i(e){let t;return{c(){t=I("Help")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function bi(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p,m,g,y;return u=new ho({props:{$$slots:{default:[gi]},$$scope:{ctx:e}}}),u.$on("click",e[2]),f=new ho({props:{$$slots:{default:[yi]},$$scope:{ctx:e}}}),f.$on("click",e[3]),p=new ho({props:{$$slots:{default:[vi]},$$scope:{ctx:e}}}),p.$on("click",e[0]),g=new ho({props:{$$slots:{default:[$i]},$$scope:{ctx:e}}}),g.$on("click",e[1]),{c(){t=C("h1"),n=I("About"),o=S(),i=C("p"),i.innerHTML='\n  MuseTree is a custom front-end for\n  <a href="https://openai.com/blog/musenet/" target="_blank">\n    OpenAi&#39;s MuseNet\n  </a>\n  , the AI music generator. The official app is a toy designed to show off the\n  research. In contrast, MuseTree is designed for real music production, and has\n  been built from the ground-up with that in mind.\n',a=S(),s=C("p"),s.innerHTML='\n  MuseTree is still in active development. I&#39;m very happy to take suggestions,\n  so please open a GitHub issue or comment on an existing one with your ideas!\n  If you want to chat with me in real time, I\n  <a href="https://twitch.tv/stevenwaterman" target="_blank">\n    live-code on twitch.tv\n  </a>\n  Mon-Fri 2-6pm BST. At the minute, those streams are mostly my work on\n  MuseTree, so come along and say hi!\n',c=S(),l=C("div"),ke(u.$$.fragment),d=S(),ke(f.$$.fragment),h=S(),ke(p.$$.fragment),m=S(),ke(g.$$.fragment),q(t,"style",r=Sr({color:Kn.text})),q(t,"class","svelte-11a35pw"),q(l,"class","buttonRow svelte-11a35pw")},m(e,r){x(e,t,r),w(t,n),x(e,o,r),x(e,i,r),x(e,a,r),x(e,s,r),x(e,c,r),x(e,l,r),Te(u,l,null),w(l,d),Te(f,l,null),w(l,h),Te(p,l,null),w(l,m),Te(g,l,null),y=!0},p(e,[t]){const n={};32&t&&(n.$$scope={dirty:t,ctx:e}),u.$set(n);const r={};32&t&&(r.$$scope={dirty:t,ctx:e}),f.$set(r);const o={};32&t&&(o.$$scope={dirty:t,ctx:e}),p.$set(o);const i={};32&t&&(i.$$scope={dirty:t,ctx:e}),g.$set(i)},i(e){y||(ge(u.$$.fragment,e),ge(f.$$.fragment,e),ge(p.$$.fragment,e),ge(g.$$.fragment,e),y=!0)},o(e){ye(u.$$.fragment,e),ye(f.$$.fragment,e),ye(p.$$.fragment,e),ye(g.$$.fragment,e),y=!1},d(e){e&&k(t),e&&k(o),e&&k(i),e&&k(a),e&&k(s),e&&k(c),e&&k(l),Ce(u),Ce(f),Ce(p),Ce(g)}}}function wi(e){const{open:t}=Y("simple-modal");return[function(){t(fi,{},er)},function(){t(mi,{},er)},()=>window.open("https://github.com/stevenwaterman/musetree"),()=>window.open("http://www.stevenwaterman.uk")]}class xi extends Se{constructor(e){super(),Ie(this,e,wi,bi,s,{})}}function ki(e){let t;return{c(){t=I("About")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ti(e){let t,n;return t=new ho({props:{$$slots:{default:[ki]},$$scope:{ctx:e}}}),t.$on("click",e[0]),{c(){ke(t.$$.fragment)},m(e,r){Te(t,e,r),n=!0},p(e,[n]){const r={};4&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ye(t.$$.fragment,e),n=!1},d(e){Ce(t,e)}}}function Ci(e){const{open:t}=Y("simple-modal");return[function(){t(xi,{},er)}]}class Ei extends Se{constructor(e){super(),Ie(this,e,Ci,Ti,s,{})}}function Ii(e){let t,n,r,o,a,s,c,l,u;const f=e[11].default,p=d(f,e,e[10],null);return{c(){t=C("div"),n=C("label"),p&&p.c(),r=S(),o=C("input"),q(o,"id","upload"),q(o,"class","hidden svelte-1pik66g"),q(o,"type","file"),q(o,"accept",e[2]),o.multiple=a=!1,q(n,"for","upload"),q(n,"class","button enabled svelte-1pik66g"),q(n,"style",s=Sr({color:e[4],backgroundColor:e[5],...e[1]||{}}))},m(i,a){x(i,t,a),w(t,n),p&&p.m(n,null),w(n,r),w(n,o),e[13](o),c=!0,l||(u=[M(o,"input",O(N(e[6]))),M(t,"dragover",O(N(e[12]))),M(t,"drop",O(N(e[7])))],l=!0)},p(e,t){p&&p.p&&1024&t&&h(p,f,e,e[10],t,null,null),(!c||4&t)&&q(o,"accept",e[2]),(!c||50&t&&s!==(s=Sr({color:e[4],backgroundColor:e[5],...e[1]||{}})))&&q(n,"style",s)},i(e){c||(ge(p,e),c=!0)},o(e){ye(p,e),c=!1},d(n){n&&k(t),p&&p.d(n),e[13](null),l=!1,i(u)}}}function Si(e){let t,n;const r=e[11].default,o=d(r,e,e[10],null);return{c(){t=C("label"),o&&o.c(),q(t,"for","upload"),q(t,"class","button disabled svelte-1pik66g")},m(e,r){x(e,t,r),o&&o.m(t,null),n=!0},p(e,t){o&&o.p&&1024&t&&h(o,r,e,e[10],t,null,null)},i(e){n||(ge(o,e),n=!0)},o(e){ye(o,e),n=!1},d(e){e&&k(t),o&&o.d(e)}}}function Ai(e){let t,n,r,o;const i=[Si,Ii],a=[];function s(e,t){return e[0]?0:1}return t=s(e),n=a[t]=i[t](e),{c(){n.c(),r=A()},m(e,n){a[t].m(e,n),x(e,r,n),o=!0},p(e,[o]){let c=t;t=s(e),t===c?a[t].p(e,o):(pe(),ye(a[c],1,1,()=>{a[c]=null}),me(),n=a[t],n||(n=a[t]=i[t](e),n.c()),ge(n,1),n.m(r.parentNode,r))},i(e){o||(ge(n),o=!0)},o(e){ye(n),o=!1},d(e){a[t].d(e),e&&k(r)}}}function Mi(e,t,n){let r,o,i,{disabled:a}=t,{emphasise:s}=t,{style:c}=t,{fileTypes:l=""}=t,{handleFile:u=(()=>{})}=t;let{$$slots:d={},$$scope:f}=t;return e.$set=e=>{"disabled"in e&&n(0,a=e.disabled),"emphasise"in e&&n(8,s=e.emphasise),"style"in e&&n(1,c=e.style),"fileTypes"in e&&n(2,l=e.fileTypes),"handleFile"in e&&n(9,u=e.handleFile),"$$scope"in e&&n(10,f=e.$$scope)},e.$$.update=()=>{257&e.$$.dirty&&n(4,o=a?Kn.buttonBg:s?Kn.textEmphasis:Kn.textDark),257&e.$$.dirty&&n(5,i=a?Kn.buttonBgDisabled:s?Kn.text:Kn.buttonBg)},[a,c,l,r,o,i,function(){const e=r.files;e&&e.length&&u(e[0]),n(3,r.files=null,r)},function(e){const t=e.dataTransfer;if(null!==t){const e=t.files.item(0);null!==e&&u(e)}},s,u,f,d,function(t){J(e,t)},function(e){K[e?"unshift":"push"](()=>{r=e,n(3,r)})}]}class Ni extends Se{constructor(e){super(),Ie(this,e,Mi,Ai,s,{disabled:0,emphasise:8,style:1,fileTypes:2,handleFile:9})}}var Oi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function qi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ui(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var Pi=Ui((function(e,t){e.exports=function e(t,n,r){var o,i,a=window,s="application/octet-stream",c=r||s,l=t,u=!n&&!r&&l,d=document.createElement("a"),f=function(e){return String(e)},h=a.Blob||a.MozBlob||a.WebKitBlob||f,p=n||"download";if(h=h.call?h.bind(a):Blob,"true"===String(this)&&(c=(l=[l,c])[0],l=l[1]),u&&u.length<2048&&(p=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(t){e(t.target.response,p,s)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103.424&&h!==f))return navigator.msSaveBlob?navigator.msSaveBlob($(l),p):b(l);c=(l=$(l)).type||s}else if(/([\x80-\xff])/.test(l)){for(var g=0,y=new Uint8Array(l.length),v=y.length;g<v;++g)y[g]=l.charCodeAt(g);l=new h([y],{type:c})}function $(e){for(var t=e.split(/[:;,]/),n=t[1],r=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),o=r.length,i=0,a=new Uint8Array(o);i<o;++i)a[i]=r.charCodeAt(i);return new h([a],{type:n})}function b(e,t){if("download"in d)return d.href=e,d.setAttribute("download",p),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===t&&setTimeout((function(){a.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=l instanceof h?l:new h([l],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,p);if(a.URL)b(a.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===f)try{return b("data:"+c+";base64,"+a.btoa(o))}catch(e){return b("data:"+c+","+encodeURIComponent(o))}(i=new FileReader).onload=function(e){b(this.result)},i.readAsDataURL(o)}return!0}}));function Di(e){let t=()=>console.log("ERROR: Cancel Function not assigned");const n=new Promise((n,r)=>{t=()=>r({cancelled:!0}),Promise.resolve(e).then(n).catch(r)});return n.cancel=t,n}const Bi=Me(null);let ji=null,Li=null;function Fi(e){return e.children.map(Ri).reduce((e,t)=>e+t,0)}function Ri(e){return ot(e.encoding).length+e.children.map(Ri).reduce((e,t)=>e+t,0)}let _i=!1;async function Hi(e,t){_i=!1;const n=JSON.parse(t);Bi.set({done:0,total:Fi(n)});const r=async function(e){return{children:await Promise.all(e.children.map(e=>async function e(t,n,r,{encoding:o,children:i}){if(_i)throw new Error("Cancelled");const a=ot(o),s=await Wi(a,r,t,n);if(_i)throw new Error("Cancelled");const c=Promise.all(i.map(t=>e(s.startsAt,s.endsAt,s.activeNotesAtEnd,t))),l=it(s);if(_i)throw new Error("Cancelled");Bi.update(e=>null===e?null:{...e,done:e.done+a.length});const u=await c;return{sectionStore:l,children:u}}(0,0,{piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}},e)))}}(n);ji=Di(r),await ji.then(async t=>{!function(e){const t=l(e);Object.keys(t.children).forEach(t=>e.deleteChild(t)),e.updatePendingLoad(()=>0),e.resetNextChildIndex()}(e);for(let n of t.children)await Vi(e,n)}).catch(e=>{"cancelled"in e?console.log("promise rejected, reason: "+e):_i=!0}),Bi.set(null)}async function zi(e,t,n,r){_i=!1,Bi.set({done:0,total:e.length});const o=l(r),i=async function(e,t,n,r){return it(await Wi(e,t,n,r))}(e,"root"===o.type?{piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}}:o.section.activeNotesAtEnd,t,n);Li=Di(i),await Li.then(e=>{r.addChild(e)}).catch(e=>{"cancelled"in e?console.log("promise rejected, reason: "+e):_i=!0}),Bi.set(null)}async function Vi(e,t){const n=await e.addChild(t.sectionStore);for(let e of t.children)await Vi(n,e)}async function Wi(e,t,n,r){const o=r-n,i={piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}};Oe.forEach(e=>Object.values(t[e]).forEach(t=>i[e][t.pitch]={...t,startTime:t.startTime-o}));const a=xn(ln(e,i)),s=await pn(a.notes,a.activeAtEnd,a.duration),c=r+a.duration;return{encoding:a.encoding,notes:a.notes,activeNotesAtEnd:a.activeAtEnd,startsAt:r,endsAt:c,audio:s}}function Gi(t){let n,r,o,i,a;return{c(){n=C("div"),r=I("▶"),q(n,"class","playStop svelte-gz5acq"),q(n,"style",o=Sr({color:Kn.text}))},m(e,o){x(e,n,o),w(n,r),i||(a=M(n,"click",t[7]),i=!0)},p:e,d(e){e&&k(n),i=!1,a()}}}function Zi(t){let n,r,o;return{c(){n=C("div"),r=I("▶"),q(n,"class","playStop svelte-gz5acq"),q(n,"style",o=Sr({color:Kn.text,cursor:"default"}))},m(e,t){x(e,n,t),w(n,r)},p:e,d(e){e&&k(n)}}}function Xi(t){let n,r,o,i,a;return{c(){n=C("div"),r=I("■"),q(n,"class","playStop svelte-gz5acq"),q(n,"style",o=Sr({color:Kn.text}))},m(e,t){x(e,n,t),w(n,r),i||(a=M(n,"click",Qn),i=!0)},p:e,d(e){e&&k(n),i=!1,a()}}}function Yi(e){let t;return{c(){t=C("label"),t.textContent="Auto Scroll",q(t,"for","autoScroll"),q(t,"slot","trigger")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ji(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Scroll the track to show the part that is playing"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Qi(e){let t;return{c(){t=C("label"),t.textContent="Auto Play",q(t,"for","autoPlay"),q(t,"slot","trigger")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ki(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Start playing the audio when a new node is selected"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function ea(e){let t,n,r,o;return{c(){t=C("label"),n=I("Pre-Play: "),r=I(e[4]),o=I("s"),q(t,"for","preplay"),q(t,"slot","trigger")},m(e,i){x(e,t,i),w(t,n),w(t,r),w(t,o)},p(e,t){16&t&&P(r,e[4])},d(e){e&&k(t)}}}function ta(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="When a section auto-plays, how many seconds of the previous section\n        should we play first?"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function na(e){let t;return{c(){t=I("Undo (ctrl + z)")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ra(e){let t;return{c(){t=I("Load")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function oa(e){let t;return{c(){t=I("Save")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ia(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,T,E,I,A,N,O,U,P,B;function j(e,t){return"on"===e[1].type?Xi:"loading"===e[1].type?Zi:Gi}let L=j(e),F=L(e);return o=new xo({props:{$$slots:{default:[Ji],trigger:[Yi]},$$scope:{ctx:e}}}),u=new xo({props:{$$slots:{default:[Ki],trigger:[Qi]},$$scope:{ctx:e}}}),m=new xo({props:{$$slots:{default:[ta],trigger:[ea]},$$scope:{ctx:e}}}),$=new ho({props:{disabled:0===e[5].length,$$slots:{default:[na]},$$scope:{ctx:e}}}),$.$on("click",Sn.undo),T=new Ni({props:{fileTypes:".mst",handleFile:e[6],$$slots:{default:[ra]},$$scope:{ctx:e}}}),I=new ho({props:{disabled:e[0],$$slots:{default:[oa]},$$scope:{ctx:e}}}),I.$on("click",e[11]),N=new Ei({}),{c(){t=C("div"),F.c(),n=S(),r=C("div"),ke(o.$$.fragment),a=S(),s=C("input"),c=S(),l=C("div"),ke(u.$$.fragment),d=S(),f=C("input"),h=S(),p=C("div"),ke(m.$$.fragment),g=S(),y=C("input"),v=S(),ke($.$$.fragment),b=S(),ke(T.$$.fragment),E=S(),ke(I.$$.fragment),A=S(),ke(N.$$.fragment),q(s,"id","autoScroll"),q(s,"type","checkbox"),q(r,"class","col center margin svelte-gz5acq"),q(f,"id","autoPlay"),q(f,"type","checkbox"),q(l,"class","col center margin svelte-gz5acq"),q(y,"class","slider svelte-gz5acq"),q(y,"id","preplay"),q(y,"type","range"),q(y,"min","0"),q(y,"max","5"),q(y,"step","0.5"),q(p,"class","col margin svelte-gz5acq"),q(t,"class","container center svelte-gz5acq"),q(t,"style",O=Sr({color:Kn.textDark,borderTop:"1px solid",borderColor:Kn.border,backgroundColor:Kn.bgDark}))},m(i,k){x(i,t,k),F.m(t,null),w(t,n),w(t,r),Te(o,r,null),w(r,a),w(r,s),s.checked=e[2],w(t,c),w(t,l),Te(u,l,null),w(l,d),w(l,f),f.checked=e[3],w(t,h),w(t,p),Te(m,p,null),w(p,g),w(p,y),D(y,e[4]),w(t,v),Te($,t,null),w(t,b),Te(T,t,null),w(t,E),Te(I,t,null),w(t,A),Te(N,t,null),U=!0,P||(B=[M(s,"change",e[8]),M(f,"change",e[9]),M(y,"change",e[10]),M(y,"input",e[10])],P=!0)},p(e,[r]){L===(L=j(e))&&F?F.p(e,r):(F.d(1),F=L(e),F&&(F.c(),F.m(t,n)));const i={};16384&r&&(i.$$scope={dirty:r,ctx:e}),o.$set(i),4&r&&(s.checked=e[2]);const a={};16384&r&&(a.$$scope={dirty:r,ctx:e}),u.$set(a),8&r&&(f.checked=e[3]);const c={};16400&r&&(c.$$scope={dirty:r,ctx:e}),m.$set(c),16&r&&D(y,e[4]);const l={};32&r&&(l.disabled=0===e[5].length),16384&r&&(l.$$scope={dirty:r,ctx:e}),$.$set(l);const d={};16384&r&&(d.$$scope={dirty:r,ctx:e}),T.$set(d);const h={};1&r&&(h.disabled=e[0]),16384&r&&(h.$$scope={dirty:r,ctx:e}),I.$set(h)},i(e){U||(ge(o.$$.fragment,e),ge(u.$$.fragment,e),ge(m.$$.fragment,e),ge($.$$.fragment,e),ge(T.$$.fragment,e),ge(I.$$.fragment,e),ge(N.$$.fragment,e),U=!0)},o(e){ye(o.$$.fragment,e),ye(u.$$.fragment,e),ye(m.$$.fragment,e),ye($.$$.fragment,e),ye(T.$$.fragment,e),ye(I.$$.fragment,e),ye(N.$$.fragment,e),U=!1},d(e){e&&k(t),F.d(),Ce(o),Ce(u),Ce(m),Ce($),Ce(T),Ce(I),Ce(N),P=!1,i(B)}}}function aa(e,t,n){let r,o,i,a,s,c;u(e,Un,e=>n(13,r=e)),u(e,zn,e=>n(1,o=e)),u(e,ze,e=>n(2,i=e)),u(e,We,e=>n(3,a=e)),u(e,Ge,e=>n(4,s=e)),u(e,Sn,e=>n(5,c=e));const d=new FileReader;let f;d.onload=()=>{const e=d.result;null!==e&&Hi(Un,e)};return e.$$.update=()=>{8192&e.$$.dirty&&n(0,f=0===Object.keys(r.children).length)},[f,o,i,a,s,c,function(e){d.readAsText(e)},()=>Jn(0),function(){i=this.checked,ze.set(i)},function(){a=this.checked,We.set(a)},function(){s=U(this.value),Ge.set(s)},()=>function(e){const t=l(e.serialisedStore);Pi(t,"Save.mst")}(Un)]}class sa extends Se{constructor(e){super(),Ie(this,e,aa,ia,s,{})}}var ca=da,la=da,ua=function(e,t,n){e.removeEventListener("wheel",t,n)};function da(e,t,n){e.addEventListener("wheel",t,n)}ca.addWheelListener=la,ca.removeWheelListener=ua;var fa="function"==typeof Float32Array;function ha(e,t){return 1-3*t+3*e}function pa(e,t){return 3*t-6*e}function ma(e){return 3*e}function ga(e,t,n){return((ha(t,n)*e+pa(t,n))*e+ma(t))*e}function ya(e,t,n){return 3*ha(t,n)*e*e+2*pa(t,n)*e+ma(t)}function va(e){return e}var $a=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return va;for(var o=fa?new Float32Array(11):new Array(11),i=0;i<11;++i)o[i]=ga(.1*i,e,n);function a(t){for(var r=0,i=1;10!==i&&o[i]<=t;++i)r+=.1;--i;var a=r+.1*((t-o[i])/(o[i+1]-o[i])),s=ya(a,e,n);return s>=.001?function(e,t,n,r){for(var o=0;o<4;++o){var i=ya(t,n,r);if(0===i)return t;t-=(ga(t,n,r)-e)/i}return t}(t,a,e,n):0===s?a:function(e,t,n,r,o){var i,a,s=0;do{(i=ga(a=t+(n-t)/2,r,o)-e)>0?n=a:t=a}while(Math.abs(i)>1e-7&&++s<10);return a}(t,r,r+.1,e,n)}return function(e){return 0===e?0:1===e?1:ga(a(e),t,r)}},ba={ease:$a(.25,.1,.25,1),easeIn:$a(.42,0,1,1),easeOut:$a(0,0,.58,1),easeInOut:$a(.42,0,.58,1),linear:$a(0,0,1,1)},wa=function(e,t,n){var r=Object.create(null),o=Object.create(null),i="function"==typeof(n=n||{}).easing?n.easing:ba[n.easing];i||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),i=ba.ease);var a="function"==typeof n.step?n.step:Ta,s="function"==typeof n.done?n.done:Ta,c=function(e){if(!e){return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),l=Object.keys(t);l.forEach((function(n){r[n]=e[n],o[n]=t[n]-e[n]}));var u,d="number"==typeof n.duration?n.duration:400,f=Math.max(1,.06*d),h=0;return u=c.next(p),{cancel:function(){c.cancel(u),u=0}};function p(){var t=i(h/f);h+=1,function(t){l.forEach((function(n){e[n]=o[n]*t+r[n]}))}(t),h<=f?(u=c.next(p),a(e)):(u=0,setTimeout((function(){s(e)}),0))}},xa=Ca,ka=Ca();function Ta(){}function Ca(){var e=new Set,t=new Set,n=0;return{next:r,cancel:r,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function r(e){t.add(e),n||(n=requestAnimationFrame(o))}function o(){n=0;var r=t;t=e,(e=r).forEach((function(e){e()})),e.clear()}}wa.makeAggregateRaf=xa,wa.sharedScheduler=ka;var Ea=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=t[n];return i||(i=t[n]=[]),i.push({callback:r,ctx:o}),e},off:function(n,r){if(void 0===n)return t=Object.create(null),e;if(t[n])if("function"!=typeof r)delete t[n];else for(var o=t[n],i=0;i<o.length;++i)o[i].callback===r&&o.splice(i,1);return e},fire:function(n){var r,o=t[n];if(!o)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var i=0;i<o.length;++i){var a=o[i];a.callback.apply(a.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};var Ia=function(e,t,n){"object"!=typeof n&&(n={});var r,o,i,a,s,c,l,u,d,f,h="number"==typeof n.minVelocity?n.minVelocity:5,p="number"==typeof n.amplitude?n.amplitude:.25,m="function"==typeof n.cancelAnimationFrame?n.cancelAnimationFrame:"function"==typeof Oi.cancelAnimationFrame?Oi.cancelAnimationFrame:clearTimeout,g="function"==typeof n.requestAnimationFrame?n.requestAnimationFrame:"function"==typeof Oi.requestAnimationFrame?Oi.requestAnimationFrame:function(e){return setTimeout(e,16)};return{start:function(){r=e(),c=d=a=l=0,o=new Date,m(i),m(f),i=g(y)},stop:function(){m(i),m(f);var t=e();s=t.x,u=t.y,o=Date.now(),(a<-h||a>h)&&(s+=c=p*a);(l<-h||l>h)&&(u+=d=p*l);f=g(v)},cancel:function(){m(i),m(f)}};function y(){var t=Date.now(),n=t-o;o=t;var s=e(),c=s.x-r.x,u=s.y-r.y;r=s;var d=1e3/(1+n);a=.8*c*d+.2*a,l=.8*u*d+.2*l,i=g(y)}function v(){var e=Date.now()-o,n=!1,r=0,i=0;c&&((r=-c*Math.exp(-e/342))>.5||r<-.5?n=!0:r=c=0),d&&((i=-d*Math.exp(-e/342))>.5||i<-.5?n=!0:i=d=0),n&&(t(s+r,u+i),f=g(v))}};var Sa=function(e){if(e)return{capture:Ma,release:Ma};var t,n,r,o=!1;return{capture:function(e){o=!0,n=window.document.onselectstart,r=window.document.ondragstart,window.document.onselectstart=Aa,(t=e).ondragstart=Aa},release:function(){if(!o)return;o=!1,window.document.onselectstart=n,t&&(t.ondragstart=r)}}};function Aa(e){return e.stopPropagation(),!1}function Ma(){}var Na=function(){this.x=0,this.y=0,this.scale=1};var Oa=function(e,t){if(!Ua(e))throw new Error("svg element is required for svg.panzoom to work");var n=e.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");t.disableKeyboardInteraction||n.setAttribute("tabindex",0);return{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){var e=n.getCTM();if(!e)return n.getScreenCTM();return e},getOwner:function(){return n},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var r=e.getCTM();t.x=r.e,t.y=r.f,t.scale=r.a,n.removeAttributeNS(null,"viewBox")}}},qa=Ua;function Ua(e){return e&&e.ownerSVGElement&&e.getCTM}Oa.canAttach=qa;var Pa=function(e,t){if(!Ba(e))throw new Error("panzoom requires DOM element to be attached to the DOM tree");var n=e.parentElement;e.scrollTop=0,t.disableKeyboardInteraction||n.setAttribute("tabindex",0);return{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return n},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}},Da=Ba;function Ba(e){return e&&e.parentElement&&e.style}Pa.canAttach=Da;var ja=Sa(),La=Sa(!0),Fa=Ra;function Ra(e,t){var n=(t=t||{}).controller;if(n||(Oa.canAttach(e)?n=Oa(e,t):Pa.canAttach(e)&&(n=Pa(e,t))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var r=n.getOwner(),o={x:0,y:0},i=!1,a=new Na;n.initTransform&&n.initTransform(a);var s,c="function"==typeof t.filterKey?t.filterKey:za,l="number"==typeof t.pinchSpeed?t.pinchSpeed:1,u=t.bounds,d="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,f="number"==typeof t.minZoom?t.minZoom:0,h="number"==typeof t.boundsPadding?t.boundsPadding:.05,p="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,m=t.beforeWheel||za,g=t.beforeMouseDown||za,y="number"==typeof t.zoomSpeed?t.zoomSpeed:1,v=_a(t.transformOrigin),$=t.enableTextSelection?La:ja;!function(e){var t=typeof e;if("undefined"===t||"boolean"===t)return;if(!(Va(e.left)&&Va(e.top)&&Va(e.bottom)&&Va(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(u),t.autocenter&&function(){var e,t,o=0,i=0,s=B();if(s)o=s.left,i=s.top,e=s.right-s.left,t=s.bottom-s.top;else{var c=r.getBoundingClientRect();e=c.width,t=c.height}var l=n.getBBox();if(0===l.width||0===l.height)return;var u=t/l.height,d=e/l.width,f=Math.min(d,u);a.x=-(l.left+l.width/2)*f+e/2+o,a.y=-(l.top+l.height/2)*f+t/2+i,a.scale=f}();var b,w,x,k,T,C,E,I,S=0,A=!1,M=!1;T="smoothScroll"in t&&!t.smoothScroll?{start:za,stop:za,cancel:za}:Ia((function(){return{x:a.x,y:a.y}}),(function(e,t){ce(),U(e,t)}),t.smoothScroll);var N=!1;_();var O={dispose:function(){H()},moveBy:R,moveTo:U,centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw new Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),r=n.left+n.width/2,o=n.top+n.height/2,i=t.getBoundingClientRect(),a=i.width/2-r,s=i.height/2-o;R(a,s,!0)},zoomTo:se,zoomAbs:F,smoothZoom:ie,smoothZoomAbs:function(e,t,n){var r={scale:a.scale},o={scale:n};T.cancel(),ce(),E=wa(r,o,{step:function(n){F(e,t,n.scale)}})},showRectangle:function(e){var t=r.getBoundingClientRect(),n=q(t.width,t.height),o=e.right-e.left,i=e.bottom-e.top;if(!Number.isFinite(o)||!Number.isFinite(i))throw new Error("Invalid rectangle");var s=n.x/o,c=n.y/i,l=Math.min(s,c);a.x=-(e.left+o/2)*l+n.x/2,a.y=-(e.top+i/2)*l+n.y/2,a.scale=l},pause:function(){H(),N=!0},resume:function(){N&&(_(),N=!1)},isPaused:function(){return N},getTransform:function(){return a},getMinZoom:function(){return f},setMinZoom:function(e){f=e},getMaxZoom:function(){return d},setMaxZoom:function(e){d=e},getTransformOrigin:function(){return v},setTransformOrigin:function(e){v=_a(e)},getZoomSpeed:function(){return y},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");y=e}};return Ea(O),O;function q(e,t){if(n.getScreenCTM){var r=n.getScreenCTM(),i=r.a,a=r.d,s=r.e,c=r.f;o.x=e*i-s,o.y=t*a-c}else o.x=e,o.y=t;return o}function U(e,t){a.x=e,a.y=t,D(),he("pan"),j()}function P(e,t){U(a.x+e,a.y+t)}function D(){var e=B();if(e){var t,r,o,i,s=!1,c=(t=n.getBBox(),o=t.left,i=t.top,{left:(r={x:o*a.scale+a.x,y:i*a.scale+a.y}).x,top:r.y,right:t.width*a.scale+r.x,bottom:t.height*a.scale+r.y}),l=e.left-c.right;return l>0&&(a.x+=l,s=!0),(l=e.right-c.left)<0&&(a.x+=l,s=!0),(l=e.top-c.bottom)>0&&(a.y+=l,s=!0),(l=e.bottom-c.top)<0&&(a.y+=l,s=!0),s}}function B(){if(u){if("boolean"==typeof u){var e=r.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*h,top:n*h,right:t*(1-h),bottom:n*(1-h)}}return u}}function j(){i=!0,s=window.requestAnimationFrame(z)}function L(e,t,n){if(Wa(e)||Wa(t)||Wa(n))throw new Error("zoom requires valid numbers");var r=a.scale*n;if(r<f){if(a.scale===f)return;n=f/a.scale}if(r>d){if(a.scale===d)return;n=d/a.scale}var o=q(e,t);(a.x=o.x-n*(o.x-a.x),a.y=o.y-n*(o.y-a.y),u&&1===h&&1===f)?(a.scale*=n,D()):D()||(a.scale*=n);he("zoom"),j()}function F(e,t,n){L(e,t,n/a.scale)}function R(e,t,n){if(!n)return P(e,t);C&&C.cancel();var r=0,o=0;C=wa({x:0,y:0},{x:e,y:t},{step:function(e){P(e.x-r,e.y-o),r=e.x,o=e.y}})}function _(){r.addEventListener("mousedown",Q,{passive:!1}),r.addEventListener("dblclick",J,{passive:!1}),r.addEventListener("touchstart",W,{passive:!1}),r.addEventListener("keydown",V,{passive:!1}),ca.addWheelListener(r,re,{passive:!1}),j()}function H(){ca.removeWheelListener(r,re),r.removeEventListener("mousedown",Q),r.removeEventListener("keydown",V),r.removeEventListener("dblclick",J),r.removeEventListener("touchstart",W),s&&(window.cancelAnimationFrame(s),s=0),T.cancel(),te(),ne(),$.release(),de()}function z(){i&&(i=!1,n.applyTransform(a),he("transform"),s=0)}function V(e){var t=0,n=0,o=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?o=1:187!==e.keyCode&&107!==e.keyCode||(o=-1),!c(e,t,n,o)){if(t||n){e.preventDefault(),e.stopPropagation();var i=r.getBoundingClientRect();R(.05*(a=Math.min(i.width,i.height))*t,.05*a*n)}if(o){var a,s=le(100*o);se((a=v?ae():{x:(l=r.getBoundingClientRect()).width/2,y:l.height/2}).x,a.y,s)}var l}}function W(e){if(function(e){if(t.onTouch&&!t.onTouch(e))return;e.stopPropagation(),e.preventDefault()}(e),1===e.touches.length)return function(e){var t=oe(e.touches[0]);b=t;var n=q(t.x,t.y);w=n.x,x=n.y,T.cancel(),G()}(e,e.touches[0]);2===e.touches.length&&(k=Y(e.touches[0],e.touches[1]),I=!0,G())}function G(){A||(A=!0,document.addEventListener("touchmove",Z),document.addEventListener("touchend",X),document.addEventListener("touchcancel",X))}function Z(e){if(1===e.touches.length){e.stopPropagation();var t=q((d=oe(e.touches[0])).x,d.y),n=t.x-w,r=t.y-x;0!==n&&0!==r&&ue(),w=t.x,x=t.y,R(n,r)}else if(2===e.touches.length){I=!0;var o=e.touches[0],i=e.touches[1],a=Y(o,i),s=1+(a/k-1)*l,c=oe(o),u=oe(i);if(w=(c.x+u.x)/2,x=(c.y+u.y)/2,v){var d=ae();w=d.x,x=d.y}se(w,x,s),k=a,e.stopPropagation(),e.preventDefault()}}function X(e){if(e.touches.length>0){var t=q((n=oe(e.touches[0])).x,n.y);w=t.x,x=t.y}else{var n,r=new Date;if(r-S<300)if(v)ie((n=ae()).x,n.y,p);else ie(b.x,b.y,p);S=r,de(),ne()}}function Y(e,t){var n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function J(e){!function(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation())}(e);var n=oe(e);v&&(n=ae()),ie(n.x,n.y,p)}function Q(e){if(!g(e)){if(A)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){T.cancel();var t=oe(e),n=q(t.x,t.y);return w=n.x,x=n.y,document.addEventListener("mousemove",K),document.addEventListener("mouseup",ee),$.capture(e.target||e.srcElement),!1}}}function K(e){if(!A){ue();var t=oe(e),n=q(t.x,t.y),r=n.x-w,o=n.y-x;w=n.x,x=n.y,R(r,o)}}function ee(){$.release(),de(),te()}function te(){document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",ee),M=!1}function ne(){document.removeEventListener("touchmove",Z),document.removeEventListener("touchend",X),document.removeEventListener("touchcancel",X),M=!1,I=!1,A=!1}function re(e){if(!m(e)){T.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=le(t);if(1!==n){var r=v?ae():oe(e);se(r.x,r.y,n),e.preventDefault()}}}function oe(e){var t=r.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function ie(e,t,n){var r=a.scale,o={scale:r},i={scale:n*r};T.cancel(),ce(),E=wa(o,i,{step:function(n){F(e,t,n.scale)},done:fe})}function ae(){var e=r.getBoundingClientRect();return{x:e.width*v.x,y:e.height*v.y}}function se(e,t,n){return T.cancel(),ce(),L(e,t,n)}function ce(){E&&(E.cancel(),E=null)}function le(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(y*e/128))}function ue(){M||(he("panstart"),M=!0,T.start())}function de(){M&&(I||T.stop(),he("panend"))}function fe(){he("zoomend")}function he(e){O.fire(e,O)}}function _a(e){if(e)return"object"==typeof e?(Va(e.x)&&Va(e.y)||Ha(e),e):void Ha()}function Ha(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function za(){}function Va(e){return Number.isFinite(e)}function Wa(e){return Number.isNaN?Number.isNaN(e):e!=e}function Ga(e){for(var t,n=new Za(e),r=[];!n.eof();){var o=i();r.push(o)}return r;function i(){var e={};e.deltaTime=n.readVarInt();var r=n.readUInt8();if(240==(240&r)){if(255!==r){if(240==r){e.type="sysEx";i=n.readVarInt();return e.data=n.readBytes(i),e}if(247==r){e.type="endSysEx";i=n.readVarInt();return e.data=n.readBytes(i),e}throw"Unrecognised MIDI event type byte: "+r}e.meta=!0;var o=n.readUInt8(),i=n.readVarInt();switch(o){case 0:if(e.type="sequenceNumber",2!==i)throw"Expected length for sequenceNumber event is 2, got "+i;return e.number=n.readUInt16(),e;case 1:return e.type="text",e.text=n.readString(i),e;case 2:return e.type="copyrightNotice",e.text=n.readString(i),e;case 3:return e.type="trackName",e.text=n.readString(i),e;case 4:return e.type="instrumentName",e.text=n.readString(i),e;case 5:return e.type="lyrics",e.text=n.readString(i),e;case 6:return e.type="marker",e.text=n.readString(i),e;case 7:return e.type="cuePoint",e.text=n.readString(i),e;case 32:if(e.type="channelPrefix",1!=i)throw"Expected length for channelPrefix event is 1, got "+i;return e.channel=n.readUInt8(),e;case 33:if(e.type="portPrefix",1!=i)throw"Expected length for portPrefix event is 1, got "+i;return e.port=n.readUInt8(),e;case 47:if(e.type="endOfTrack",0!=i)throw"Expected length for endOfTrack event is 0, got "+i;return e;case 81:if(e.type="setTempo",3!=i)throw"Expected length for setTempo event is 3, got "+i;return e.microsecondsPerBeat=n.readUInt24(),e;case 84:if(e.type="smpteOffset",5!=i)throw"Expected length for smpteOffset event is 5, got "+i;var a=n.readUInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&a],e.hour=31&a,e.min=n.readUInt8(),e.sec=n.readUInt8(),e.frame=n.readUInt8(),e.subFrame=n.readUInt8(),e;case 88:if(e.type="timeSignature",4!=i)throw"Expected length for timeSignature event is 4, got "+i;return e.numerator=n.readUInt8(),e.denominator=1<<n.readUInt8(),e.metronome=n.readUInt8(),e.thirtyseconds=n.readUInt8(),e;case 89:if(e.type="keySignature",2!=i)throw"Expected length for keySignature event is 2, got "+i;return e.key=n.readInt8(),e.scale=n.readUInt8(),e;case 127:return e.type="sequencerSpecific",e.data=n.readBytes(i),e;default:return e.type="unknownMeta",e.data=n.readBytes(i),e.metatypeByte=o,e}}else{var s;if(0==(128&r)){if(null===t)throw"Running status byte encountered before status byte";s=r,r=t,e.running=!0}else s=n.readUInt8(),t=r;var c=r>>4;switch(e.channel=15&r,c){case 8:return e.type="noteOff",e.noteNumber=s,e.velocity=n.readUInt8(),e;case 9:var l=n.readUInt8();return e.type=0===l?"noteOff":"noteOn",e.noteNumber=s,e.velocity=l,0===l&&(e.byte9=!0),e;case 10:return e.type="noteAftertouch",e.noteNumber=s,e.amount=n.readUInt8(),e;case 11:return e.type="controller",e.controllerType=s,e.value=n.readUInt8(),e;case 12:return e.type="programChange",e.programNumber=s,e;case 13:return e.type="channelAftertouch",e.amount=s,e;case 14:return e.type="pitchBend",e.value=s+(n.readUInt8()<<7)-8192,e;default:throw"Unrecognised MIDI event type: "+c}}}}function Za(e){this.buffer=e,this.bufferLen=this.buffer.length,this.pos=0}!function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var t,n=0;n<e.length;++n){var r=e[n];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){t=r;break}}if(t){var o=t.getAttribute("query");if(o){var i=t.getAttribute("name")||"pz",a=Date.now();!function e(){var n=document.querySelector(o);if(!n){return Date.now()-a<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",i)}var r=function(e){for(var t=e.attributes,n={},r=0;r<t.length;++r){var o=s(t[r]);o&&(n[o.name]=o.value)}return n}(t);console.log(r),window[i]=Ra(n,r)}()}}}}function s(e){if(e.name&&("p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2]))return{name:e.name.substr(3),value:JSON.parse(e.value)}}}(),Za.prototype.eof=function(){return this.pos>=this.bufferLen},Za.prototype.readUInt8=function(){var e=this.buffer[this.pos];return this.pos+=1,e},Za.prototype.readInt8=function(){var e=this.readUInt8();return 128&e?e-256:e},Za.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},Za.prototype.readInt16=function(){var e=this.readUInt16();return 32768&e?e-65536:e},Za.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},Za.prototype.readInt24=function(){var e=this.readUInt24();return 8388608&e?e-16777216:e},Za.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},Za.prototype.readBytes=function(e){var t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,t},Za.prototype.readString=function(e){var t=this.readBytes(e);return String.fromCharCode.apply(null,t)},Za.prototype.readVarInt=function(){for(var e=0;!this.eof();){var t=this.readUInt8();if(!(128&t))return e+t;e+=127&t,e<<=7}return e},Za.prototype.readChunk=function(){var e=this.readString(4),t=this.readUInt32();return{id:e,length:t,data:this.readBytes(t)}};var Xa=function(e){var t=new Za(e),n=t.readChunk();if("MThd"!=n.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+n.id+"'";for(var r=function(e){var t=new Za(e),n=t.readUInt16(),r=t.readUInt16(),o={format:n,numTracks:r},i=t.readUInt16();32768&i?(o.framesPerSecond=256-(i>>8),o.ticksPerFrame=255&i):o.ticksPerBeat=i;return o}(n.data),o=[],i=0;!t.eof()&&i<r.numTracks;i++){var a=t.readChunk();if("MTrk"!=a.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+a.id+"'";var s=Ga(a.data);o.push(s)}return{header:r,tracks:o}};function Ya(e,t,n){var r,o=new Qa,i=t.length,a=null;for(r=0;r<i;r++)!1!==n.running&&(n.running||t[r].running)||(a=null),a=Ja(o,t[r],a,n.useByte9ForNoteOff);e.writeChunk("MTrk",o.buffer)}function Ja(e,t,n,r){var o=t.type,i=t.deltaTime,a=t.text||"",s=t.data||[],c=null;switch(e.writeVarInt(i),o){case"sequenceNumber":e.writeUInt8(255),e.writeUInt8(0),e.writeVarInt(2),e.writeUInt16(t.number);break;case"text":e.writeUInt8(255),e.writeUInt8(1),e.writeVarInt(a.length),e.writeString(a);break;case"copyrightNotice":e.writeUInt8(255),e.writeUInt8(2),e.writeVarInt(a.length),e.writeString(a);break;case"trackName":e.writeUInt8(255),e.writeUInt8(3),e.writeVarInt(a.length),e.writeString(a);break;case"instrumentName":e.writeUInt8(255),e.writeUInt8(4),e.writeVarInt(a.length),e.writeString(a);break;case"lyrics":e.writeUInt8(255),e.writeUInt8(5),e.writeVarInt(a.length),e.writeString(a);break;case"marker":e.writeUInt8(255),e.writeUInt8(6),e.writeVarInt(a.length),e.writeString(a);break;case"cuePoint":e.writeUInt8(255),e.writeUInt8(7),e.writeVarInt(a.length),e.writeString(a);break;case"channelPrefix":e.writeUInt8(255),e.writeUInt8(32),e.writeVarInt(1),e.writeUInt8(t.channel);break;case"portPrefix":e.writeUInt8(255),e.writeUInt8(33),e.writeVarInt(1),e.writeUInt8(t.port);break;case"endOfTrack":e.writeUInt8(255),e.writeUInt8(47),e.writeVarInt(0);break;case"setTempo":e.writeUInt8(255),e.writeUInt8(81),e.writeVarInt(3),e.writeUInt24(t.microsecondsPerBeat);break;case"smpteOffset":e.writeUInt8(255),e.writeUInt8(84),e.writeVarInt(5);var l=31&t.hour|{24:0,25:32,29:64,30:96}[t.frameRate];e.writeUInt8(l),e.writeUInt8(t.min),e.writeUInt8(t.sec),e.writeUInt8(t.frame),e.writeUInt8(t.subFrame);break;case"timeSignature":e.writeUInt8(255),e.writeUInt8(88),e.writeVarInt(4),e.writeUInt8(t.numerator);var u=255&Math.floor(Math.log(t.denominator)/Math.LN2);e.writeUInt8(u),e.writeUInt8(t.metronome),e.writeUInt8(t.thirtyseconds||8);break;case"keySignature":e.writeUInt8(255),e.writeUInt8(89),e.writeVarInt(2),e.writeInt8(t.key),e.writeUInt8(t.scale);break;case"sequencerSpecific":e.writeUInt8(255),e.writeUInt8(127),e.writeVarInt(s.length),e.writeBytes(s);break;case"unknownMeta":null!=t.metatypeByte&&(e.writeUInt8(255),e.writeUInt8(t.metatypeByte),e.writeVarInt(s.length),e.writeBytes(s));break;case"sysEx":e.writeUInt8(240),e.writeVarInt(s.length),e.writeBytes(s);break;case"endSysEx":e.writeUInt8(247),e.writeVarInt(s.length),e.writeBytes(s);break;case"noteOff":(c=(!1!==r&&t.byte9||r&&0==t.velocity?144:128)|t.channel)!==n&&e.writeUInt8(c),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteOn":(c=144|t.channel)!==n&&e.writeUInt8(c),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteAftertouch":(c=160|t.channel)!==n&&e.writeUInt8(c),e.writeUInt8(t.noteNumber),e.writeUInt8(t.amount);break;case"controller":(c=176|t.channel)!==n&&e.writeUInt8(c),e.writeUInt8(t.controllerType),e.writeUInt8(t.value);break;case"programChange":(c=192|t.channel)!==n&&e.writeUInt8(c),e.writeUInt8(t.programNumber);break;case"channelAftertouch":(c=208|t.channel)!==n&&e.writeUInt8(c),e.writeUInt8(t.amount);break;case"pitchBend":(c=224|t.channel)!==n&&e.writeUInt8(c);var d=8192+t.value,f=127&d,h=d>>7&127;e.writeUInt8(f),e.writeUInt8(h);break;default:throw"Unrecognized event type: "+o}return c}function Qa(){this.buffer=[]}Qa.prototype.writeUInt8=function(e){this.buffer.push(255&e)},Qa.prototype.writeInt8=Qa.prototype.writeUInt8,Qa.prototype.writeUInt16=function(e){var t=e>>8&255,n=255&e;this.writeUInt8(t),this.writeUInt8(n)},Qa.prototype.writeInt16=Qa.prototype.writeUInt16,Qa.prototype.writeUInt24=function(e){var t=e>>16&255,n=e>>8&255,r=255&e;this.writeUInt8(t),this.writeUInt8(n),this.writeUInt8(r)},Qa.prototype.writeInt24=Qa.prototype.writeUInt24,Qa.prototype.writeUInt32=function(e){var t=e>>24&255,n=e>>16&255,r=e>>8&255,o=255&e;this.writeUInt8(t),this.writeUInt8(n),this.writeUInt8(r),this.writeUInt8(o)},Qa.prototype.writeInt32=Qa.prototype.writeUInt32,Qa.prototype.writeBytes=function(e){this.buffer=this.buffer.concat(Array.prototype.slice.call(e,0))},Qa.prototype.writeString=function(e){var t,n=e.length,r=[];for(t=0;t<n;t++)r.push(e.codePointAt(t));this.writeBytes(r)},Qa.prototype.writeVarInt=function(e){if(e<0)throw"Cannot write negative variable-length integer";if(e<=127)this.writeUInt8(e);else{var t=e,n=[];for(n.push(127&t),t>>=7;t;){var r=127&t|128;n.push(r),t>>=7}this.writeBytes(n.reverse())}},Qa.prototype.writeChunk=function(e,t){this.writeString(e),this.writeUInt32(t.length),this.writeBytes(t)};var Ka={parseMidi:Xa,writeMidi:function(e,t){if("object"!=typeof e)throw"Invalid MIDI data";t=t||{};var n,r=e.header||{},o=e.tracks||[],i=o.length,a=new Qa;for(function(e,t,n){var r=null==t.format?1:t.format,o=128;t.timeDivision?o=t.timeDivision:t.ticksPerFrame&&t.framesPerSecond?o=-(255&t.framesPerSecond)<<8|255&t.ticksPerFrame:t.ticksPerBeat&&(o=32767&t.ticksPerBeat);var i=new Qa;i.writeUInt16(r),i.writeUInt16(n),i.writeUInt16(o),e.writeChunk("MThd",i.buffer)}(a,r,i),n=0;n<i;n++)Ya(a,o[n],t);return a.buffer}},es=Ui((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.instrumentChannels={piano:0,violin:1,cello:2,bass:3,guitar:4,flute:5,clarinet:6,trumpet:7,harp:8,drum:9};const n=[{voices:[40,41,44,45,48,49,50,51],on:14,off:15},{voices:[42,43],on:16,off:17},{voices:[32,33,34,35,36,37,38,39],on:18,off:19},{voices:[24,25,26,27,28,29,30,31],on:20,off:21},{voices:[72,73,74,75,76,77,78,79],on:22,off:23},{voices:[64,65,66,67,68,69,70,71],on:24,off:25},{voices:[56,57,58,59,60,61,62,63],on:26,off:27},{voices:[46],on:28,off:29}];t.getInstrumentInfo=function(e,r){if(r===t.instrumentChannels.drum)return{on:30,off:null};const o=n.find(t=>t.voices.indexOf(e)>-1);return o||{on:8,off:0}}}));qi(es);es.instrumentChannels,es.getInstrumentInfo;var ts=Ui((function(e,t){var n=Oi&&Oi.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function r(e){const t=[],n="timeDivision"in(r=e.header)?r.timeDivision:"ticksPerBeat"in r?48/r.ticksPerBeat:"ticksPerFrame"in r?1e6/(r.ticksPerFrame*r.framesPerSecond):48;var r;return e.tracks.map(e=>function(e,t){const n=[];let r=0;for(let o of e)r+=o.deltaTime*t,n.push(Object.assign(Object.assign({},o),{startTime:r}));return n}(e,n)).forEach(e=>t.push(...e)),t.sort((e,t)=>e.startTime-t.startTime),t}function o(e,t){const n=[],r=e*(120/t),o=Math.floor(r/128);for(let e=0;e<o;e++)n.push(4095);const i=r%128;return i&&n.push(3967+i),n}Object.defineProperty(t,"__esModule",{value:!0}),t.fromMidiToMusenet=function(e){return n(this,void 0,void 0,(function*(){return function(e){const t=[];let n=0;const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let i=120;for(let a of e){const e=a.startTime-n;if(t.push(...o(e,i)),n=a.startTime,"setTempo"!==a.type)if("programChange"!==a.type)if("noteOn"!==a.type){if("noteOff"===a.type){const e=r[a.channel],{off:n}=es.getInstrumentInfo(e,a.channel);if(null!==n){t.push(a.noteNumber+128*n);continue}}}else{const e=r[a.channel],{on:n}=es.getInstrumentInfo(e,a.channel);t.push(a.noteNumber+128*n)}else r[a.channel]=a.programNumber;else i=6e7/a.microsecondsPerBeat}return t}(r(yield function(e){return n(this,void 0,void 0,(function*(){return new Promise(t=>{const n=new FileReader;n.readAsArrayBuffer(e),n.onload=e=>{const n=e.target;if(null!==n){const e=n.result;if(null!==e){const n=Ka.parseMidi(new Uint8Array(e));t(n)}}}})}))}(e)))}))}}));qi(ts);ts.fromMidiToMusenet;var ns=Ui((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromMusenetToMidi=function(e){const t={header:{format:1,numTracks:10,ticksPerBeat:48},tracks:[[{deltaTime:0,channel:0,type:"programChange",programNumber:0}],[{deltaTime:0,channel:1,type:"programChange",programNumber:40}],[{deltaTime:0,channel:2,type:"programChange",programNumber:42}],[{deltaTime:0,channel:3,type:"programChange",programNumber:32}],[{deltaTime:0,channel:4,type:"programChange",programNumber:24}],[{deltaTime:0,channel:5,type:"programChange",programNumber:73}],[{deltaTime:0,channel:6,type:"programChange",programNumber:71}],[{deltaTime:0,channel:7,type:"programChange",programNumber:56}],[{deltaTime:0,channel:8,type:"programChange",programNumber:46}],[{deltaTime:0,channel:9,type:"programChange",programNumber:0}]]},n=e.map(r).filter(e=>null!==e),o=[0,0,0,0,0,0,0,0,0,0];n.forEach(e=>{if("note"===e.type){const n=es.instrumentChannels[e.instrument];0===e.volume?t.tracks[n].push({deltaTime:o[n],channel:n,type:"noteOff",noteNumber:e.pitch,velocity:e.volume}):(t.tracks[n].push({deltaTime:o[n],channel:n,type:"noteOn",noteNumber:e.pitch,velocity:e.volume}),"drum"===e.instrument&&t.tracks[9].push({deltaTime:0,channel:9,type:"noteOff",noteNumber:e.pitch,velocity:0})),o[n]=0}else if("wait"===e.type)for(let t=0;t<10;t++)o[t]+=e.delay}),t.tracks.forEach((e,t)=>{e.push({deltaTime:o[t],meta:!0,type:"endOfTrack"}),o[t]=0}),t.tracks=t.tracks.filter(e=>e.length>2),t.header.numTracks=t.tracks.length;const i=new Uint8Array(Ka.writeMidi(t));return new Blob([i],{type:"audio/midi"})};const n=[["piano",0],["piano",24],["piano",32],["piano",40],["piano",48],["piano",56],["piano",64],["piano",72],["piano",80],["piano",88],["piano",96],["piano",104],["piano",112],["piano",120],["violin",80],["violin",0],["cello",80],["cello",0],["bass",80],["bass",0],["guitar",80],["guitar",0],["flute",80],["flute",0],["clarinet",80],["clarinet",0],["trumpet",80],["trumpet",0],["harp",80],["harp",0]];function r(e){if(e>=0&&e<3840){const[t,r]=n[e>>7];return{type:"note",pitch:e%128,instrument:t,volume:r}}return e<3968?{type:"note",pitch:e%128,instrument:"drum",volume:80}:e<4096?{type:"wait",delay:e%128+1}:4096==e?{type:"start"}:null}t.parseToken=r}));qi(ns);ns.fromMusenetToMidi,ns.parseToken;var rs=Ui((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromMidi=ts.fromMidiToMusenet,t.toMidi=ns.fromMusenetToMidi}));qi(rs);var os=rs.fromMidi,is=rs.toMidi;const as={"Mozart's Rondo Alla Turca":"7 455 3972 71 3968 453 3975 69 3969 580 3974 68 3969 453 3979 69 584 3970 185 3981 72 3973 57 188 320 3973 64 3969 60 3978 842 3970 188 3968 320 3972 840 74 3969 60 3968 64 3974 72 3968 839 3968 444 3968 704 3970 71 3969 60 3968 840 3969 64 3977 844 3968 569 72 3976 57","Beethoven's Symphony No. 5":"7 3979 1439 1451 1463 1475 3980 1439 1451 1463 1475 3981 1439 1451 1463 1475 3979 31 43 55 67 3968 1435 1447 1459 1471 4095 3994 27 39 51 63 3986 1437 1449 1461 1473 3980 29 41 53 65 3968 1437 1449 1461 1473 3979 1437 1449 1461 1473 3980 29 41 53 65","Lady Gaga's Poker Face":"1336 3991 1336 3991 56 3968 1324 3990 44 3968 1324 3990 44 3968 1331 3990 51 3968 1331 3991 1324 51 3991 44 3968 1324 3990 44 3968 1336 3990 56 3968 1336 3991 1332 56 3991 1327 52 3991 47 3968 1334","Beethoven’s Für Elise":"7 4049 460 3988 331 76 3989 75 460 3987 459 76 3987 75 588 3988 455 76 3987 7 71 586 3988 7 456 74 3990 429 581 72 3988 308 3988 313 3988 316 3987 7 448 3986 7 453","Adele's Someone Like You":"7 3968 1453 1460 1465 3983 1213 3985 1344 3985 1341 3986 1337 3984 1341 3985 1344 3985 1341 3986 1209 3984 1213 3985 1216 3986 1213 3983 1337 3986 1213 3985 57 61 1216 3986 1213 3973 64 3979 1452 1460 1208 61 3984 1213 3986 1344","Justin Timberlake’s Cry Me A River":"812 824 3986 827 3987 59 831 3987 63 836 3987 68 839 4007 71 4007 807 44 819 56 3987 829 3988 61 832 3987 64 835 3987 67 838 4006 70","Luis Fonsi’s Despacito":"2890 4032 2889 3018 4031 3876 2339 2887 3017 3988 2467 3979 2882 3015 3983 3878 3984 3876 2342 2882 3982 2882 3972 2470 3978 3878 2346 2882 3984 2882 3971 2474 3979 3876 2339 2882 3983 3010 2887 3971 2467 3980 2887 3983 3878 2887","Frozen’s Let It Go":"437 719 3969 316 3988 848 3986 712 3993 847 4014 720 4049 689 53 568 60 72 975 80 3990 976 3969 79 3984 840 80 3992 848 4010 719 4015 710 3991 698 973 3968 49 691 56 72 79 80 3988 975 3969 70 3970 77 3982 966 3971 79 3988 845 4008 847 4012 710 3994 843","The Godfather Theme":"830 2622 833 2625 4002 1719 1731 1743 3980 3887 3978 3887 3980 3887 55 1724 67 1736 79 1748 4002 3885 48 56 60 62 1727 65 72 1739 84 1751 4003 2750 2753 3968 3876 3894 2340 1712 1719 2620 1726 63 1738 75 1750 87 4001 2748 3968 3894 1724 2623 1736 1748 3968 62 74 86 4002 60 2751 72 84 3968 3880 3894 1727 2627 1739 1751 4001 63 2755 75 87 3968 3894 1724 2623 1736 1748 4003 2468 48 55 60 2751 72 84 3968 3876 3894 2333 1712 1720 1726 2625 1738 1750 4002 62 2753 74 86 3968 3894 1724 2628 1736 1748 4002 2756 3968 3880 3894 2632","The Harry Potter Theme":"7 4095 3998 1479 3999 71 1484 4015 76 1487 3983 1486 79 3999 1484 78 4031 76 1491 3999 1489 83 4063 1486 81 4063 1484 78 4016 76 1487 3983 1486 79 3999 1482 78 4031 74 1485","The Pink Panther Theme":"7 4095 3977 1573 2341 1452 1457 1464 3983 37 2469 3968 37 1574 2342 44 1453 49 1458 56 1465 3984 38 2470 3968 38 45 50 57 3984 3876 1575 2343 1454 1459 1466 3983 39 2471 3968 3876 3886 39 1576 2344 46 1455 51 1460 58 1467 4019 3877 3882 4002 3886","Silent Night":"7 560 444 448 451 4056 64 577 67 581 3998 572 576 65 579 69 4026 560 567 572 576 67 4058 55 569"};function ss(e,t,n){const r=e.slice();return r[17]=t[n][0],r[18]=t[n][1],r}function cs(e){let t;return{c(){t=I("Upload Midi")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ls(t){let n,r,o,i=t[17]+"";return{c(){n=C("option"),r=I(i),n.__value=o=t[18],n.value=n.__value},m(e,t){x(e,n,t),w(n,r)},p:e,d(e){e&&k(n)}}}function us(e){let t;return{c(){t=I("Import")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ds(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,E,A,O,U,P,L,F;u=new Ni({props:{fileTypes:".mid",handleFile:e[3],$$slots:{default:[cs]},$$scope:{ctx:e}}});let R=Object.entries(as),_=[];for(let t=0;t<R.length;t+=1)_[t]=ls(ss(e,R,t));return U=new ho({props:{disabled:e[2],$$slots:{default:[us]},$$scope:{ctx:e}}}),U.$on("click",e[4]),{c(){t=C("h1"),n=I("Import"),o=S(),a=C("div"),s=C("span"),s.textContent="What to import:",c=S(),l=C("div"),ke(u.$$.fragment),d=S(),f=C("div"),h=C("label"),h.textContent="Examples:",p=S(),m=C("select"),g=C("option");for(let e=0;e<_.length;e+=1)_[e].c();v=S(),$=C("label"),$.textContent="Encoding",b=S(),E=C("textarea"),O=S(),ke(U.$$.fragment),q(t,"style",r=Sr({color:Kn.text})),q(t,"class","svelte-1togrbd"),q(s,"class","spread svelte-1togrbd"),q(l,"class","spread svelte-1togrbd"),q(h,"for","example"),B(h,"margin-right","12px"),g.selected=!0,g.__value="",g.value=g.__value,q(m,"id","example"),q(m,"style",y=Sr({margin:0,width:200,...e[5]})),void 0===e[1]&&oe(()=>e[7].call(m)),q(f,"class","spread row svelte-1togrbd"),q(a,"class","row svelte-1togrbd"),q($,"for","encoding"),B($,"display","none"),q(E,"id","encoding"),q(E,"class","encoding svelte-1togrbd"),q(E,"placeholder","MuseNet Encoding"),q(E,"style",A=Sr({border:"1px dotted",...e[5]}))},m(r,i){x(r,t,i),w(t,n),x(r,o,i),x(r,a,i),w(a,s),w(a,c),w(a,l),Te(u,l,null),w(a,d),w(a,f),w(f,h),w(f,p),w(f,m),w(m,g);for(let e=0;e<_.length;e+=1)_[e].m(m,null);j(m,e[1]),x(r,v,i),x(r,$,i),x(r,b,i),x(r,E,i),D(E,e[1]),x(r,O,i),Te(U,r,i),P=!0,L||(F=[M(m,"change",e[7]),M(E,"input",e[8]),M(E,"drop",N(e[9]))],L=!0)},p(e,[t]){const n={};if(2097152&t&&(n.$$scope={dirty:t,ctx:e}),u.$set(n),0&t){let n;for(R=Object.entries(as),n=0;n<R.length;n+=1){const r=ss(e,R,n);_[n]?_[n].p(r,t):(_[n]=ls(r),_[n].c(),_[n].m(m,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=R.length}2&t&&j(m,e[1]),2&t&&D(E,e[1]);const r={};4&t&&(r.disabled=e[2]),2097152&t&&(r.$$scope={dirty:t,ctx:e}),U.$set(r)},i(e){P||(ge(u.$$.fragment,e),ge(U.$$.fragment,e),P=!0)},o(e){ye(u.$$.fragment,e),ye(U.$$.fragment,e),P=!1},d(e){e&&k(t),e&&k(o),e&&k(a),Ce(u),T(_,e),e&&k(v),e&&k($),e&&k(b),e&&k(E),e&&k(O),Ce(U,e),L=!1,i(F)}}}function fs(t,n,r){let o,i=e,a=()=>(i(),i=c(l,e=>r(15,o=e)),l);t.$$.on_destroy.push(()=>i());const{close:s}=Y("simple-modal");let l,u,d,f,h,{importUnderStore:p}=n;a();let m,g,y="";async function v(e){const t=await os(e);r(1,y=rt(t))}const $={backgroundColor:Kn.bgLight,borderColor:Kn.border,color:Kn.text};return t.$set=e=>{"importUnderStore"in e&&r(6,p=e.importUnderStore)},t.$$.update=()=>{64&t.$$.dirty&&a(r(0,l=Rn(p))),32768&t.$$.dirty&&r(10,u=o),1024&t.$$.dirty&&r(11,d="root"===u.type?null:u.section),2048&t.$$.dirty&&(f=null===d?0:d.startsAt),2048&t.$$.dirty&&(h=null===d?0:d.endsAt),2&t.$$.dirty&&r(14,m=ot(y.trim())),16384&t.$$.dirty&&r(2,g=m.some(isNaN))},[l,y,g,v,async function(){s(),await zi(m,f,h,p)},$,p,function(){y=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),r(1,y)},function(){y=this.value,r(1,y)},e=>e.dataTransfer&&v(e.dataTransfer.files[0])]}class hs extends Se{constructor(e){super(),Ie(this,e,fs,ds,s,{importUnderStore:6})}}var ps=function(e,t){t=t||{};var n,r=e.numberOfChannels,o=e.sampleRate,i=t.float32?3:1,a=3===i?32:16;n=2===r?function(e,t){var n=e.length+t.length,r=new Float32Array(n),o=0,i=0;for(;o<n;)r[o++]=e[i],r[o++]=t[i],i++;return r}(e.getChannelData(0),e.getChannelData(1)):e.getChannelData(0);return function(e,t,n,r,o){var i=o/8,a=r*i,s=new ArrayBuffer(44+e.length*i),c=new DataView(s);ms(c,0,"RIFF"),c.setUint32(4,36+e.length*i,!0),ms(c,8,"WAVE"),ms(c,12,"fmt "),c.setUint32(16,16,!0),c.setUint16(20,t,!0),c.setUint16(22,r,!0),c.setUint32(24,n,!0),c.setUint32(28,n*a,!0),c.setUint16(32,a,!0),c.setUint16(34,o,!0),ms(c,36,"data"),c.setUint32(40,e.length*i,!0),1===t?function(e,t,n){for(var r=0;r<n.length;r++,t+=2){var o=Math.max(-1,Math.min(1,n[r]));e.setInt16(t,o<0?32768*o:32767*o,!0)}}(c,44,e):function(e,t,n){for(var r=0;r<n.length;r++,t+=4)e.setFloat32(t,n[r],!0)}(c,44,e);return s}(n,i,o,r,a)};function ms(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))}async function gs(e,t,n){let r=!1;for(;!r;)await fetch("https://musenet.openai.com/audio",{method:"POST",body:JSON.stringify({audioFormat:t,encoding:rt(e)}),headers:{"Content-Type":"application/json"}}).then(e=>e.blob()).then(e=>Pi(e,`${n}.${t}`)).then(()=>{r=!0}).catch(()=>{r=!0})}async function ys(e,t){const n=await async function(e){const t={piano:[],violin:[],cello:[],bass:[],guitar:[],flute:[],clarinet:[],trumpet:[],harp:[],drums:[]};for(let n of e){const e=Object.entries(n.notes);for(let r of e){const e=r[0],o=r[1];for(let r of o){const o={...r,startTime:r.startTime+n.startsAt,endTime:r.endTime+n.startsAt};t[e].push(o)}}}const n=e[e.length-1].endsAt;Object.entries(e[e.length-1].activeNotesAtEnd).forEach(([e,r])=>{const o=Object.values(r).map(e=>({type:"COMPLETE",startTime:e.startTime,endTime:n,pitch:e.pitch,volume:e.volume}));t[e].push(...o)});const r=new OfflineAudioContext(1,44100*(n+5),44100),o=r.createGain();o.gain.value=.0025,o.connect(r.destination);const i=Object.values(hn).map(e=>e.schedule(r,o,t,{piano:{},violin:{},cello:{},bass:{},guitar:{},flute:{},clarinet:{},trumpet:{},harp:{},drums:{}}));return await Promise.all(i),await r.startRendering()}(e),r=ps(n),o=new Uint8Array(r);Pi(o,t+".wav")}function vs(e){let t;return{c(){t=C("label"),t.textContent="Encoding:",q(t,"slot","trigger"),q(t,"class","leftMargin svelte-31ceku")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function $s(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Export the whole track up until that point, or just the one section you\n      clicked?"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function bs(e){let t;return{c(){t=I("Track")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ws(e){let t;return{c(){t=I("Section")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function xs(e){let t;return{c(){t=I("MuseTree (High Quality .wav)")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ks(e){let t;return{c(){t=I("MuseTree (Fast Render .wav)")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ts(e){let t;return{c(){t=I("MuseNet (.wav)")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Cs(e){let t;return{c(){t=I("MuseNet (.mp3)")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Es(e){let t;return{c(){t=I("MuseNet (.ogg)")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Is(e){let t;return{c(){t=I("Midi")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ss(e){let t;return{c(){t=I("Encoding")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function As(e){let t;return{c(){t=I("Log")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ms(e){let t,n,r,o,a,s,c,l,u,d,f,h,m,g,y,v,$,b,T,E,A,N,O,U,P,j,L,F,R,_,H,z,V,W,G,Z,X,Y,J,Q,K,ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de,fe,he,pe,me,ve,$e,be,we,xe,Ee,Ie,Se,Ae,Me,Ne;return h=new xo({props:{$$slots:{default:[$s],trigger:[vs]},$$scope:{ctx:e}}}),g=new ho({props:{emphasise:e[2],$$slots:{default:[bs]},$$scope:{ctx:e}}}),g.$on("click",e[12]),v=new ho({props:{emphasise:!e[2],$$slots:{default:[ws]},$$scope:{ctx:e}}}),v.$on("click",e[13]),Q=new ho({props:{$$slots:{default:[xs]},$$scope:{ctx:e}}}),Q.$on("click",e[15]),ne=new ho({props:{$$slots:{default:[ks]},$$scope:{ctx:e}}}),ne.$on("click",e[16]),se=new ho({props:{$$slots:{default:[Ts]},$$scope:{ctx:e}}}),se.$on("click",e[17]),le=new ho({props:{$$slots:{default:[Cs]},$$scope:{ctx:e}}}),le.$on("click",e[18]),de=new ho({props:{$$slots:{default:[Es]},$$scope:{ctx:e}}}),de.$on("click",e[19]),me=new ho({props:{$$slots:{default:[Is]},$$scope:{ctx:e}}}),me.$on("click",e[20]),we=new ho({props:{$$slots:{default:[Ss]},$$scope:{ctx:e}}}),we.$on("click",e[21]),Se=new ho({props:{$$slots:{default:[As]},$$scope:{ctx:e}}}),Se.$on("click",e[22]),{c(){t=C("h1"),n=I("Export"),o=S(),a=C("div"),s=C("label"),s.textContent="File name:",c=S(),l=C("input"),f=S(),ke(h.$$.fragment),m=S(),ke(g.$$.fragment),y=S(),ke(v.$$.fragment),$=S(),b=C("label"),b.textContent="Encoding",T=S(),E=C("div"),A=C("textarea"),U=S(),P=C("div"),j=I("Click to copy"),F=S(),R=C("h2"),_=I("Export as:"),z=S(),V=C("div"),W=C("span"),G=C("b"),Z=I("Recommended:"),Y=I("\n    Audio as it sounds elsewhere in the app, re-rendered as one section to prevent issues on section boundaries"),J=S(),ke(Q.$$.fragment),K=S(),ee=C("span"),ee.textContent="Audio as it sounds elsewhere in the app",te=S(),ke(ne.$$.fragment),re=S(),oe=C("span"),oe.textContent="Request the audio from MuseNet - as it would sound in the official MuseNet\n    tool. Less synth-y than the MuseTree export, but it can take a minute to\n    respond",ie=S(),ae=C("div"),ke(se.$$.fragment),ce=S(),ke(le.$$.fragment),ue=S(),ke(de.$$.fragment),fe=S(),he=C("span"),he.textContent="Midi file for editing in other software:",pe=S(),ke(me.$$.fragment),ve=S(),$e=C("span"),$e.textContent="Text file containing the encoding as seen in the box above:",be=S(),ke(we.$$.fragment),xe=S(),Ee=C("span"),Ee.textContent="Log info about the current track to the browser console for debugging",Ie=S(),ke(Se.$$.fragment),q(t,"style",r=Sr({color:Kn.text})),q(t,"class","svelte-31ceku"),q(s,"for","exportName"),q(l,"id","exportName"),q(l,"type","text"),q(l,"class",u=p(["leftMargin","dottedBorder"].join(" "))+" svelte-31ceku"),q(l,"style",d=Sr({marginBottom:0,...e[10]})),q(a,"class","row svelte-31ceku"),q(b,"for","encoding"),B(b,"display","none"),q(A,"id","encoding"),q(A,"class",N=p(["dottedBorder"].join(" "))+" svelte-31ceku"),A.readOnly=!0,q(A,"style",O=Sr({...e[10],width:"100%",resize:"none"})),A.value=e[3],q(P,"class","copy svelte-31ceku"),q(P,"style",L=Sr({color:Kn.text,backgroundColor:Kn.bgDark+"99"})),q(E,"class","copy_trigger svelte-31ceku"),q(R,"style",H=Sr({color:Kn.text})),q(R,"class","svelte-31ceku"),q(G,"style",X=Sr({color:Kn.text})),B(ae,"display","flex"),B(ae,"flex-direction","column"),q(V,"class","grid svelte-31ceku")},m(r,i){x(r,t,i),w(t,n),x(r,o,i),x(r,a,i),w(a,s),w(a,c),w(a,l),D(l,e[4]),w(a,f),Te(h,a,null),w(a,m),Te(g,a,null),w(a,y),Te(v,a,null),x(r,$,i),x(r,b,i),x(r,T,i),x(r,E,i),w(E,A),e[14](A),w(E,U),w(E,P),w(P,j),x(r,F,i),x(r,R,i),w(R,_),x(r,z,i),x(r,V,i),w(V,W),w(W,G),w(G,Z),w(W,Y),w(V,J),Te(Q,V,null),w(V,K),w(V,ee),w(V,te),Te(ne,V,null),w(V,re),w(V,oe),w(V,ie),w(V,ae),Te(se,ae,null),w(ae,ce),Te(le,ae,null),w(ae,ue),Te(de,ae,null),w(V,fe),w(V,he),w(V,pe),Te(me,V,null),w(V,ve),w(V,$e),w(V,be),Te(we,V,null),w(V,xe),w(V,Ee),w(V,Ie),Te(Se,V,null),Ae=!0,Me||(Ne=[M(l,"input",e[11]),M(P,"click",e[9])],Me=!0)},p(e,[t]){16&t&&l.value!==e[4]&&D(l,e[4]);const n={};536870912&t&&(n.$$scope={dirty:t,ctx:e}),h.$set(n);const r={};4&t&&(r.emphasise=e[2]),536870912&t&&(r.$$scope={dirty:t,ctx:e}),g.$set(r);const o={};4&t&&(o.emphasise=!e[2]),536870912&t&&(o.$$scope={dirty:t,ctx:e}),v.$set(o),(!Ae||8&t)&&(A.value=e[3]);const i={};536870912&t&&(i.$$scope={dirty:t,ctx:e}),Q.$set(i);const a={};536870912&t&&(a.$$scope={dirty:t,ctx:e}),ne.$set(a);const s={};536870912&t&&(s.$$scope={dirty:t,ctx:e}),se.$set(s);const c={};536870912&t&&(c.$$scope={dirty:t,ctx:e}),le.$set(c);const u={};536870912&t&&(u.$$scope={dirty:t,ctx:e}),de.$set(u);const d={};536870912&t&&(d.$$scope={dirty:t,ctx:e}),me.$set(d);const f={};536870912&t&&(f.$$scope={dirty:t,ctx:e}),we.$set(f);const p={};536870912&t&&(p.$$scope={dirty:t,ctx:e}),Se.$set(p)},i(e){Ae||(ge(h.$$.fragment,e),ge(g.$$.fragment,e),ge(v.$$.fragment,e),ge(Q.$$.fragment,e),ge(ne.$$.fragment,e),ge(se.$$.fragment,e),ge(le.$$.fragment,e),ge(de.$$.fragment,e),ge(me.$$.fragment,e),ge(we.$$.fragment,e),ge(Se.$$.fragment,e),Ae=!0)},o(e){ye(h.$$.fragment,e),ye(g.$$.fragment,e),ye(v.$$.fragment,e),ye(Q.$$.fragment,e),ye(ne.$$.fragment,e),ye(se.$$.fragment,e),ye(le.$$.fragment,e),ye(de.$$.fragment,e),ye(me.$$.fragment,e),ye(we.$$.fragment,e),ye(Se.$$.fragment,e),Ae=!1},d(n){n&&k(t),n&&k(o),n&&k(a),Ce(h),Ce(g),Ce(v),n&&k($),n&&k(b),n&&k(T),n&&k(E),e[14](null),n&&k(F),n&&k(R),n&&k(z),n&&k(V),Ce(Q),Ce(ne),Ce(se),Ce(le),Ce(de),Ce(me),Ce(we),Ce(Se),Me=!1,i(Ne)}}}function Ns(t,n,r){let o,i,a,s,l=e,d=()=>(l(),l=c(b,e=>r(28,o=e)),b),f=e,h=()=>(f(),f=c(y,e=>r(6,i=e)),y);u(t,jn,e=>r(7,a=e)),u(t,Bn,e=>r(8,s=e)),t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>f());let p,m,g,y,v,$,{store:b}=n;d(),h();let w,x,k=!0,T="MuseTreeExport";const C={borderColor:Kn.border,backgroundColor:Kn.bgLight,color:Kn.text};return t.$set=e=>{"store"in e&&d(r(0,b=e.store))},t.$$.update=()=>{268435456&t.$$.dirty&&r(23,p=o),8388608&t.$$.dirty&&r(24,m=p.encoding),8388608&t.$$.dirty&&r(25,g=p.section.encoding),16777216&t.$$.dirty&&r(26,v=rt(m)),33554432&t.$$.dirty&&r(27,$=rt(g)),201326596&t.$$.dirty&&r(3,w=k?v:$)},h(r(1,y=Un.selectedSectionsStore)),[b,y,k,w,T,x,i,a,s,function(){x&&(x.select(),document.execCommand("copy"),x.setSelectionRange(0,0))},C,function(){T=this.value,r(4,T)},()=>{r(2,k=!0)},()=>{r(2,k=!1)},function(e){K[e?"unshift":"push"](()=>{x=e,r(5,x)})},()=>ys(i,T),()=>async function(e,t){const n=await _n(e),r=ps(n),o=new Uint8Array(r);Pi(o,t+".wav")}(i,T),()=>{null!==a&&gs(a,"wav",T)},()=>{null!==a&&gs(a,"mp3",T)},()=>{null!==a&&gs(a,"ogg",T)},()=>{null!==a&&async function(e,t){const n=is(e);Pi(n,t+".mid")}(a,T)},()=>{null!==a&&Pi(rt(a),T+".txt")},()=>{const e=s;null!==e&&console.log(JSON.stringify(e.section))}]}class Os extends Se{constructor(e){super(),Ie(this,e,Ns,Ms,s,{store:0})}}const qs=Me(null);function Us(e,t,n){const r=e.slice();return r[65]=t[n][0],r[66]=t[n][1],r}function Ps(e){let t,n,r,o;return{c(){t=C("p"),n=I("+"),r=I(e[7]),q(t,"class","pendingLoad svelte-1u8aedx"),q(t,"style",o=Sr({color:Kn.textDark,backgroundColor:Kn.bgLight,border:"2px solid",borderColor:Kn.border}))},m(e,o){x(e,t,o),w(t,n),w(t,r)},p(e,t){128&t[0]&&P(r,e[7])},d(e){e&&k(t)}}}function Ds(e){let t,n,r=[],o=new Map,i=e[16];const a=e=>e[65];for(let t=0;t<i.length;t+=1){let n=Us(e,i,t),s=a(n);o.set(s,r[t]=Bs(s,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,o){for(let t=0;t<r.length;t+=1)r[t].m(e,o);x(e,t,o),n=!0},p(e,n){if(82199&n[0]){const i=e[16];pe(),r=xe(r,n,a,1,e,i,o,t.parentNode,we,Bs,t,Us),me()}},i(e){if(!n){for(let e=0;e<i.length;e+=1)ge(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)ye(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&k(t)}}}function Bs(e,t){let n,r,o;return r=new Fs({props:{parentStore:t[0],branchStore:t[8][t[65]],depth:t[1]+1,offset:t[14]+t[66],parentOffset:t[2],treeContainer:t[4]}}),{key:e,first:null,c(){n=A(),ke(r.$$.fragment),this.first=n},m(e,t){x(e,n,t),Te(r,e,t),o=!0},p(e,t){const n={};1&t[0]&&(n.parentStore=e[0]),65792&t[0]&&(n.branchStore=e[8][e[65]]),2&t[0]&&(n.depth=e[1]+1),81920&t[0]&&(n.offset=e[14]+e[66]),4&t[0]&&(n.parentOffset=e[2]),16&t[0]&&(n.treeContainer=e[4]),r.$set(n)},i(e){o||(ge(r.$$.fragment,e),o=!0)},o(e){ye(r.$$.fragment,e),o=!1},d(e){e&&k(n),Ce(r,e)}}}function js(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,T,A,O,U,D,B,j,L,F,R=e[7]>0&&Ps(e),_=e[16].length>0&&Ds(e);return{c(){t=C("div"),n=C("div"),r=C("span"),o=I(e[6]),c=S(),R&&R.c(),u=S(),_&&_.c(),d=S(),f=E("svg"),h=E("linearGradient"),p=E("stop"),g=E("stop"),$=E("stop"),O=E("path"),q(r,"class","label svelte-1u8aedx"),q(n,"class","node svelte-1u8aedx"),q(n,"style",a=Sr({backgroundColor:e[9],opacity:e[12]})),q(n,"tabindex",s=0),q(t,"class","placement svelte-1u8aedx"),q(t,"style",l=Sr({top:150*e[1],left:60*e[2]-25,pointerEvents:100===e[12]?"initial":"none"})),q(p,"offset","0%"),q(p,"stop-color",m=Kn.edgePlaying),q(g,"offset",y=e[11]+"%"),q(g,"stop-color",v=Kn.edgePlaying),q($,"offset",b=e[11]+"%"),q($,"stop-color",e[10]),q(h,"id",T=`linear${e[1]},${e[2]}`),q(h,"gradientUnits","userSpaceOnUse"),q(h,"x1","0%"),q(h,"y1","0%"),q(h,"x2",A=e[2]===e[3]?"0%":"100%"),q(h,"y2","100%"),q(O,"d",U=`m 5 0 c 0 ${e[18]+.5} ${2*e[17]} ${e[18]+.5} ${2*e[17]} ${2*e[18]+1}`),q(O,"stroke",D=`url(#linear${e[1]},${e[2]})`),q(O,"stroke-width","6px"),q(O,"fill","none"),q(O,"style",e[22]),q(O,"class","svelte-1u8aedx"),q(f,"class","line svelte-1u8aedx"),q(f,"width",e[19]),q(f,"height",B=2*e[18]+2),q(f,"style",e[23])},m(i,a){x(i,t,a),w(t,n),w(n,r),w(r,o),e[31](n),w(t,c),R&&R.m(t,null),x(i,u,a),_&&_.m(i,a),x(i,d,a),x(i,f,a),w(f,h),w(h,p),w(h,g),w(h,$),e[32](h),w(f,O),j=!0,L||(F=[M(n,"mousedown",e[24]),M(n,"contextmenu",N(e[25])),M(n,"mouseenter",e[26]),M(n,"mouseleave",e[27]),M(n,"keypress",e[28]),M(O,"click",e[29])],L=!0)},p(e,r){(!j||64&r[0])&&P(o,e[6]),(!j||4608&r[0]&&a!==(a=Sr({backgroundColor:e[9],opacity:e[12]})))&&q(n,"style",a),e[7]>0?R?R.p(e,r):(R=Ps(e),R.c(),R.m(t,null)):R&&(R.d(1),R=null),(!j||4102&r[0]&&l!==(l=Sr({top:150*e[1],left:60*e[2]-25,pointerEvents:100===e[12]?"initial":"none"})))&&q(t,"style",l),e[16].length>0?_?(_.p(e,r),65536&r[0]&&ge(_,1)):(_=Ds(e),_.c(),ge(_,1),_.m(d.parentNode,d)):_&&(pe(),ye(_,1,1,()=>{_=null}),me()),(!j||2048&r[0]&&y!==(y=e[11]+"%"))&&q(g,"offset",y),(!j||2048&r[0]&&b!==(b=e[11]+"%"))&&q($,"offset",b),(!j||1024&r[0])&&q($,"stop-color",e[10]),(!j||6&r[0]&&T!==(T=`linear${e[1]},${e[2]}`))&&q(h,"id",T),(!j||12&r[0]&&A!==(A=e[2]===e[3]?"0%":"100%"))&&q(h,"x2",A),(!j||393216&r[0]&&U!==(U=`m 5 0 c 0 ${e[18]+.5} ${2*e[17]} ${e[18]+.5} ${2*e[17]} ${2*e[18]+1}`))&&q(O,"d",U),(!j||6&r[0]&&D!==(D=`url(#linear${e[1]},${e[2]})`))&&q(O,"stroke",D),(!j||4194304&r[0])&&q(O,"style",e[22]),(!j||524288&r[0])&&q(f,"width",e[19]),(!j||262144&r[0]&&B!==(B=2*e[18]+2))&&q(f,"height",B),(!j||8388608&r[0])&&q(f,"style",e[23])},i(e){j||(ge(_),j=!0)},o(e){ye(_),j=!1},d(n){n&&k(t),e[31](null),R&&R.d(),n&&k(u),_&&_.d(n),n&&k(d),n&&k(f),e[32](null),L=!1,i(F)}}}function Ls(t,n,r){let o,i,a,s,l,d,f=e,h=()=>(f(),f=c(x,e=>r(52,o=e)),x),p=e,m=()=>(p(),p=c(w,e=>r(53,i=e)),w),g=e,y=()=>(g(),g=c(V,e=>r(54,a=e)),V),v=e,$=()=>(v(),v=c(Z,e=>r(55,s=e)),Z);u(t,qs,e=>r(56,l=e)),u(t,Je,e=>r(57,d=e)),t.$$.on_destroy.push(()=>f()),t.$$.on_destroy.push(()=>p()),t.$$.on_destroy.push(()=>g()),t.$$.on_destroy.push(()=>v());let{parentStore:b}=n,{branchStore:w}=n;m();let x,k,T,C,E,I,S,A,M,N,O,q,U,P,{depth:D}=n,{offset:B}=n,{parentOffset:j}=n,{treeContainer:L}=n;h();let F,R,_,H,z,V,W,G,Z,X,J,Q,ee,te,ne,re,oe=!1,ie=!1,ae=0;y(),$();const{open:se}=Y("simple-modal");function ce(e,{offset:t}){return{delay:Math.max(0,1e3*(M-t)),duration:0,tick:e=>{r(44,ie=0!==e)}}}function le(e,{offset:t}){const n=Math.max(0,1e3*(A-t)),o=1e3*(M-Math.max(A,t)),i=Math.max(0,t-A)/(M-A),a=1-i;return{delay:n,duration:o,tick:e=>{r(45,ae=100*(i+a*e))}}}let ue,de,fe,he,pe;return zn.subscribe(e=>{re&&ue&&(de&&de.end(),fe&&fe.end(),r(43,oe=!1),r(44,ie=!1),q&&"on"===e.type&&(r(43,oe=!0),r(45,ae=0),de=$e(re,ce,e),de.start(),fe=$e(ue,le,e),fe.start()))}),t.$set=e=>{"parentStore"in e&&r(30,b=e.parentStore),"branchStore"in e&&m(r(0,w=e.branchStore)),"depth"in e&&r(1,D=e.depth),"offset"in e&&r(2,B=e.offset),"parentOffset"in e&&r(3,j=e.parentOffset),"treeContainer"in e&&r(4,L=e.treeContainer)},t.$$.update=()=>{1073741824&t.$$.dirty[0]&&h(r(5,x=Rn(b))),2097152&t.$$.dirty[1]&&r(33,k=o),4194304&t.$$.dirty[1]&&r(34,T=i),8&t.$$.dirty[1]&&r(35,C=T.path),16&t.$$.dirty[1]&&r(6,E=C[C.length-1]),8&t.$$.dirty[1]&&r(7,I=T.pendingLoad),8&t.$$.dirty[1]&&r(36,S=T.section),32&t.$$.dirty[1]&&r(37,A=S.startsAt),32&t.$$.dirty[1]&&r(38,M=S.endsAt),192&t.$$.dirty[1]&&(N=M-A),8&t.$$.dirty[1]&&r(8,O=T.children),8&t.$$.dirty[1]&&r(40,q=T.onSelectedPath),8&t.$$.dirty[1]&&r(41,U=T.selectedByParent),8&t.$$.dirty[1]&&r(42,P=T.wasLastSelectedByParent),11780&t.$$.dirty[1]&&r(9,F=q?ie?Kn.nodePlaying:Kn.nodeActive:U||P&&k.onSelectedPath?Kn.nodeWarm:Kn.nodeInactive),11780&t.$$.dirty[1]&&r(10,R=q?ie?Kn.edgePlaying:Kn.edgeActive:U||P&&k.onSelectedPath?Kn.edgeWarm:Kn.edgeInactive),28672&t.$$.dirty[1]&&r(11,_=ie?100:oe?ae:0),4608&t.$$.dirty[1]&&r(12,H=q&&oe?25:100),512&t.$$.dirty[1]&&r(46,z=q?1:0),1&t.$$.dirty[0]&&y(r(13,V=w.numberOfLeavesStore)),8388608&t.$$.dirty[1]&&r(47,W=a),4&t.$$.dirty[0]|65536&t.$$.dirty[1]&&r(14,G=B+-W/2),1&t.$$.dirty[0]&&$(r(15,Z=w.placementStore)),16777216&t.$$.dirty[1]&&r(16,X=s),12&t.$$.dirty[0]&&r(48,J=Math.abs(j-B)),131072&t.$$.dirty[1]&&r(17,Q=30*J),131072&t.$$.dirty[1]&&r(19,te=60*J+10),12&t.$$.dirty[0]&&r(49,ne=60*Math.min(B,j)-5),512&t.$$.dirty[1]&&r(22,he=Sr({cursor:q?"pointer":"initial"})),262158&t.$$.dirty[0]|294912&t.$$.dirty[1]&&r(23,pe=Sr({left:ne,top:(D-1)*ee*2+24,transform:`scaleX(${B<j?-1:1})`,zIndex:z}))},r(18,ee=75),[w,D,B,j,L,x,E,I,O,F,R,_,H,V,G,Z,X,Q,ee,te,re,ue,he,pe,function(e){0===e.button&&Un.select(C)},function({clientX:e,clientY:t}){qs.set({coordinates:[e,t],stores:{type:"branch",parentStore:b,nodeStore:w}})},function(){re&&re.focus()},function(){null===l&&L.focus()},function(e){"r"!==e.key?"a"!==e.key?"s"!==e.key?"d"!==e.key||b.deleteChildWithUndo(C[C.length-1]):se(Os,{store:w},er):se(hs,{importUnderStore:w},er):kn(d,w,T)},function(e){if(console.log(e),!q)return;const t=e.offsetX,n=e.offsetY,r=e.target.viewportElement.clientWidth,o=e.target.viewportElement.clientHeight;let i;if(10===r)i=n/o;else{const e=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));i=Math.sqrt(Math.pow(t,2)+Math.pow(n,2))/e}Jn(A+i*N)},b,function(e){K[e?"unshift":"push"](()=>{re=e,r(20,re)})},function(e){K[e?"unshift":"push"](()=>{ue=e,r(21,ue)})}]}class Fs extends Se{constructor(e){super(),Ie(this,e,Ls,js,s,{parentStore:30,branchStore:0,depth:1,offset:2,parentOffset:3,treeContainer:4},[-1,-1,-1])}}function Rs(e){let t;return{c(){t=I("Cancel")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function _s(e){let t;return{c(){t=I("I'm Sure!")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Hs(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p;return d=new ho({props:{$$slots:{default:[Rs]},$$scope:{ctx:e}}}),d.$on("click",e[1]),h=new ho({props:{$$slots:{default:[_s]},$$scope:{ctx:e}}}),h.$on("click",e[0]),{c(){t=C("div"),n=C("h1"),r=I("Warning!"),i=S(),a=C("span"),a.textContent="You are about to delete everything. This cannot be undone!",s=S(),c=C("span"),c.textContent="Are you sure?",l=S(),u=C("div"),ke(d.$$.fragment),f=S(),ke(h.$$.fragment),q(n,"style",o=Sr({color:Kn.text})),q(n,"class","svelte-w6f3pt"),B(c,"margin","8px"),B(u,"display","flex"),B(u,"flex-direction","row"),B(u,"justify-content","space-around"),B(t,"display","flex"),B(t,"flex-direction","column"),B(t,"align-items","center")},m(e,o){x(e,t,o),w(t,n),w(n,r),w(t,i),w(t,a),w(t,s),w(t,c),w(t,l),w(t,u),Te(d,u,null),w(u,f),Te(h,u,null),p=!0},p(e,[t]){const n={};64&t&&(n.$$scope={dirty:t,ctx:e}),d.$set(n);const r={};64&t&&(r.$$scope={dirty:t,ctx:e}),h.$set(r)},i(e){p||(ge(d.$$.fragment,e),ge(h.$$.fragment,e),p=!0)},o(e){ye(d.$$.fragment,e),ye(h.$$.fragment,e),p=!1},d(e){e&&k(t),Ce(d),Ce(h)}}}function zs(e,t,n){let r,o,i,a;u(e,Un,e=>n(5,r=e));const{close:s}=Y("simple-modal");return e.$$.update=()=>{32&e.$$.dirty&&n(2,o=r),4&e.$$.dirty&&n(3,i=o.children),8&e.$$.dirty&&(a=Object.entries(i).map(([e,t])=>[parseInt(e),t]))},[function(){a.map(e=>e[0]).forEach(Un.deleteChild),Sn.clear(),s()},s]}class Vs extends Se{constructor(e){super(),Ie(this,e,zs,Hs,s,{})}}function Ws(e,t,n){const r=e.slice();return r[28]=t[n][0],r[29]=t[n][1],r}function Gs(e){let t,n,r=[],o=new Map,i=e[6];const a=e=>e[28];for(let t=0;t<i.length;t+=1){let n=Ws(e,i,t),s=a(n);o.set(s,r[t]=Zs(s,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,o){for(let t=0;t<r.length;t+=1)r[t].m(e,o);x(e,t,o),n=!0},p(e,n){if(85&n[0]){const i=e[6];pe(),r=xe(r,n,a,1,e,i,o,t.parentNode,we,Zs,t,Ws),me()}},i(e){if(!n){for(let e=0;e<i.length;e+=1)ge(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)ye(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&k(t)}}}function Zs(e,t){let n,r,o;return r=new Fs({props:{parentStore:Un,branchStore:t[2][t[28]],depth:1,offset:t[4]+t[29],parentOffset:0,treeContainer:t[0]}}),{key:e,first:null,c(){n=A(),ke(r.$$.fragment),this.first=n},m(e,t){x(e,n,t),Te(r,e,t),o=!0},p(e,t){const n={};68&t[0]&&(n.branchStore=e[2][e[28]]),80&t[0]&&(n.offset=e[4]+e[29]),1&t[0]&&(n.treeContainer=e[0]),r.$set(n)},i(e){o||(ge(r.$$.fragment,e),o=!0)},o(e){ye(r.$$.fragment,e),o=!1},d(e){e&&k(n),Ce(r,e)}}}function Xs(e){let t,n,r,o;return{c(){t=C("p"),n=I("+"),r=I(e[1]),q(t,"class","pendingLoad svelte-1owvn25"),q(t,"style",o=Sr({color:Kn.textDark,backgroundColor:Kn.bgDark,border:"2px solid",borderColor:Kn.border}))},m(e,o){x(e,t,o),w(t,n),w(t,r)},p(e,t){2&t[0]&&P(r,e[1])},d(e){e&&k(t)}}}function Ys(e){let t,n,r,o,a,s,c,l,u,d,f=e[6].length>0&&Gs(e),h=e[1]>0&&Xs(e);return{c(){f&&f.c(),t=S(),n=C("div"),r=C("div"),o=C("span"),o.textContent="Root",c=S(),h&&h.c(),q(o,"class","label"),q(r,"class","node svelte-1owvn25"),q(r,"style",a=Sr({backgroundColor:e[8]})),q(r,"tabindex",s=0),q(n,"class","placement svelte-1owvn25")},m(i,a){f&&f.m(i,a),x(i,t,a),x(i,n,a),w(n,r),w(r,o),e[14](r),w(n,c),h&&h.m(n,null),l=!0,u||(d=[M(r,"mousedown",e[9]),M(r,"contextmenu",N(e[10])),M(r,"mouseenter",e[11]),M(r,"mouseleave",e[12]),M(r,"keypress",e[13])],u=!0)},p(e,o){e[6].length>0?f?(f.p(e,o),64&o[0]&&ge(f,1)):(f=Gs(e),f.c(),ge(f,1),f.m(t.parentNode,t)):f&&(pe(),ye(f,1,1,()=>{f=null}),me()),(!l||256&o[0]&&a!==(a=Sr({backgroundColor:e[8]})))&&q(r,"style",a),e[1]>0?h?h.p(e,o):(h=Xs(e),h.c(),h.m(n,null)):h&&(h.d(1),h=null)},i(e){l||(ge(f),l=!0)},o(e){ye(f),l=!1},d(r){f&&f.d(r),r&&k(t),r&&k(n),e[14](null),h&&h.d(),u=!1,i(d)}}}function Js(t,n,r){let o,i,a,s,l,d,f=e,h=()=>(f(),f=c($,e=>r(19,i=e)),$),p=e,m=()=>(p(),p=c(x,e=>r(20,a=e)),x);u(t,Un,e=>r(18,o=e)),u(t,qs,e=>r(21,s=e)),u(t,Je,e=>r(22,l=e)),u(t,zn,e=>r(23,d=e)),t.$$.on_destroy.push(()=>f()),t.$$.on_destroy.push(()=>p());let g,y,v,$,b,w,x,k,T,{treeContainer:C}=n;h(),m();const{open:E}=Y("simple-modal");let I,S;return t.$set=e=>{"treeContainer"in e&&r(0,C=e.treeContainer)},t.$$.update=()=>{262144&t.$$.dirty[0]&&r(15,g=o),32768&t.$$.dirty[0]&&r(1,y=g.pendingLoad),32768&t.$$.dirty[0]&&r(2,v=g.children),524288&t.$$.dirty[0]&&r(16,b=i),65536&t.$$.dirty[0]&&r(4,w=-b/2),1048576&t.$$.dirty[0]&&r(6,k=a),8388608&t.$$.dirty[0]&&r(17,I="on"===d.type),131072&t.$$.dirty[0]&&r(8,S=I?Kn.nodePlaying:Kn.nodeActive)},h(r(3,$=Un.numberOfLeavesStore)),m(r(5,x=Un.placementStore)),[C,y,v,$,w,x,k,T,S,function(e){0===e.button&&Un.select([])},function(e){qs.set({coordinates:[e.clientX,e.clientY],stores:{type:"root",nodeStore:Un}})},function(){T&&T.focus()},function(){null===s&&C.focus()},function(e){"r"!==e.key?"a"!==e.key?"d"!==e.key||E(Vs,{},er):E(hs,{importUnderStore:Un},er):kn(l,Un,o)},function(e){K[e?"unshift":"push"](()=>{T=e,r(7,T)})}]}class Qs extends Se{constructor(e){super(),Ie(this,e,Js,Ys,s,{treeContainer:0},[-1,-1])}}function Ks(e){let t,n,r,o,a,s,c,l,u,d,f;return n=new ho({props:{$$slots:{default:[ec]},$$scope:{ctx:e}}}),n.$on("click",e[8]),o=new ho({props:{$$slots:{default:[tc]},$$scope:{ctx:e}}}),o.$on("click",e[11]),s=new ho({props:{$$slots:{default:[nc]},$$scope:{ctx:e}}}),s.$on("click",e[9]),{c(){t=C("div"),ke(n.$$.fragment),r=S(),ke(o.$$.fragment),a=S(),ke(s.$$.fragment),q(t,"class","contextModal svelte-13h57nj"),q(t,"style",c=Sr({backgroundColor:Kn.bgDark,border:"1px solid",borderColor:Kn.border,color:Kn.textDark,left:e[0],top:e[1]})),q(t,"tabindex",l=0)},m(i,c){x(i,t,c),Te(n,t,null),w(t,r),Te(o,t,null),w(t,a),Te(s,t,null),e[18](t),u=!0,d||(f=[M(t,"mouseleave",e[7]),M(t,"mousedown",e[16]),M(t,"contextmenu",O(N(e[17]))),M(t,"keydown",e[13])],d=!0)},p(e,r){const i={};2&r[1]&&(i.$$scope={dirty:r,ctx:e}),n.$set(i);const a={};2&r[1]&&(a.$$scope={dirty:r,ctx:e}),o.$set(a);const l={};2&r[1]&&(l.$$scope={dirty:r,ctx:e}),s.$set(l),(!u||3&r[0]&&c!==(c=Sr({backgroundColor:Kn.bgDark,border:"1px solid",borderColor:Kn.border,color:Kn.textDark,left:e[0],top:e[1]})))&&q(t,"style",c)},i(e){u||(ge(n.$$.fragment,e),ge(o.$$.fragment,e),ge(s.$$.fragment,e),u=!0)},o(e){ye(n.$$.fragment,e),ye(o.$$.fragment,e),ye(s.$$.fragment,e),u=!1},d(r){r&&k(t),Ce(n),Ce(o),Ce(s),e[18](null),d=!1,i(f)}}}function ec(e){let t,n;return{c(){t=C("u"),t.textContent="R",n=I("equest More")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function tc(e){let t,n;return{c(){t=C("u"),t.textContent="A",n=I("dd Midi")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function nc(e){let t,n;return{c(){t=C("u"),t.textContent="D",n=I("elete All")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function rc(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g;return r=new ho({props:{$$slots:{default:[oc]},$$scope:{ctx:e}}}),r.$on("click",e[8]),a=new ho({props:{$$slots:{default:[ic]},$$scope:{ctx:e}}}),a.$on("click",e[11]),c=new ho({props:{$$slots:{default:[ac]},$$scope:{ctx:e}}}),c.$on("click",e[12]),u=new ho({props:{$$slots:{default:[sc]},$$scope:{ctx:e}}}),u.$on("click",e[10]),{c(){t=C("div"),n=C("div"),ke(r.$$.fragment),o=S(),ke(a.$$.fragment),s=S(),ke(c.$$.fragment),l=S(),ke(u.$$.fragment),q(n,"class","contextModal svelte-13h57nj"),q(n,"style",d=Sr({backgroundColor:Kn.bgDark,border:"1px solid",borderColor:Kn.border,color:Kn.textDark,left:e[0],top:e[1]})),q(n,"tabindex",f=0),q(t,"class","contextModalContainer"),q(t,"style",h=Sr({left:e[0],top:e[1]}))},m(i,d){x(i,t,d),w(t,n),Te(r,n,null),w(n,o),Te(a,n,null),w(n,s),Te(c,n,null),w(n,l),Te(u,n,null),e[19](n),p=!0,m||(g=[M(n,"mousedown",O(N(e[14]))),M(n,"contextmenu",O(N(e[15]))),M(n,"keydown",e[13]),M(t,"mouseleave",e[7])],m=!0)},p(e,o){const i={};2&o[1]&&(i.$$scope={dirty:o,ctx:e}),r.$set(i);const s={};2&o[1]&&(s.$$scope={dirty:o,ctx:e}),a.$set(s);const l={};2&o[1]&&(l.$$scope={dirty:o,ctx:e}),c.$set(l);const f={};2&o[1]&&(f.$$scope={dirty:o,ctx:e}),u.$set(f),(!p||3&o[0]&&d!==(d=Sr({backgroundColor:Kn.bgDark,border:"1px solid",borderColor:Kn.border,color:Kn.textDark,left:e[0],top:e[1]})))&&q(n,"style",d),(!p||3&o[0]&&h!==(h=Sr({left:e[0],top:e[1]})))&&q(t,"style",h)},i(e){p||(ge(r.$$.fragment,e),ge(a.$$.fragment,e),ge(c.$$.fragment,e),ge(u.$$.fragment,e),p=!0)},o(e){ye(r.$$.fragment,e),ye(a.$$.fragment,e),ye(c.$$.fragment,e),ye(u.$$.fragment,e),p=!1},d(n){n&&k(t),Ce(r),Ce(a),Ce(c),Ce(u),e[19](null),m=!1,i(g)}}}function oc(e){let t,n;return{c(){t=C("u"),t.textContent="R",n=I("equest More")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function ic(e){let t,n;return{c(){t=C("u"),t.textContent="A",n=I("dd Midi")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function ac(e){let t,n;return{c(){t=C("u"),t.textContent="S",n=I("ave Audio")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function sc(e){let t,n;return{c(){t=C("u"),t.textContent="D",n=I("elete Branch")},m(e,r){x(e,t,r),x(e,n,r)},d(e){e&&k(t),e&&k(n)}}}function cc(e){let t,n,r,o=e[2]&&Ks(e),i=e[3]&&rc(e);return{c(){t=C("div"),o&&o.c(),n=S(),i&&i.c(),q(t,"class","container svelte-13h57nj")},m(e,a){x(e,t,a),o&&o.m(t,null),w(t,n),i&&i.m(t,null),r=!0},p(e,r){e[2]?o?(o.p(e,r),4&r[0]&&ge(o,1)):(o=Ks(e),o.c(),ge(o,1),o.m(t,n)):o&&(pe(),ye(o,1,1,()=>{o=null}),me()),e[3]?i?(i.p(e,r),8&r[0]&&ge(i,1)):(i=rc(e),i.c(),ge(i,1),i.m(t,null)):i&&(pe(),ye(i,1,1,()=>{i=null}),me())},i(e){r||(ge(o),ge(i),r=!0)},o(e){ye(o),ye(i),r=!1},d(e){e&&k(t),o&&o.d(),i&&i.d()}}}function lc(t,n,r){let o,i,a,s,l,d,f,h,p,m,g,y,v,$,b,w,x=e,k=()=>(x(),x=c(y,e=>r(29,i=e)),y);u(t,qs,e=>r(28,o=e)),u(t,Je,e=>r(30,a=e)),t.$$.on_destroy.push(()=>x()),k();const{open:T}=Y("simple-modal");function C(){qs.set(null)}function E(){C(),g&&v&&kn(a,g,v)}function I(){C(),T(Vs,{},er)}function S(){C(),m&&w&&m.deleteChildWithUndo(w)}function A(){C(),T(hs,{importUnderStore:g},er)}function M(){C(),T(Os,{store:g},er)}let N,O;return Z(()=>{N&&N.focus(),O&&O.focus()}),t.$$.update=()=>{268435456&t.$$.dirty[0]&&r(20,s=o),1048576&t.$$.dirty[0]&&r(21,l=null===s?null:s.coordinates),2097152&t.$$.dirty[0]&&r(0,d=null===l?null:l[0]-40),2097152&t.$$.dirty[0]&&r(1,f=null===l?null:l[1]-40),1048576&t.$$.dirty[0]&&r(2,h=null!==s&&"root"===s.stores.type),1048576&t.$$.dirty[0]&&r(3,p=null!==s&&"branch"===s.stores.type),1048584&t.$$.dirty[0]&&(m=p&&s&&"branch"===s.stores.type?s.stores.parentStore:null),1048576&t.$$.dirty[0]&&r(23,g=null===s?null:s.stores.nodeStore),8388608&t.$$.dirty[0]&&k(r(4,y=null===g?null:Rn(g))),536870928&t.$$.dirty[0]&&r(24,v=null===y?null:i),16777216&t.$$.dirty[0]&&($=null===v?null:v.children),16777216&t.$$.dirty[0]&&r(26,b=null===v?null:v.path),67108864&t.$$.dirty[0]&&(w=null===b?null:b[b.length-1])},[d,f,h,p,y,N,O,C,E,I,S,A,M,function(e){return"r"===e.key?E():"a"===e.key?A():"s"===e.key&&p?M():"d"===e.key&&h?I():"d"===e.key&&p?S():void 0},function(e){J(t,e)},function(e){J(t,e)},function(e){J(t,e)},function(e){J(t,e)},function(e){K[e?"unshift":"push"](()=>{N=e,r(5,N)})},function(e){K[e?"unshift":"push"](()=>{O=e,r(6,O)})}]}class uc extends Se{constructor(e){super(),Ie(this,e,lc,cc,s,{},[-1,-1])}}function dc(e){let t,n,r=null!=Un&&function(e){let t,n,r,o,i,a,s,c,l,u;return n=new uc({}),a=new Qs({props:{treeContainer:e[1]}}),{c(){t=C("div"),ke(n.$$.fragment),r=S(),o=C("div"),i=C("div"),ke(a.$$.fragment),q(i,"class","tree-position svelte-1hx9bs3"),q(o,"class","pan-container svelte-1hx9bs3"),q(t,"class","tree-container svelte-1hx9bs3"),q(t,"style",s=Sr({color:Kn.textEmphasis,backgroundColor:Kn.bgLight,borderLeft:"1px solid",borderColor:Kn.border}))},m(s,d){x(s,t,d),Te(n,t,null),w(t,r),w(t,o),w(o,i),Te(a,i,null),e[2](o),e[3](t),c=!0,l||(u=M(t,"mouseenter",e[4]),l=!0)},p(e,t){const n={};2&t&&(n.treeContainer=e[1]),a.$set(n)},i(e){c||(ge(n.$$.fragment,e),ge(a.$$.fragment,e),c=!0)},o(e){ye(n.$$.fragment,e),ye(a.$$.fragment,e),c=!1},d(r){r&&k(t),Ce(n),Ce(a),e[2](null),e[3](null),l=!1,u()}}}(e);return{c(){r&&r.c(),t=A()},m(e,o){r&&r.m(e,o),x(e,t,o),n=!0},p(e,[t]){null!=Un&&r.p(e,t)},i(e){n||(ge(r),n=!0)},o(e){ye(r),n=!1},d(e){r&&r.d(e),e&&k(t)}}}function fc(e,t,n){let r,o;Z(()=>{const e=Fa(r,{minZoom:.1,maxZoom:2,zoomDoubleClickSpeed:1,smoothScroll:!1});e.on("pan",()=>qs.set(null)),e.on("zoom",()=>qs.set(null)),e.on("transform",()=>qs.set(null))});return[r,o,function(e){K[e?"unshift":"push"](()=>{r=e,n(0,r)})},function(e){K[e?"unshift":"push"](()=>{o=e,n(1,o)})},()=>o.focus()]}class hc extends Se{constructor(e){super(),Ie(this,e,fc,dc,s,{})}}function pc(e,{delay:n=0,duration:r=400,easing:o=t}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:o,css:e=>"opacity: "+e*i}}function mc(e){let t,r,o,s,c,l,u,d,f,h,p,m=e[0].closeButton&&gc(e);const g=[e[2]];var y=e[1];function v(e){let t={};for(let e=0;e<g.length;e+=1)t=n(t,g[e]);return{props:t}}return y&&(l=new y(v())),{c(){t=C("div"),r=C("div"),o=C("div"),m&&m.c(),s=S(),c=C("div"),l&&ke(l.$$.fragment),q(c,"class","content svelte-fnsfcv"),q(c,"style",e[11]),q(o,"class","window svelte-fnsfcv"),q(o,"style",e[10]),q(r,"class","window-wrap svelte-fnsfcv"),q(t,"class","bg svelte-fnsfcv"),q(t,"style",e[9])},m(n,i){x(n,t,i),w(t,r),w(r,o),m&&m.m(o,null),w(o,s),w(o,c),l&&Te(l,c,null),e[31](r),e[32](t),f=!0,h||(p=[M(o,"introstart",(function(){a(e[5])&&e[5].apply(this,arguments)})),M(o,"outrostart",(function(){a(e[6])&&e[6].apply(this,arguments)})),M(o,"introend",(function(){a(e[7])&&e[7].apply(this,arguments)})),M(o,"outroend",(function(){a(e[8])&&e[8].apply(this,arguments)})),M(t,"click",e[16])],h=!0)},p(n,r){(e=n)[0].closeButton?m?m.p(e,r):(m=gc(e),m.c(),m.m(o,s)):m&&(m.d(1),m=null);const i=4&r[0]?function(e,t){const n={},r={},o={$$scope:1};let i=e.length;for(;i--;){const a=e[i],s=t[i];if(s){for(const e in a)e in s||(r[e]=1);for(const e in s)o[e]||(n[e]=s[e],o[e]=1);e[i]=s}else for(const e in a)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}(g,[(a=e[2],"object"==typeof a&&null!==a?a:{})]):{};var a;if(y!==(y=e[1])){if(l){pe();const e=l;ye(e.$$.fragment,1,0,()=>{Ce(e,1)}),me()}y?(l=new y(v()),ke(l.$$.fragment),ge(l.$$.fragment,1),Te(l,c,null)):l=null}else y&&l.$set(i);(!f||2048&r[0])&&q(c,"style",e[11]),(!f||1024&r[0])&&q(o,"style",e[10]),(!f||512&r[0])&&q(t,"style",e[9])},i(n){f||(l&&ge(l.$$.fragment,n),oe(()=>{u||(u=be(o,e[13],e[0].transitionWindowProps,!0)),u.run(1)}),oe(()=>{d||(d=be(t,e[12],e[0].transitionBgProps,!0)),d.run(1)}),f=!0)},o(n){l&&ye(l.$$.fragment,n),u||(u=be(o,e[13],e[0].transitionWindowProps,!1)),u.run(0),d||(d=be(t,e[12],e[0].transitionBgProps,!1)),d.run(0),f=!1},d(n){n&&k(t),m&&m.d(),l&&Ce(l),n&&u&&u.end(),e[31](null),e[32](null),n&&d&&d.end(),h=!1,i(p)}}}function gc(t){let n,r,o;return{c(){n=C("button"),q(n,"class","close svelte-fnsfcv")},m(e,i){x(e,n,i),r||(o=M(n,"click",t[14]),r=!0)},p:e,d(e){e&&k(n),r=!1,o()}}}function yc(e){let t,n,r,o,i=e[1]&&mc(e);const a=e[30].default,s=d(a,e,e[29],null);return{c(){i&&i.c(),t=S(),s&&s.c()},m(a,c){i&&i.m(a,c),x(a,t,c),s&&s.m(a,c),n=!0,r||(o=M(window,"keyup",e[15]),r=!0)},p(e,n){e[1]?i?(i.p(e,n),2&n[0]&&ge(i,1)):(i=mc(e),i.c(),ge(i,1),i.m(t.parentNode,t)):i&&(pe(),ye(i,1,1,()=>{i=null}),me()),s&&s.p&&536870912&n[0]&&h(s,a,e,e[29],n,null,null)},i(e){n||(ge(i),ge(s,e),n=!0)},o(e){ye(i),ye(s,e),n=!1},d(e){i&&i.d(e),e&&k(t),s&&s.d(e),r=!1,o()}}}function vc(e,t,n){let{key:r="simple-modal"}=t,{closeButton:o=!0}=t,{closeOnEsc:i=!0}=t,{closeOnOuterClick:a=!0}=t,{styleBg:s={top:0,left:0}}=t,{styleWindow:c={}}=t,{styleContent:l={}}=t,{setContext:u=X}=t,{transitionBg:d=pc}=t,{transitionBgProps:f={duration:250}}=t,{transitionWindow:h=d}=t,{transitionWindowProps:p=f}=t;const m={closeButton:o,closeOnEsc:i,closeOnOuterClick:a,styleBg:s,styleWindow:c,styleContent:l,transitionBg:d,transitionBgProps:f,transitionWindow:h,transitionWindowProps:p};let g,y,v={...m},$=null,b=null;const w=e=>Object.keys(e).reduce((t,n)=>`${t}; ${(e=>e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase())(n)}: ${e[n]}`,""),x=()=>{};let k=x,T=x,C=x,E=x;const I=(e={})=>{n(6,T=e.onClose||T),n(8,E=e.onClosed||E),n(1,$=null),n(2,b=null)};u(r,{open:(e,t={},r={},o={})=>{n(1,$=e),n(2,b=t),n(0,v={...m,...r}),n(5,k=o.onOpen||x),n(6,T=o.onClose||x),n(7,C=o.onOpened||x),n(8,E=o.onClosed||x)},close:I});let S,A,M,N,O,{$$slots:q={},$$scope:U}=t;return e.$set=e=>{"key"in e&&n(17,r=e.key),"closeButton"in e&&n(18,o=e.closeButton),"closeOnEsc"in e&&n(19,i=e.closeOnEsc),"closeOnOuterClick"in e&&n(20,a=e.closeOnOuterClick),"styleBg"in e&&n(21,s=e.styleBg),"styleWindow"in e&&n(22,c=e.styleWindow),"styleContent"in e&&n(23,l=e.styleContent),"setContext"in e&&n(24,u=e.setContext),"transitionBg"in e&&n(25,d=e.transitionBg),"transitionBgProps"in e&&n(26,f=e.transitionBgProps),"transitionWindow"in e&&n(27,h=e.transitionWindow),"transitionWindowProps"in e&&n(28,p=e.transitionWindowProps),"$$scope"in e&&n(29,U=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty[0]&&n(9,S=w(v.styleBg)),1&e.$$.dirty[0]&&n(10,A=w(v.styleWindow)),1&e.$$.dirty[0]&&n(11,M=w(v.styleContent)),1&e.$$.dirty[0]&&n(12,N=v.transitionBg),1&e.$$.dirty[0]&&n(13,O=v.transitionWindow)},[v,$,b,g,y,k,T,C,E,S,A,M,N,O,I,e=>{v.closeOnEsc&&$&&"Escape"===e.key&&(e.preventDefault(),I())},e=>{!v.closeOnOuterClick||e.target!==g&&e.target!==y||(e.preventDefault(),I())},r,o,i,a,s,c,l,u,d,f,h,p,U,q,function(e){K[e?"unshift":"push"](()=>{y=e,n(4,y)})},function(e){K[e?"unshift":"push"](()=>{g=e,n(3,g)})}]}class $c extends Se{constructor(e){super(),Ie(this,e,vc,yc,s,{key:17,closeButton:18,closeOnEsc:19,closeOnOuterClick:20,styleBg:21,styleWindow:22,styleContent:23,setContext:24,transitionBg:25,transitionBgProps:26,transitionWindow:27,transitionWindowProps:28},[-1,-1])}}function bc(e){let t,n,r,o,i,a,s,c,l,u,d,f=e[1].toLocaleString()+"",h=e[2].toLocaleString()+"",p=e[3].toFixed(0)+"";return{c(){t=C("div"),n=C("span"),r=I(f),o=I(" / "),i=I(h),a=S(),s=C("span"),c=I("("),l=I(p),u=I("%)"),q(n,"class","svelte-1ttf8uz"),q(s,"class","svelte-1ttf8uz"),q(t,"class","textContainer svelte-1ttf8uz"),q(t,"style",d=Sr({color:Kn.loadingBarText}))},m(e,d){x(e,t,d),w(t,n),w(n,r),w(n,o),w(n,i),w(t,a),w(t,s),w(s,c),w(s,l),w(s,u)},p(e,t){2&t&&f!==(f=e[1].toLocaleString()+"")&&P(r,f),4&t&&h!==(h=e[2].toLocaleString()+"")&&P(i,h),8&t&&p!==(p=e[3].toFixed(0)+"")&&P(l,p)},d(e){e&&k(t)}}}function wc(t){let n,r,o,i,a,s=t[0]&&bc(t);return{c(){n=C("div"),s&&s.c(),r=S(),o=C("div"),q(o,"class","bar svelte-1ttf8uz"),q(o,"style",i=Sr({backgroundColor:Kn.loadingBarFG,width:t[3]+"%"})),q(n,"class","backdrop svelte-1ttf8uz"),q(n,"style",a=Sr({backgroundColor:Kn.loadingBarBG}))},m(e,t){x(e,n,t),s&&s.m(n,null),w(n,r),w(n,o)},p(e,[t]){e[0]?s?s.p(e,t):(s=bc(e),s.c(),s.m(n,r)):s&&(s.d(1),s=null),8&t&&i!==(i=Sr({backgroundColor:Kn.loadingBarFG,width:e[3]+"%"}))&&q(o,"style",i)},i:e,o:e,d(e){e&&k(n),s&&s.d()}}}function xc(e,t,n){let r,o,i,a,s;return u(e,Bi,e=>n(4,r=e)),e.$$.update=()=>{16&e.$$.dirty&&n(0,o=r),1&e.$$.dirty&&n(1,i=null===o?0:o.done),1&e.$$.dirty&&n(2,a=null===o?0:o.total),6&e.$$.dirty&&n(3,s=100*(i||0)/(a||1))},[o,i,a,s]}class kc extends Se{constructor(e){super(),Ie(this,e,xc,wc,s,{})}}function Tc(e){let t,n,r,o,i,a;return r=new ho({props:{$$slots:{default:[Ec]},$$scope:{ctx:e}}}),r.$on("click",e[1]),i=new kc({}),{c(){t=C("p"),t.textContent="Loading",n=S(),ke(r.$$.fragment),o=S(),ke(i.$$.fragment),q(t,"class","loadingText svelte-8djw6b")},m(e,s){x(e,t,s),x(e,n,s),Te(r,e,s),x(e,o,s),Te(i,e,s),a=!0},p(e,t){const n={};4&t&&(n.$$scope={dirty:t,ctx:e}),r.$set(n)},i(e){a||(ge(r.$$.fragment,e),ge(i.$$.fragment,e),a=!0)},o(e){ye(r.$$.fragment,e),ye(i.$$.fragment,e),a=!1},d(e){e&&k(t),e&&k(n),Ce(r,e),e&&k(o),Ce(i,e)}}}function Cc(t){let n;return{c(){n=C("p"),n.textContent="Reverting",q(n,"class","loadingText svelte-8djw6b")},m(e,t){x(e,n,t)},p:e,i:e,o:e,d(e){e&&k(n)}}}function Ec(e){let t;return{c(){t=I("Cancel")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Ic(e){let t,n,r,o,i,a,s;const c=[Cc,Tc],l=[];function u(e,t){return e[0]?0:1}return i=u(e),a=l[i]=c[i](e),{c(){t=C("div"),n=C("div"),r=C("div"),r.innerHTML='<div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div> \n      <div class="svelte-8djw6b"></div>',o=S(),a.c(),q(r,"class","lds-spinner svelte-8djw6b"),L(r,"flip",e[0]),q(n,"class","column svelte-8djw6b"),q(t,"class","center svelte-8djw6b")},m(e,a){x(e,t,a),w(t,n),w(n,r),w(n,o),l[i].m(n,null),s=!0},p(e,[t]){1&t&&L(r,"flip",e[0]);let o=i;i=u(e),i===o?l[i].p(e,t):(pe(),ye(l[o],1,1,()=>{l[o]=null}),me(),a=l[i],a||(a=l[i]=c[i](e),a.c()),ge(a,1),a.m(n,null))},i(e){s||(ge(a),s=!0)},o(e){ye(a),s=!1},d(e){e&&k(t),l[i].d()}}}function Sc(e,t,n){let{cancelled:r=!1}=t;return e.$set=e=>{"cancelled"in e&&n(0,r=e.cancelled)},[r,function(){ji&&ji.cancel(),Li&&Li.cancel(),n(0,r=!0)}]}class Ac extends Se{constructor(e){super(),Ie(this,e,Sc,Ic,s,{cancelled:0})}}function Mc(e){const{open:t,close:n}=Y("simple-modal");return Bi.subscribe(e=>{e?t(Ac,{},{closeButton:!1,closeOnEsc:!1,closeOnOuterClick:!1,styleWindow:{background:"transparent",color:Kn.text},styleContent:{overflow:"hidden"}}):n()}),[]}class Nc extends Se{constructor(e){super(),Ie(this,e,Mc,null,s,{})}}function Oc(e){const{open:t}=Y("simple-modal");return G(()=>{const e=localStorage.getItem("autosave");null===e?t(mi,{},er):Hi(Un,e)}),[]}class qc extends Se{constructor(e){super(),Ie(this,e,Oc,null,s,{})}}function Uc(e,t,n){const r=e.slice();return r[2]=t[n],r}function Pc(e){let t;return{c(){t=C("label"),t.textContent="Show Instruments:",q(t,"slot","trigger"),q(t,"class","svelte-rs7i64")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Dc(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Deselecting an instrument will hide it from the track view. The\n        instrument will still play, but you won't see it.",q(r,"class","svelte-rs7i64")},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Bc(t){let n,r;return n=new so({props:{storeMap:dr,instrument:t[2]}}),{c(){ke(n.$$.fragment)},m(e,t){Te(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ye(n.$$.fragment,e),r=!1},d(e){Ce(n,e)}}}function jc(e){let t;return{c(){t=I("Show All")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Lc(e){let t;return{c(){t=I("Hide All")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Fc(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p,m;s=new xo({props:{$$slots:{default:[Dc],trigger:[Pc]},$$scope:{ctx:e}}});let g=Oe,y=[];for(let t=0;t<g.length;t+=1)y[t]=Bc(Uc(e,g,t));const v=e=>ye(y[e],1,1,()=>{y[e]=null});return f=new ho({props:{$$slots:{default:[jc]},$$scope:{ctx:e}}}),f.$on("click",e[0]),p=new ho({props:{$$slots:{default:[Lc]},$$scope:{ctx:e}}}),p.$on("click",e[1]),{c(){t=C("h1"),n=I("Advanced Display Options"),o=S(),i=C("div"),a=C("div"),ke(s.$$.fragment),c=S(),l=C("div");for(let e=0;e<y.length;e+=1)y[e].c();u=S(),d=C("div"),ke(f.$$.fragment),h=S(),ke(p.$$.fragment),q(t,"style",r=Sr({color:Kn.text})),q(t,"class","svelte-rs7i64"),q(a,"class","alignStart svelte-rs7i64"),q(l,"class","row svelte-rs7i64"),q(d,"class","row svelte-rs7i64"),q(i,"class","column svelte-rs7i64")},m(e,r){x(e,t,r),w(t,n),x(e,o,r),x(e,i,r),w(i,a),Te(s,a,null),w(i,c),w(i,l);for(let e=0;e<y.length;e+=1)y[e].m(l,null);w(i,u),w(i,d),Te(f,d,null),w(d,h),Te(p,d,null),m=!0},p(e,[t]){const n={};if(32&t&&(n.$$scope={dirty:t,ctx:e}),s.$set(n),0&t){let n;for(g=Oe,n=0;n<g.length;n+=1){const r=Uc(e,g,n);y[n]?(y[n].p(r,t),ge(y[n],1)):(y[n]=Bc(r),y[n].c(),ge(y[n],1),y[n].m(l,null))}for(pe(),n=g.length;n<y.length;n+=1)v(n);me()}const r={};32&t&&(r.$$scope={dirty:t,ctx:e}),f.$set(r);const o={};32&t&&(o.$$scope={dirty:t,ctx:e}),p.$set(o)},i(e){if(!m){ge(s.$$.fragment,e);for(let e=0;e<g.length;e+=1)ge(y[e]);ge(f.$$.fragment,e),ge(p.$$.fragment,e),m=!0}},o(e){ye(s.$$.fragment,e),y=y.filter(Boolean);for(let e=0;e<y.length;e+=1)ye(y[e]);ye(f.$$.fragment,e),ye(p.$$.fragment,e),m=!1},d(e){e&&k(t),e&&k(o),e&&k(i),Ce(s),T(y,e),Ce(f),Ce(p)}}}function Rc(e){return[function(){Oe.forEach(e=>{dr[e].set(!0)})},function(){Oe.forEach(e=>{dr[e].set(!1)})}]}class _c extends Se{constructor(e){super(),Ie(this,e,Rc,Fc,s,{})}}function Hc(e){let t;return{c(){t=I("Advanced")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function zc(e){let t;return{c(){t=C("label"),t.textContent="Track Zoom",q(t,"for","yScale"),q(t,"slot","trigger"),q(t,"class","svelte-bv0dpp")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Vc(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Vertically zoom the track view",q(r,"class","svelte-bv0dpp")},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Wc(e){let t;return{c(){t=C("label"),t.textContent="View Split",q(t,"for","split"),q(t,"slot","trigger"),q(t,"class","svelte-bv0dpp")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Gc(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="How much horizontal space to take up with the track view",q(r,"class","svelte-bv0dpp")},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function Zc(e){let t,n,r,o,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,T,E,A,N,O,U,B,j,L,F;return c=new ho({props:{style:Sr({fontSize:10}),$$slots:{default:[Hc]},$$scope:{ctx:e}}}),c.$on("click",e[2]),d=new xo({props:{$$slots:{default:[Vc],trigger:[zc]},$$scope:{ctx:e}}}),b=new xo({props:{$$slots:{default:[Gc],trigger:[Wc]},$$scope:{ctx:e}}}),{c(){t=C("div"),n=C("div"),r=C("h1"),o=I("Display"),s=S(),ke(c.$$.fragment),l=S(),u=C("div"),ke(d.$$.fragment),f=S(),h=C("input"),p=S(),m=C("span"),g=I(e[0]),y=I("%"),v=S(),$=C("div"),ke(b.$$.fragment),T=S(),E=C("input"),A=S(),N=C("span"),O=I(e[1]),U=I("%"),q(r,"style",a=Sr({color:Kn.text})),q(r,"class","svelte-bv0dpp"),q(n,"class","row svelte-bv0dpp"),q(h,"class","slider svelte-bv0dpp"),q(h,"id","yScale"),q(h,"type","range"),q(h,"min","10"),q(h,"max","500"),q(h,"step","10"),q(m,"class","svelte-bv0dpp"),q(u,"class","optionElement svelte-bv0dpp"),q(E,"class","slider svelte-bv0dpp"),q(E,"id","split"),q(E,"type","range"),q(E,"min","0"),q(E,"max","100"),q(E,"step","5"),q(N,"class","svelte-bv0dpp"),q($,"class","optionElement svelte-bv0dpp"),q(t,"class","options svelte-bv0dpp"),q(t,"style",B=Sr({color:Kn.textDark}))},m(i,a){x(i,t,a),w(t,n),w(n,r),w(r,o),w(n,s),Te(c,n,null),w(t,l),w(t,u),Te(d,u,null),w(u,f),w(u,h),D(h,e[0]),w(u,p),w(u,m),w(m,g),w(m,y),w(t,v),w(t,$),Te(b,$,null),w($,T),w($,E),D(E,e[1]),w($,A),w($,N),w(N,O),w(N,U),j=!0,L||(F=[M(h,"change",e[3]),M(h,"input",e[3]),M(E,"change",e[4]),M(E,"input",e[4])],L=!0)},p(e,[t]){const n={};64&t&&(n.$$scope={dirty:t,ctx:e}),c.$set(n);const r={};64&t&&(r.$$scope={dirty:t,ctx:e}),d.$set(r),1&t&&D(h,e[0]),(!j||1&t)&&P(g,e[0]);const o={};64&t&&(o.$$scope={dirty:t,ctx:e}),b.$set(o),2&t&&D(E,e[1]),(!j||2&t)&&P(O,e[1])},i(e){j||(ge(c.$$.fragment,e),ge(d.$$.fragment,e),ge(b.$$.fragment,e),j=!0)},o(e){ye(c.$$.fragment,e),ye(d.$$.fragment,e),ye(b.$$.fragment,e),j=!1},d(e){e&&k(t),Ce(c),Ce(d),Ce(b),L=!1,i(F)}}}function Xc(e,t,n){let r,o;u(e,Ze,e=>n(0,r=e)),u(e,Xe,e=>n(1,o=e));const{open:i}=Y("simple-modal");return[r,o,function(){i(_c,{},er)},function(){r=U(this.value),Ze.set(r)},function(){o=U(this.value),Xe.set(o)}]}class Yc extends Se{constructor(e){super(),Ie(this,e,Xc,Zc,s,{})}}function Jc(e){return Object.values(e.notes).flat().filter(e=>"COMPLETE"===e.type).length}function Qc(e,t,n){let r=[],o=t;return e.forEach(e=>{const t=e.startTime;o<t&&r.push({startTime:o,endTime:t}),o=Math.max(o,e.endTime)}),o<n&&r.push({startTime:o,endTime:n}),r}function Kc(e){const t={};return Oe.forEach(n=>t[n]=function(e,t){if(0===e.length)return{noteCount:0,totalPlayingTime:0,nonSilenceTime:0};const n=el(e,t),r=n.length,o=n.map(({startTime:e,endTime:t})=>t-e).reduce((e,t)=>e+t,0),i=e[0].startsAt,a=e[e.length-1].endsAt,s=a-i,c=Qc(n,i,a).map(e=>e.endTime-e.startTime).reduce((e,t)=>e+t,0);return{noteCount:r,totalPlayingTime:o,nonSilenceTime:s-c}}(e,n)),t}function el(e,t){return e.flatMap((n,r)=>{const o=void 0===t?Object.values(n.notes).flat():n.notes[t];return r===e.length-1?o.map(e=>({startTime:e.startTime+n.startsAt,endTime:"COMPLETE"===e.type?e.endTime+n.startsAt:n.endsAt})):o.filter(e=>"COMPLETE"===e.type).map(e=>({startTime:e.startTime+n.startsAt,endTime:e.endTime+n.startsAt}))}).sort((e,t)=>e.startTime-t.startTime)}function tl(e,t,n){const r=e.slice();return r[18]=t[n][0],r[19]=t[n][1],r}function nl(e,t,n){const r=e.slice();return r[18]=t[n][0],r[19]=t[n][1],r}function rl(e,t,n){const r=e.slice();return r[18]=t[n][0],r[19]=t[n][1],r}function ol(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b,T,E,A,M,N,O,U,D,j,L,F,R,_,H,z,V,W,G,Z,X,Y,J,Q,K,ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de,fe,he;n=new ho({props:{emphasise:e[1],style:"font-size: 10pt",$$slots:{default:[al]},$$scope:{ctx:e}}}),n.$on("click",e[9]),o=new ho({props:{emphasise:!e[1],style:"font-size: 10pt",$$slots:{default:[sl]},$$scope:{ctx:e}}}),o.$on("click",e[10]);let pe=null!==e[6]&&-1!==e[6].minPitch&&cl(e);te=new xo({props:{$$slots:{default:[ul],trigger:[ll]},$$scope:{ctx:e}}});let me=e[8]&&dl(e);ie=new xo({props:{$$slots:{default:[ml],trigger:[pl]},$$scope:{ctx:e}}});let ve=e[8]&&gl(e);le=new xo({props:{$$slots:{default:[bl],trigger:[$l]},$$scope:{ctx:e}}});let $e=e[8]&&wl(e);return{c(){t=C("div"),ke(n.$$.fragment),r=S(),ke(o.$$.fragment),i=S(),a=C("div"),s=C("div"),c=C("span"),c.textContent="Length:",l=S(),u=C("div"),d=C("span"),f=I(e[4]),h=I(" tokens"),p=S(),m=C("span"),g=I(e[5]),y=I(" notes"),v=S(),$=C("span"),b=I(e[3]),T=I(" sec"),E=S(),A=C("div"),M=S(),N=C("div"),O=C("span"),O.textContent="Pitch:",U=S(),pe&&pe.c(),D=S(),j=C("div"),L=S(),F=C("div"),R=C("span"),R.textContent="Max Silence:",_=S(),H=C("span"),z=I(e[7]),V=I(" sec"),W=S(),G=C("div"),Z=S(),X=C("div"),Y=C("span"),J=I("Instrument Use"),K=S(),ee=C("div"),ke(te.$$.fragment),ne=S(),re=C("div"),me&&me.c(),oe=S(),ke(ie.$$.fragment),ae=S(),se=C("div"),ve&&ve.c(),ce=S(),ke(le.$$.fragment),ue=S(),de=C("div"),$e&&$e.c(),q(t,"class","row svelte-6w7hi3"),B(t,"justify-content","space-around"),q(c,"class","label svelte-6w7hi3"),q(d,"class","value svelte-6w7hi3"),q(m,"class","value svelte-6w7hi3"),q($,"class","value svelte-6w7hi3"),q(u,"class","col svelte-6w7hi3"),q(s,"class","row svelte-6w7hi3"),q(A,"class","spacer svelte-6w7hi3"),q(O,"class","label svelte-6w7hi3"),q(N,"class","row svelte-6w7hi3"),q(j,"class","spacer svelte-6w7hi3"),q(R,"class","label svelte-6w7hi3"),q(H,"class","value svelte-6w7hi3"),q(F,"class","row svelte-6w7hi3"),q(G,"class","spacer svelte-6w7hi3"),q(Y,"class","label svelte-6w7hi3"),q(Y,"style",Q=Sr({color:Kn.text})),q(X,"class","row svelte-6w7hi3"),B(X,"justify-content","center"),q(re,"class","instrumentBar svelte-6w7hi3"),q(se,"class","instrumentBar svelte-6w7hi3"),q(de,"class","instrumentBar svelte-6w7hi3"),B(ee,"display","grid"),B(ee,"grid-template-columns","auto 1fr"),B(ee,"align-items","center"),B(ee,"grid-column-gap","12px"),q(a,"class","mainCol svelte-6w7hi3"),q(a,"style",fe=Sr({color:Kn.textDark}))},m(e,k){x(e,t,k),Te(n,t,null),w(t,r),Te(o,t,null),x(e,i,k),x(e,a,k),w(a,s),w(s,c),w(s,l),w(s,u),w(u,d),w(d,f),w(d,h),w(u,p),w(u,m),w(m,g),w(m,y),w(u,v),w(u,$),w($,b),w($,T),w(a,E),w(a,A),w(a,M),w(a,N),w(N,O),w(N,U),pe&&pe.m(N,null),w(a,D),w(a,j),w(a,L),w(a,F),w(F,R),w(F,_),w(F,H),w(H,z),w(H,V),w(a,W),w(a,G),w(a,Z),w(a,X),w(X,Y),w(Y,J),w(a,K),w(a,ee),Te(te,ee,null),w(ee,ne),w(ee,re),me&&me.m(re,null),w(ee,oe),Te(ie,ee,null),w(ee,ae),w(ee,se),ve&&ve.m(se,null),w(ee,ce),Te(le,ee,null),w(ee,ue),w(ee,de),$e&&$e.m(de,null),he=!0},p(e,t){const r={};2&t&&(r.emphasise=e[1]),67108864&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const i={};2&t&&(i.emphasise=!e[1]),67108864&t&&(i.$$scope={dirty:t,ctx:e}),o.$set(i),(!he||16&t)&&P(f,e[4]),(!he||32&t)&&P(g,e[5]),(!he||8&t)&&P(b,e[3]),null!==e[6]&&-1!==e[6].minPitch?pe?pe.p(e,t):(pe=cl(e),pe.c(),pe.m(N,null)):pe&&(pe.d(1),pe=null),(!he||128&t)&&P(z,e[7]);const a={};67108864&t&&(a.$$scope={dirty:t,ctx:e}),te.$set(a),e[8]?me?me.p(e,t):(me=dl(e),me.c(),me.m(re,null)):me&&(me.d(1),me=null);const s={};67108864&t&&(s.$$scope={dirty:t,ctx:e}),ie.$set(s),e[8]?ve?ve.p(e,t):(ve=gl(e),ve.c(),ve.m(se,null)):ve&&(ve.d(1),ve=null);const c={};67108864&t&&(c.$$scope={dirty:t,ctx:e}),le.$set(c),e[8]?$e?$e.p(e,t):($e=wl(e),$e.c(),$e.m(de,null)):$e&&($e.d(1),$e=null)},i(e){he||(ge(n.$$.fragment,e),ge(o.$$.fragment,e),ge(te.$$.fragment,e),ge(ie.$$.fragment,e),ge(le.$$.fragment,e),he=!0)},o(e){ye(n.$$.fragment,e),ye(o.$$.fragment,e),ye(te.$$.fragment,e),ye(ie.$$.fragment,e),ye(le.$$.fragment,e),he=!1},d(e){e&&k(t),Ce(n),Ce(o),e&&k(i),e&&k(a),pe&&pe.d(),Ce(te),me&&me.d(),Ce(ie),ve&&ve.d(),Ce(le),$e&&$e.d()}}}function il(t){let n,r,o;return{c(){n=C("span"),r=I("Nothing Selected"),q(n,"style",o=Sr({margin:"12px auto 0 auto",color:Kn.textDark}))},m(e,t){x(e,n,t),w(n,r)},p:e,i:e,o:e,d(e){e&&k(n)}}}function al(e){let t;return{c(){t=I("Track")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function sl(e){let t;return{c(){t=I("Section")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function cl(e){let t,n,r,o,i=e[6].minPitch+"",a=e[6].maxPitch+"";return{c(){t=C("span"),n=I(i),r=I(" - "),o=I(a),q(t,"class","value svelte-6w7hi3")},m(e,i){x(e,t,i),w(t,n),w(t,r),w(t,o)},p(e,t){64&t&&i!==(i=e[6].minPitch+"")&&P(n,i),64&t&&a!==(a=e[6].maxPitch+"")&&P(o,a)},d(e){e&&k(t)}}}function ll(e){let t;return{c(){t=C("span"),t.textContent="Note Count:",q(t,"class","label svelte-6w7hi3"),q(t,"slot","trigger")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ul(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Based on the number of notes for that instrument"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function dl(e){let t,n=e[8],r=[];for(let t=0;t<n.length;t+=1)r[t]=hl(rl(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(256&o){let i;for(n=e[8],i=0;i<n.length;i+=1){const a=rl(e,n,i);r[i]?r[i].p(a,o):(r[i]=hl(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function fl(e){let t,n;return{c(){t=C("div"),q(t,"class","bar"),q(t,"style",n=Sr({backgroundColor:Kn[e[18]],flexGrow:e[19].noteCount}))},m(e,n){x(e,t,n)},p(e,r){256&r&&n!==(n=Sr({backgroundColor:Kn[e[18]],flexGrow:e[19].noteCount}))&&q(t,"style",n)},d(e){e&&k(t)}}}function hl(e){let t,n=e[19].noteCount>0&&fl(e);return{c(){n&&n.c(),t=A()},m(e,r){n&&n.m(e,r),x(e,t,r)},p(e,r){e[19].noteCount>0?n?n.p(e,r):(n=fl(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function pl(e){let t;return{c(){t=C("span"),t.textContent="Note Length:",q(t,"class","label svelte-6w7hi3"),q(t,"slot","trigger")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ml(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Based on the total length of all notes for that instrument"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function gl(e){let t,n=e[8],r=[];for(let t=0;t<n.length;t+=1)r[t]=vl(nl(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(256&o){let i;for(n=e[8],i=0;i<n.length;i+=1){const a=nl(e,n,i);r[i]?r[i].p(a,o):(r[i]=vl(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function yl(e){let t,n;return{c(){t=C("div"),q(t,"class","bar"),q(t,"style",n=Sr({backgroundColor:Kn[e[18]],flexGrow:1e3*e[19].totalPlayingTime}))},m(e,n){x(e,t,n)},p(e,r){256&r&&n!==(n=Sr({backgroundColor:Kn[e[18]],flexGrow:1e3*e[19].totalPlayingTime}))&&q(t,"style",n)},d(e){e&&k(t)}}}function vl(e){let t,n=e[19].totalPlayingTime>0&&yl(e);return{c(){n&&n.c(),t=A()},m(e,r){n&&n.m(e,r),x(e,t,r)},p(e,r){e[19].totalPlayingTime>0?n?n.p(e,r):(n=yl(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function $l(e){let t;return{c(){t=C("span"),t.textContent="Active Time:",q(t,"class","label svelte-6w7hi3"),q(t,"slot","trigger")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function bl(t){let n,r;return{c(){n=S(),r=C("span"),r.textContent="Based on how much of the time that instrument is making noise"},m(e,t){x(e,n,t),x(e,r,t)},p:e,d(e){e&&k(n),e&&k(r)}}}function wl(e){let t,n=e[8],r=[];for(let t=0;t<n.length;t+=1)r[t]=kl(tl(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);x(e,t,n)},p(e,o){if(256&o){let i;for(n=e[8],i=0;i<n.length;i+=1){const a=tl(e,n,i);r[i]?r[i].p(a,o):(r[i]=kl(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){T(r,e),e&&k(t)}}}function xl(e){let t,n;return{c(){t=C("div"),q(t,"class","bar"),q(t,"style",n=Sr({backgroundColor:Kn[e[18]],flexGrow:1e3*e[19].nonSilenceTime}))},m(e,n){x(e,t,n)},p(e,r){256&r&&n!==(n=Sr({backgroundColor:Kn[e[18]],flexGrow:1e3*e[19].nonSilenceTime}))&&q(t,"style",n)},d(e){e&&k(t)}}}function kl(e){let t,n=e[19].nonSilenceTime>0&&xl(e);return{c(){n&&n.c(),t=A()},m(e,r){n&&n.m(e,r),x(e,t,r)},p(e,r){e[19].nonSilenceTime>0?n?n.p(e,r):(n=xl(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Tl(e){let t,n,r,o,i,a;const s=[il,ol],c=[];function l(e,t){return null===e[2]?0:1}return r=l(e),o=c[r]=s[r](e),{c(){t=C("h1"),t.textContent="Stats",n=S(),o.c(),i=A(),q(t,"class","svelte-6w7hi3")},m(e,o){x(e,t,o),x(e,n,o),c[r].m(e,o),x(e,i,o),a=!0},p(e,[t]){let n=r;r=l(e),r===n?c[r].p(e,t):(pe(),ye(c[n],1,1,()=>{c[n]=null}),me(),o=c[r],o||(o=c[r]=s[r](e),o.c()),ge(o,1),o.m(i.parentNode,i))},i(e){a||(ge(o),a=!0)},o(e){ye(o),a=!1},d(e){e&&k(t),e&&k(n),c[r].d(e),e&&k(i)}}}function Cl(t,n,r){let o,i,a,s=e,l=()=>(s(),s=c(i,e=>r(17,o=e)),i);t.$$.on_destroy.push(()=>s()),l();let u,d,f,h,p,m,g,y,v,$,b,w,x=!0;return t.$$.update=()=>{131072&t.$$.dirty&&r(11,a=o),2050&t.$$.dirty&&r(2,u=null===a||0===a.length?null:x?a:[a[a.length-1]]),4&t.$$.dirty&&r(12,d=null===u?null:u[0].startsAt),4&t.$$.dirty&&r(13,f=null===u?null:u[u.length-1].endsAt),12288&t.$$.dirty&&r(3,h=null!==d&&null!==f?(f-d).toFixed(1):"0.0"),4&t.$$.dirty&&r(4,p=u?function(e){return e.map(e=>e.encoding.length).reduce((e,t)=>e+t,0)}(u):null),4&t.$$.dirty&&r(5,m=u?function(e){return e.map(Jc).reduce((e,t)=>e+t,0)}(u):null),4&t.$$.dirty&&r(6,g=null===u?null:Yr(u)),4&t.$$.dirty&&r(14,y=null===u?null:function(e){return 0===e.length?[]:Qc(el(e),e[0].startsAt,e[e.length-1].endsAt)}(u)),16384&t.$$.dirty&&r(15,v=null===y?null:function(e){let t=0,n=null;return e.forEach(e=>{const r=e.endTime-e.startTime;r>t&&(n=e,t=r)}),n}(y)),32768&t.$$.dirty&&r(7,$=null===v?"0":(v.endTime-v.startTime).toFixed(1)),4&t.$$.dirty&&r(16,b=null===u?null:Kc(u)),65536&t.$$.dirty&&r(8,w=null===b?null:Object.entries(b))},l(r(0,i=Un.selectedSectionsStore)),[i,x,u,h,p,m,g,$,w,function(){r(1,x=!0)},function(){r(1,x=!1)}]}class El extends Se{constructor(e){super(),Ie(this,e,Cl,Tl,s,{})}}function Il(t){let n,r,o,i,a;return{c(){n=C("div"),r=I("<"),q(n,"style",o=Sr({position:"fixed",top:8,right:8,color:Kn.text,fontSize:20,fontWeight:600,opacity:50,cursor:"pointer",zIndex:999}))},m(e,o){x(e,n,o),w(n,r),i||(a=M(n,"click",t[3],!0),i=!0)},p:e,d(e){e&&k(n),i=!1,a()}}}function Sl(t){let n,r,o,i,a,s,c,l,u,d,f,h,p,m,g,y,v,$;return d=new ii({}),h=new Yc({}),m=new El({}),{c(){n=C("div"),r=C("div"),o=I(">"),a=S(),s=C("h1"),c=I("Options"),u=S(),ke(d.$$.fragment),f=S(),ke(h.$$.fragment),p=S(),ke(m.$$.fragment),q(r,"style",i=Sr({position:"absolute",top:8,left:8,color:Kn.text,fontSize:20,fontWeight:600,opacity:50,cursor:"pointer"})),q(s,"style",l=Sr({textAlign:"center",color:Kn.text,margin:0})),q(n,"style",g=Sr({position:"relative",gridColumn:"3",gridRow:"1",overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",backgroundColor:Kn.bgDark,borderLeft:"1px solid "+Kn.border,padding:12}))},m(e,i){x(e,n,i),w(n,r),w(r,o),w(n,a),w(n,s),w(s,c),w(n,u),Te(d,n,null),w(n,f),Te(h,n,null),w(n,p),Te(m,n,null),y=!0,v||($=M(r,"click",t[4]),v=!0)},p:e,i(e){y||(ge(d.$$.fragment,e),ge(h.$$.fragment,e),ge(m.$$.fragment,e),y=!0)},o(e){ye(d.$$.fragment,e),ye(h.$$.fragment,e),ye(m.$$.fragment,e),y=!1},d(e){e&&k(n),Ce(d),Ce(h),Ce(m),v=!1,$()}}}function Al(e){let t,n,r,o,i,a,s,c,l,u,d,f,h,p,m,g,y,v,$,b;t=new qc({}),r=new Nc({});let T=!e[1]&&Il(e);c=new ro({}),f=new hc({}),g=new sa({});let E=e[1]&&Sl(e);return{c(){ke(t.$$.fragment),n=S(),ke(r.$$.fragment),o=S(),i=C("div"),T&&T.c(),a=S(),s=C("div"),ke(c.$$.fragment),u=S(),d=C("div"),ke(f.$$.fragment),p=S(),m=C("div"),ke(g.$$.fragment),v=S(),E&&E.c(),q(s,"style",l=Sr({gridColumn:"1",gridRow:"1",minHeight:0,display:0===e[0]?"none":"initial"})),q(d,"style",h=Sr({position:"relative",gridColumn:"2",gridRow:"1",minHeight:0,display:100===e[0]?"none":"initial"})),q(m,"style",y=Sr({gridColumn:"1 / span 3",gridRow:"2",minHeight:0})),q(i,"class","grid svelte-cdlvc2"),q(i,"style",$=Sr({color:Kn.text,gridTemplateColumns:`${e[0]}fr ${100-e[0]}fr ${e[1]?"300px":""}`}))},m(e,l){Te(t,e,l),x(e,n,l),Te(r,e,l),x(e,o,l),x(e,i,l),T&&T.m(i,null),w(i,a),w(i,s),Te(c,s,null),w(i,u),w(i,d),Te(f,d,null),w(i,p),w(i,m),Te(g,m,null),w(i,v),E&&E.m(i,null),b=!0},p(e,t){e[1]?T&&(T.d(1),T=null):T?T.p(e,t):(T=Il(e),T.c(),T.m(i,a)),(!b||1&t&&l!==(l=Sr({gridColumn:"1",gridRow:"1",minHeight:0,display:0===e[0]?"none":"initial"})))&&q(s,"style",l),(!b||1&t&&h!==(h=Sr({position:"relative",gridColumn:"2",gridRow:"1",minHeight:0,display:100===e[0]?"none":"initial"})))&&q(d,"style",h),e[1]?E?(E.p(e,t),2&t&&ge(E,1)):(E=Sl(e),E.c(),ge(E,1),E.m(i,null)):E&&(pe(),ye(E,1,1,()=>{E=null}),me()),(!b||3&t&&$!==($=Sr({color:Kn.text,gridTemplateColumns:`${e[0]}fr ${100-e[0]}fr ${e[1]?"300px":""}`})))&&q(i,"style",$)},i(e){b||(ge(t.$$.fragment,e),ge(r.$$.fragment,e),ge(c.$$.fragment,e),ge(f.$$.fragment,e),ge(g.$$.fragment,e),ge(E),b=!0)},o(e){ye(t.$$.fragment,e),ye(r.$$.fragment,e),ye(c.$$.fragment,e),ye(f.$$.fragment,e),ye(g.$$.fragment,e),ye(E),b=!1},d(e){Ce(t,e),e&&k(n),Ce(r,e),e&&k(o),e&&k(i),T&&T.d(),Ce(c),Ce(f),Ce(g),E&&E.d()}}}function Ml(e){let t,n,r,o,i;return n=new $c({props:{$$slots:{default:[Al]},$$scope:{ctx:e}}}),{c(){t=S(),ke(n.$$.fragment)},m(a,s){x(a,t,s),Te(n,a,s),r=!0,o||(i=M(document.body,"keypress",e[2]),o=!0)},p(e,[t]){const r={};35&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ye(n.$$.fragment,e),r=!1},d(e){e&&k(t),Ce(n,e),o=!1,i()}}}function Nl(e,t,n){let r,o;u(e,Xe,e=>n(0,r=e)),u(e,Ye,e=>n(1,o=e));return[r,o,function(e){if(" "===e.key){if(console.log(e),null!==e.target&&"tagName"in e.target){const t=e.target.tagName;"INPUT"!==t&&"TEXTAREA"!==t&&(e.preventDefault(),"off"===Vn.type?Jn(0):"on"===Vn.type&&Qn())}}else"z"===e.key&&e.ctrlKey&&(e.preventDefault(),Sn.undo())},()=>Ye.set(!0),()=>Ye.set(!1)]}return new class extends Se{constructor(e){super(),Ie(this,e,Nl,Ml,s,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
